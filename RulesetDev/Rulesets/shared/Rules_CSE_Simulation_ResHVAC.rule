; -------------------------------------------------------------------------
; Rules pertaining to:   Setup HVAC & AirNet objects for CSE Energy Simulation
; CEC Title-24 Residential Energy Code
; -------------------------------------------------------------------------
; Copyright (c) 2012-2014, California Energy Commission
; Copyright (c) 2012-2014, Wrightsoft Corporation
; All rights reserved.
; Redistribution and use in source and binary forms, with or without modification,
; are permitted provided that the following conditions are met:
; - Redistributions of source code must retain the above copyright notice, this
;   list of conditions and the following disclaimer.
; - Redistributions in binary form must reproduce the above copyright notice, this
;   list of conditions, the following disclaimer in the documentation and/or other
;   materials provided with the distribution.
; - Neither the name of the California Energy Commission nor the names of its
;   contributors may be used to endorse or promote products derived from this
;   software without specific prior written permission.
; DISCLAIMER: THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
; THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
; NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION,
; WRIGHTSOFT CORPORATION, ITRON, INC. OR ANY OTHER AUTHOR OR COPYRIGHT HOLDER OF
; THIS SOFTWARE (COLLECTIVELY, THE "AUTHORS") BE LIABLE FOR ANY DIRECT, INDIRECT,
; INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
; LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
; OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
; LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
; OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  EACH LICENSEE AND SUBLICENSEE OF THE
; SOFTWARE AGREES NOT TO ASSERT ANY CLAIM AGAINST ANY OF THE AUTHORS RELATING TO
; THIS SOFTWARE, WHETHER DUE TO PERFORMANCE ISSUES, TITLE OR INFRINGEMENT ISSUES,
; STRICT LIABILITY OR OTHERWISE.
; -------------------------------------------------------------------------

ENUM_PROPERTIES_VALUE   ; ensures retrieval/logic/us of enum properties assume numeric value (alternative is ENUM_PROPERTIES_STRING)

;*************************************************************************
RULELIST "CSE_SimulationPrep_HVAC" 1 0 0 1
;*************************************************************************
	"Setup CSE HVAC system components"
			ResProj:Action = {	switch (ResAnalysisType)
										case  0 :  EvalRulelist( "HVACSys_CSE_Defaulting" )	; simulation only
										case 12 :  EvalRulelist( "HVACSys_CSE_Defaulting" )	; Proposed Only
										case 13 :  EvalRulelist( "HVACSys_CSE_Defaulting" )	; Proposed and Standard
										case  2 :  EvalRulelist( "HVACSys_CSE_Defaulting" )	; Existing Building EDR
										default :  UNCHANGED
									endswitch  }

  "Setup CSE DOAS system components" ResCentralVentSys:Action = { 
    if( ( SupFanCap > 0 .OR. ExhFanCap > 0 ) .AND. ( CountRefs( DwellUnitType:CentralVentSysRef ) + CountRefs( ResOtherZn:CentralVentSysRef ) > 0 ) )
    then EvalRulelist( "DOAS_CSE_Defaulting", 1 ) else UNCHANGED endif }

	"Setup AirNet IZXFER objects"		ResProj:Action		= {	EvalRulelist( "SimPrep_CSE_AirNet" )  }

   ; SAC 11/7/18 - create and setup GAIN object to model VCHP CFan (for assigned system)
   "Setup VCHP equipment Zone CFan (GAIN) objects"    ResZn:GainVCHPCFan  = {
         if (IfValidAnd( ActiveHVACSystem:HPSysVCHPFanPwr    > 0 )==0 .OR.
             IfValidAnd( ActiveHVACSystem:FloorAreaServed[1] > 0 )==0 .OR.
             LocalCompAssigned( ActiveHVACSystem:cseRSYS ) < 1 .OR.
             (ResProj:RunAbbrev != "p"   .AND. ResProj:RunAbbrev != "p-N" .AND. ResProj:RunAbbrev != "p-E" .AND. 
                                            ResProj:RunAbbrev != "p-S" .AND. ResProj:RunAbbrev != "p-W" .AND.
              ResProj:RunAbbrev != "pfx" .AND. ResProj:RunAbbrev != "pfx-N" .AND. ResProj:RunAbbrev != "pfx-E" .AND.
                                            ResProj:RunAbbrev != "pfx-S" .AND. ResProj:RunAbbrev != "pfx-W" .AND.
              ResProj:RunAbbrev != "pp"  .AND. ResProj:RunAbbrev != "pp-N" .AND. ResProj:RunAbbrev != "pp-E" .AND.
                                            ResProj:RunAbbrev != "pp-S" .AND. ResProj:RunAbbrev != "pp-W" )) then  UNDEFINED
         else  CreateComp( cseGAIN, substr( Name, 0, 48 ) + "-cfan" )  endif  }
	"Set ResZn:GainVCHPCFan parent cseZONE"    ResZn:GainVCHPCFan:Parent   = {  Local( CSE_ZONE )  }
	"Set ResZn:GainVCHPCFan:gnMeter"           ResZn:GainVCHPCFan:gnMeter  = {  if (Global( ResProj:Fuel_HaveElec ) > 0.5) then  CSE_ElecMETER
                                                                             else  UNDEFINED  endif  }
	"Set ResZn:GainVCHPCFan:gnEndUse"          ResZn:GainVCHPCFan:gnEndUse = {  "User1"  }  ; "Fan"  }
	"Set ResZn:GainVCHPCFan:gnPower_x"         ResZn:GainVCHPCFan:gnPower_x = {
	      Format( "%g * 3.412 * (%g/%g) * (1-@RSYSRES[%c%s%c].prior.H.hrsOn)", ActiveHVACSystem:HPSysVCHPFanPwr,
	            ValidOr( FloorArea, 0 ), ActiveHVACSystem:FloorAreaServed[1], 34, ActiveHVACSystem:cseRSYS:Name, 34 )  }

   "Eval rules to setup cseAIRHANDLER and cseTERMINAL for ResOtherZn objects"  Proj:Action =       ; SAC 04/26/22 (MFam)
      {  if (IsComRuleset .AND. SumAll( AirSys:ServesResZn ) > 0)
         then  EvalRulelist( "CSE_SimulationPrep_HVAC_Terminal_AirSys" )
         else  UNCHANGED  endif  }

   ; add setting of RSYS elec & fuel meter from ResZn BEFORE referencing global meters - SAC 08/20/22 (CUAC)
   "Set ResZn:ActiveHVACSystem:cseRSYS:rsElecMtr"  ResZn:ActiveHVACSystem:cseRSYS:rsElecMtr = {  CSE_ElecMETER  }
   "Set ResZn:ActiveHVACSystem:cseRSYS:rsFuelMtr"  ResZn:ActiveHVACSystem:cseRSYS:rsFuelMtr =
      {  if (LocalCompAssigned( CSE_NatGasMETER )) then  CSE_NatGasMETER  else  CSE_OtherFuelMETER  endif  }

  ; Assign elec/fuel meters to RSYS components
	"Set cseRSYS:rsElecMtr"		cseRSYS:rsElecMtr		= {	if (LocalCompAssigned( rsElecMtr )) then  UNCHANGED
                                                         else if (Local( Fuel_HaveElec   ) > 0.5) then  Global( Proj:CSE_ElecMETER )
																			else  UNDEFINED  endif endif  }
	"Set cseRSYS:rsFuelMtr"		cseRSYS:rsFuelMtr		= {	if (LocalCompAssigned( rsFuelMtr )) then  UNCHANGED
                                                         else if (Local( Fuel_HaveNatGas ) > 0.5) then  Global( Proj:CSE_NatGasMETER )
																			else if (Local( Fuel_HaveOther  ) > 0.5) then  Global( Proj:CSE_OtherFuelMETER )
																			else  UNDEFINED  endif endif endif  }
END
;*************************************************************************


;*************************************************************************
RULELIST "HVACSys_CSE_Defaulting" 0 0 0 1
;*************************************************************************

;	"Blast ResProj:cseElecHVACMtr"			ResProj:cseElecHVACMtr		= {	if (LocalCompAssigned( cseElecHVACMtr   )) then  DeleteComp()  else  UNCHANGED  endif  }
;	"Blast ResProj:cseNatGasHVACMtr"			ResProj:cseNatGasHVACMtr	= {	if (LocalCompAssigned( cseNatGasHVACMtr )) then  DeleteComp()  else  UNCHANGED  endif  }
;
;  ; CSE METERs to track HVAC energy use
;	"Create ResProj:cseElecHVACMtr"			ResProj:cseElecHVACMtr		= {	CreateComp( cseMETER, "ElecHVACMtr" )  }
;	"Create ResProj:cseNatGasHVACMtr"		ResProj:cseNatGasHVACMtr	= {	if (Local( NatGasAvailable ) < 0.5) then  UNDEFINED
;																							else  CreateComp( cseMETER, "NatGasHVACMtr" )  endif  }


	"Blast all cseRSYS components"		   Proj:Action		= {	DeleteAllComps( cseRSYS )  }
	"Blast all cseAIRHANDLER components"	Proj:Action		= {	DeleteAllComps( cseAIRHANDLER )  }     ; SAC 04/26/22
	"Blast all cseTERMINAL components"		Proj:Action		= {	DeleteAllComps( cseTERMINAL )  }

  ; CSE RSYS creation & setup
	"Create a CSE RSYS for each HVACSys"	ResHVACSys:cseRSYS					= {	if (Local( FloorAreaServed[1] ) > 1 .AND.
																												(HaveHeating .OR.
																												 (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ))))
																										then  CreateComp( cseRSYS, "rsys-" + substr( Name, 0, 48 ) )
																										else  UNDEFINED  endif  }
	"Set ResHVACSys:cseRSYS:SourceHVACSys"		ResHVACSys:cseRSYS:SourceHVACSys	= {	Local( Name )  }

  ; SAC 1/10/13 - added logic to set new rsType selection
  ; SAC 2/19/13 - revised to reference new cooling- and heating-only system types
  ; SAC 10/27/15 - added check for design rating run abbreviation (ResProj:RunAbbrev == "dr")
; "store BEMProc details"		ResProj:Action = {  StoreBEMProc( Format( "Before RSYS setup-%s", RunAbbrev ), 0 )  }
; "debug"	ResProj:Action	= {	MessageBox( "inside HVACSys_CSE_Defaulting" )  }
	"Set ResHVACSys:cseRSYS:rsType"		ResHVACSys:cseRSYS:rsType	=     ; SAC 03/17/22 (WSHP)
				{	if (Type < 1 .OR. Type > 4) then														0		; -- ERROR --
               else if (Type == 4)     ; Central System
               then  if (CentralEqpType == 1) then 14 ; FPFC -->> FANCOIL - JP 11/03/22
                     else if (CentralEqpType == 2) then 13 ; WSHP -->> WSHP - SAC 04/05/22
                     else if (CentralEqpType == 4) then 12 ; VRF -->> VCHP2 - JP 04/26/22
                     else 			                                                      0		; -- ERROR --
                     endif endif endif
					else if (Type == 2)
					then	if (NumHtPumpSystemTypes > 0 .AND. IfValidAnd( HtPumpSystem[1]:Type == 11 ) .AND. 
								 ResProj:RunAbbrev != "s"  .AND. ResProj:RunAbbrev != "zb" .AND. ResProj:RunAbbrev != "S" .AND. ResProj:RunAbbrev != "smf" .AND.
								 ResProj:RunAbbrev != "dr" .AND. ResProj:RunAbbrev != "DR") then										7		; ASHPHydronic
							else if (HaveHeating .AND. HaveCooling)
							then  if (IfValidAnd( HtPumpSysType = 26 ) .OR. IfValidAnd( HtPumpSysType = 24 ))                     ; PkgTermHeatPump or SglPkgVertHeatPump - SAC 6/21/20 (tic #1226)
							      then                                                                                      8     ; ASHPPkgRoom
                           else if (IfValidAnd( HtPumpSysType = 33 ))
                           then                                                                                     12     ; VCHP2 - SAC 11/09/20
							      else                                																		3		; ASHP
							      endif endif
							else																															0		; -- ERROR --
							endif endif
					else if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ) .AND. HaveHeating)
					then	if (HaveCooling < 1)
							then	if (T24RHeatingEquipment:UseElec( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then		6		; Resistance
							      else																													5		; Furnace
									endif
							else	if (IfValidAnd( CoolSysType = 25 ) .OR. IfValidAnd( CoolSysType = 23 ))                         ; PkgTermAirCond or SglPkgVertAirCond - SAC 6/22/20 (tic #1226)
							      then  if (T24RHeatingEquipment:UseElec( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5)
							            then                                                                               11		; ACPkgRoomRes          - SAC 6/24/20 (tic #1226)
							            else                                                                               10		; ACPkgRoomFurnace      - SAC 6/24/20 (tic #1226)
							            endif
							      else if (T24RHeatingEquipment:UseElec( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then		2		; ACResistance
									else																													1		; ACFurnace
									endif endif
							endif
					else if (LocalCompAssigned( CoolSystem ))
					then  if (IfValidAnd( CoolSysType = 25 ) .OR. IfValidAnd( CoolSysType = 23 ))                               ; PkgTermAirCond or SglPkgVertAirCond - SAC 6/22/20 (tic #1226)
					      then                                                                                            9     ; ACPkgRoom
					      else                                   																			4		; AC
					      endif
					else if (HaveHeating)
					then	if (T24RHeatingEquipment:UseElec( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then		6		; Resistance
							else																															5		; Furnace
							endif
					else																																	1		; ACFurnace
					endif endif endif endif endif endif  }
			;		if (NumCoolSystemTypes > 0 .AND. LocalCompAssigned( CoolSystem[1] ) .AND. HaveHeating)
			;		then	if (     T24RCoolingEquipment:IsHP(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0.5 .AND.
			;					      T24RHeatingEquipment:IsHP(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then  3		; ASHP
			;				else if (T24RHeatingEquipment:UseElec( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then  2		; ACResistance
			;				else																																					  1		; ACFurnace
			;				endif endif
			;		else if (LocalCompAssigned( CoolSystem ))
			;		then	if (     T24RCoolingEquipment:IsHP(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", CoolSysTypeAbbrev ) > 0.5) then  3		; ASHP
			;				else																																					  4		; AC
			;				endif
			;		else if (HaveHeating)
			;		then	if (     T24RHeatingEquipment:IsHP(    "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then  3		; ASHP
			;				else if (T24RHeatingEquipment:UseElec( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSysTypeAbbrev ) > 0.5) then  6		; Resistance
			;				else																																					  5		; Furnace
			;				endif endif
			;		else																																							  1		; ACFurnace
			;		endif endif endif  }

;  ; SAC 1/3/13 - added auto-sizing stuff
;	"Set ResHVACSys:AutoSizeCool"		ResHVACSys:AutoSizeCool	= {	if (LocalCompAssigned( CoolSystem ) == 0)	then  0
;																				else if (CoolSystem:AutoSize > 0.5)	then  1
;																				else	0  endif endif  }
;  ; SAC 1/10/13 - revised to prevent setting AUTOSIZE for rsCapH when system is of type ASHP
;	"Set ResHVACSys:AutoSizeHeat"		ResHVACSys:AutoSizeHeat	= {	if (LocalCompAssigned( HeatSystem ) == 0)	then  0
;																				else if (HeatSystem:AutoSize > 0.5 .AND.
;																							T24RHeatingEquipment:IsHP( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HeatSystem:TypeAbbrevStr ) < 0.5)	then  1
;																				else	0  endif endif  }
; SAC 10/3/13 - added logic to AUTOSIZE rules to always autosize rsCapAuxH for RSYSs of type ASHP (3) (as of CSE version 0.732)
; SAC 5/22/14 - expanded specification of rsCapAuxH to include cseRSYS:rsType = ASHPHydronic
; SAC 10/20/14 - added logic to set AUTOSIZE rsCap47  - ONLY FOR Standard design heat pump simulations
      ; SAC 6/27/20 - mod to enable HtPumpCap47AutoSz for rsType = ASHPPkgRoom (tic #1225 & #1226)    ; VCHP2 - SAC 11/09/20   ; SAC 03/18/22 (WSHP)   ; SAC 07/22/22 (VRF)
	"Set ResHVACSys:HtPumpCap47AutoSz"			ResHVACSys:HtPumpCap47AutoSz		= {	if (ResHVACSys:cseRSYS:rsType != 3  .AND. ResHVACSys:cseRSYS:rsType != 8 .AND.
                                                                                        ResHVACSys:cseRSYS:rsType != 12) then  0
	                                                                           else if ((Type == 2 .OR. (Type == 4 .AND. (CentralEqpType == 2 .OR. CentralEqpType == 4))) .AND.
                                                                                       IfValidAnd( HPSysAutoSize > 0 )) then  1
																										else if (IfValidAnd( HPSysCap47 > 0 )) then  0
																										else if (ResProj:RunAbbrev == "s" .OR. ResProj:RunAbbrev == "zb" .OR. ResProj:RunAbbrev == "S" .OR. ResProj:RunAbbrev == "smf" .OR. ResProj:RunAbbrev == "dr") then  1
																										else	if (Type == 2)
																												then	if (T24RHeatingEquipment:PropEqStd( "CodeBase", Proj:StdDesignBase, "StdVer", ResProj:StdsVersionYr, "SysType", HtPumpSysTypeAbbrev ) > 0.1)
																														then  1  else  0  endif
																												else  0  endif
																										endif endif endif endif  }

   ; SAC 6/25/20 - added rsType ASHPPkgRoom (8) to list that autosize rsCapAuxH (tic #1225 & #1226)      ; prevent autosize of rsCapAuxH for VCHP2 systems - SAC 11/02/20
   ; RESTORE autosize of rsCapAuxH for VCHP2 systems - SAC 03/22/22
	"Set ResHVACSys:cseRSYS:AUTOSIZE_x[1]"		ResHVACSys:cseRSYS:AUTOSIZE_x[1]	= {	if (     AutoSizeCool[1] .AND. HaveCooling > 0    ) then  "rsCapC"
																										else if (AutoSizeHeat[1]    ) then  "rsCapH"
																										else if (LocalRef( cseRSYS:rsType ) == 3 .OR. LocalRef( cseRSYS:rsType ) == 7 .OR.
																										         LocalRef( cseRSYS:rsType ) == 8 .OR. LocalRef( cseRSYS:rsType ) == 12) then  "rsCapAuxH"
																										else	UNDEFINED  endif endif endif  }
	"Set ResHVACSys:cseRSYS:AUTOSIZE_x[2]"		ResHVACSys:cseRSYS:AUTOSIZE_x[2]	= {	if (AutoSizeCool[1] .AND. HaveCooling > 0 .AND. AutoSizeHeat[1]) then  "rsCapH"
																										else if (LocalRef( cseRSYS:rsType ) == 3 .OR. LocalRef( cseRSYS:rsType ) == 7 .OR.
																										         LocalRef( cseRSYS:rsType ) == 8) then  "rsCapAuxH"
																										else if (HtPumpCap47AutoSz > 0.5 .AND. LocalStatus( cseRSYS:AUTOSIZE_x[1] ) > 0.5) then  "rsCap47"
																										else	UNDEFINED  endif endif endif  }
   ; revised logic below to autosize rsCapAuxH for VCHP2 systems (per today's conference call) - SAC 07/30/21   ; SAC 04/05/22 (WSHP)
	"Set ResHVACSys:cseRSYS:AUTOSIZE_x[3]"		ResHVACSys:cseRSYS:AUTOSIZE_x[3]	= {	if (AutoSizeCool[1] .AND. HaveCooling > 0 .AND. 
                                                                                  (AutoSizeHeat[1] .OR. LocalRef( cseRSYS:rsType ) == 12 .OR. LocalRef( cseRSYS:rsType ) == 13) .AND.
																												(LocalRef( cseRSYS:rsType ) == 3 .OR. LocalRef( cseRSYS:rsType ) == 7 .OR.
																										       LocalRef( cseRSYS:rsType ) == 8 .OR. LocalRef( cseRSYS:rsType ) == 12 .OR.
                                                                                     LocalRef( cseRSYS:rsType ) == 13)) then  "rsCapAuxH"
																										else if (HtPumpCap47AutoSz > 0.5 .AND. LocalStatus( cseRSYS:AUTOSIZE_x[2] ) > 0.5 .AND.
																												IfValidAnd( ResHVACSys:cseRSYS:AUTOSIZE_x[2] == "rsCap47" )==0 ) then  "rsCap47"
																										else	UNDEFINED  endif endif  }
	"Set ResHVACSys:cseRSYS:AUTOSIZE_x[4]"		ResHVACSys:cseRSYS:AUTOSIZE_x[4]	= {	if (HtPumpCap47AutoSz > 0.5 .AND. LocalStatus( cseRSYS:AUTOSIZE_x[3] ) > 0.5 .AND.
																												IfValidAnd( ResHVACSys:cseRSYS:AUTOSIZE_x[3] == "rsCap47" )==0 .AND.
																												IfValidAnd( ResHVACSys:cseRSYS:AUTOSIZE_x[2] == "rsCap47" )==0 ) then  "rsCap47"
																										else	UNDEFINED  endif  }

   ; VCHP2 - SAC 11/02/20
   ; REMOVED specification of rsCapAuxH = 0 for VCHP2 (per today's conference call) - SAC 07/30/21
	;"Set ResHVACSys:cseRSYS:rsCapAuxH"			ResHVACSys:cseRSYS:rsCapAuxH		= {	if (Type == 2 .AND. HtPumpSysType == 33) then  0
	;																									else	UNDEFINED  endif  }

; SAC 10/20/14 - added logic to set rsFxCapH = .75  WHENEVER  AUTOSIZE rsCap47  is set above (for Standard design heat pump simulations)
   ; added logic to use 0.75 for Std design only, else HtSysSizingFactor or 1.1 - SAC 02/11/22 (VCHP2)   ; default HP HtSysSizingFactor 1.1->1.2 - SAC 03/03/22
	"Set ResHVACSys:cseRSYS:rsFxCapH"			ResHVACSys:cseRSYS:rsFxCapH		=     ; added logic from VCHP2 enabling default of rsFxCapH based on HtPumpSystem[1]:HtgSizingFactor - SAC 03/03/22
      {  if (HtPumpCap47AutoSz > 0.5)
         then  if (IfValidAnd( ResProj:RunAbbrev == "s" ) .OR. Proj:RunAbbrev == "zb" .OR.
                   IfValidAnd( ResProj:RunAbbrev == "smf" ) .OR. IfValidAnd( ResProj:RunAbbrev == "dr" )) 
               then  0.75
               else if (IfValidAnd( Proj:EnableResearchMode > 0.5 ) .AND.
                        IfValidAnd( HtPumpSystem[1]:HtgSizingFactor > 0 ))
               then  HtPumpSystem[1]:HtgSizingFactor
               else  ValidOr( HtSysSizingFactor, 1.2 )  endif endif
			else if (AutoSizeHeat[1] == 0) then  UNDEFINED
			else if (IfValidAnd( HtSysSizingFactor > 0 ))
			then  HtSysSizingFactor
			else	UNDEFINED  endif endif endif  }
;	"Set ResHVACSys:cseRSYS:rsFxCapH"			ResHVACSys:cseRSYS:rsFxCapH		= {	if (AutoSizeHeat == 0 .OR. LocalCompAssigned( HeatSystem ) == 0) then  UNDEFINED
;																										else if (HeatSystem:SizingFactor > 0)
;																										then  HeatSystem:SizingFactor
;																										else	UNDEFINED  endif endif  }

   ; FORCE 1.2 regardless of ClSysSizingFactor - SAC 02-25-22  ; restore use of HVACSys:ClSysSizingFactor - SAC 03/03/22
	"Set ResHVACSys:cseRSYS:rsFxCapC"			ResHVACSys:cseRSYS:rsFxCapC		= {	if (AutoSizeCool[1] == 0 .OR. HaveCooling < 1) then  UNDEFINED
																										else if (ClSysSizingFactor > 0)
																										then  ClSysSizingFactor
																										else	UNDEFINED  endif endif  }

;	"store BEMProc details"		ResProj:Action = {  StoreBEMProc( "b4 set of cseRSYS-Cr8SupplyDuct", 0 )  }
;	"debug"		ResProj:Action	= {	MessageBox( "Just stored 'b4 set of cseRSYS-Cr8SupplyDuct' BEMBase details" )  }
; SAC 5/13/13 - moved up from BELOW to include in logic related to setting rsDSEC & rsDSEH
	"Set cseRSYS:Cr8SupplyDuct"		cseRSYS:Cr8SupplyDuct	= {
				if (LocalCompAssigned( SourceHVACSys:DistribSystem ) == 0) then  0
				else if (SourceHVACSys:DistribSystem:Type == 8) then  0				; "DuctsNone - ..."  SAC 12/12/14 - treat just like none assigned
		;		else if (SourceHVACSys:DistribSystem:DuctsPresent == 0) then  0	; SAC 9/4/13 - GC issue 162 - ducts still need to be modeled in most cases where DuctsPresent == 0
				else if (SourceHVACSys:DistribSystem:Type == 12) then  0				; "LowLlCod - Verified low-leakage ducts in conditioned space"
				else if (SourceHVACSys:DistribSystem:DuctLeakageValUse <= 0 .OR.
		;					SourceHVACSys:DistribSystem:DuctInsAdjRval <= 0 .OR.		; SAC 6/27/16 - remove this condition to ensure ducts present for leakage but not conduction are simulated properly (tic #654)
		;					SourceHVACSys:DistribSystem:SupplyDuctArea <= 0 .OR.		; SAC 9/4/13 - GC issue 162 - ducts still need to be modeled in some cases where *DuctArea == 0
							SourceHVACSys:DistribSystem:SupplyDuctDiam <= 0 ) then  0
				else  1  endif endif endif endif  }

	"Set cseRSYS:Cr8ReturnDuct"		cseRSYS:Cr8ReturnDuct	= {
				if (LocalCompAssigned( SourceHVACSys:DistribSystem ) == 0) then  0
				else if (SourceHVACSys:DistribSystem:Type == 8) then  0				; "DuctsNone - ..."  SAC 12/12/14 - treat just like none assigned
		;		else if (SourceHVACSys:DistribSystem:DuctsPresent == 0) then  0	; SAC 9/4/13 - GC issue 162 - ducts still need to be modeled in most cases where DuctsPresent == 0
				else if (SourceHVACSys:DistribSystem:Type == 12) then  0				; "LowLlCod - Verified low-leakage ducts in conditioned space"
				else if (SourceHVACSys:DistribSystem:DuctLeakageValUse <= 0 .OR.
		;					SourceHVACSys:DistribSystem:RetDuctInsAdjRval <= 0 .OR.	; SAC 6/27/16 - remove this condition to ensure ducts present for leakage but not conduction are simulated properly (tic #654)
		;					SourceHVACSys:DistribSystem:ReturnDuctArea <= 0 .OR.		; SAC 9/4/13 - GC issue 162 - ducts still need to be modeled in some cases where *DuctArea == 0
							SourceHVACSys:DistribSystem:ReturnDuctDiam <= 0 ) then  0
				else  1  endif endif endif endif  }
		; SAC 5/13/13 -  ResHVACSys:HtOrClDucted => 1-Heat / 2-Cool / 3-Ht&Cl / 0-neither
	; SAC 12/22/14 - REMOVED logic referencing cseRSYS:Cr8SupplyDuct & :Cr8ReturnDuct when setting rsDSEH/rsDSEC so that combination of NO ht or cl ducts & LowLlCod or related settings don't prevent setting of '1' (GC issue 432)
	"Set ResHVACSys:cseRSYS:rsDSEH"				ResHVACSys:cseRSYS:rsDSEH			= {
         if (HaveHtPump > 0 .AND. (HtPumpSysType == 22 .OR. HtPumpSysType == 33 .OR. IfValidAnd( CentralEqpType = 4 ))) then  UNDEFINED     ; SAC 11/4/18 - VCHP   ; VCHP2 - SAC 11/01/20 ; VRF - JP 04/28/22
         else if (	; removed - (LocalRef(cseRSYS:Cr8SupplyDuct) > 0 .OR. LocalRef(cseRSYS:Cr8ReturnDuct) > 0) .AND.
                   (HtOrClDucted == 0 .OR. HtOrClDucted == 2) ) then  1.0
         else  UNDEFINED  endif endif  }
	"Set ResHVACSys:cseRSYS:rsDSEC"				ResHVACSys:cseRSYS:rsDSEC			= {
         if (HaveHtPump > 0 .AND. (HtPumpSysType == 22 .OR. HtPumpSysType == 33 .OR. IfValidAnd( CentralEqpType = 4 ))) then  UNDEFINED     ; SAC 11/4/18 - VCHP   ; VCHP2 - SAC 11/01/20 ; VRF - JP 04/28/22
         else if (	; removed - (LocalRef(cseRSYS:Cr8SupplyDuct) > 0 .OR. LocalRef(cseRSYS:Cr8ReturnDuct) > 0) .AND.
                   (HtOrClDucted == 0 .OR. HtOrClDucted == 1) .AND. HaveCooling > 0 ) then  1.0
         else  UNDEFINED  endif endif  }

; mjb 12/1/15 - RESNET mods to set rsDSEH and rsDSEC to 0.8 for Design Rating calcs
	"Reset ResHVACSys:cseRSYS:rsDSEH"				ResHVACSys:cseRSYS:rsDSEH			= {	if (ResProj:DRtgRefRunID == 2014) then  0.8
	                                                                              else UNCHANGED endif }
	"Reset ResHVACSys:cseRSYS:rsDSEC"				ResHVACSys:cseRSYS:rsDSEC			= {	if (ResProj:DRtgRefRunID == 2014) then  0.8
	                                                                              else UNCHANGED endif }

  ; SAC 3/4/13
	"Set ResHVACSys:cseRSYS:rsFChg"				ResHVACSys:cseRSYS:rsFChg			= {	if (HaveCooling == 0) then  UNDEFINED
																										else if (LocalStatus( ClSysRefrigChgAdjFctr ) < 2) then  UNDEFINED
																										else if (ClSysRefrigChgAdjFctr > 0 .AND. ClSysRefrigChgAdjFctr <= 1) then  ClSysRefrigChgAdjFctr
																										else  UNDEFINED  endif endif endif    }

	"Set ResHVACSys:cseRSYS:rsCapH"				ResHVACSys:cseRSYS:rsCapH			= {	if (HaveHeating == 0 .OR. AutoSizeHeat[1] == 1) then  UNDEFINED
																										else if (IfValidAnd( HtSysCapacity > 0 ))
																										then  HtSysCapacity
																										else	UNDEFINED  endif endif  }
	"Set ResHVACSys:cseRSYS:rsCapC"				ResHVACSys:cseRSYS:rsCapC			= {	if (HaveCooling == 0 .OR. AutoSizeCool[1] == 1) then  UNDEFINED
																										else if (IfValidAnd( ClSysCapacity > 0 ))
																										then  ClSysCapacity
																										else	UNDEFINED  endif endif  }

;	"Set ResHVACSys:cseRSYS:rsEffH"				ResHVACSys:cseRSYS:rsEffH			= {	if (LocalCompAssigned( HeatSystem ) == 0) then  0
	"Set ResHVACSys:cseRSYS:rsAFUE"				ResHVACSys:cseRSYS:rsAFUE			= {	if (IfValidAnd( HtSysAFUE > 0 )) then  HtSysAFUE / 100  else  UNDEFINED  endif  }
;	"Set ResHVACSys:cseRSYS:rsAFUE"				ResHVACSys:cseRSYS:rsAFUE			= {	if (LocalCompAssigned( HeatSystem ) == 0) then  UNDEFINED
;																										else if (LocalRef( HeatSystem:AFUE ) > 0)
;																										then  LocalRef( HeatSystem:AFUE ) / 100
;																										else  UNDEFINED  endif endif  }


;	"Set ResHVACSys:cseRSYS:rsEffC"				ResHVACSys:cseRSYS:rsEffC			= {	if (LocalCompAssigned( CoolSystem ) == 0) then  0
;																										else if (LocalRef( CoolSystem:SEER ) > 0)
;																										then  (0.875 * LocalRef( CoolSystem:SEER )) / 3.412		; SEER -> COP
;																										else if (LocalRef( CoolSystem:EER ) > 0)
;																										then  LocalRef( CoolSystem:EER ) / 3.412						; EER -> COP
;																										else	2.8  endif endif endif  }
   ; SAC 6/21/20 - mod to prevent echoing SEER when it is not a valid system input (tic #1226)
   ; added ClSysSEER2 / ClSysSEER2perSEER scenario - SAC 10/09/22 (tic #3431)
   "Set ResHVACSys:cseRSYS:rsSEER"				ResHVACSys:cseRSYS:rsSEER			= {	if (HaveCooling == 0) then  UNDEFINED
                                                                              else if (EffMetric = 2 .AND. IfValidAnd( ClSysSEER2 > 0 ) .AND.
                                                                                       IfValidAnd( ClSysSEER2perSEER > 0 ))
                                                                              then  ClSysSEER2 / ClSysSEER2perSEER
																										else if (IfValidAnd( ClSysSEER > 0 ))
																										then  ClSysSEER							; SEER
																										else if (IfValidAnd( ClSysEER > 0 ) .AND. IfValidAnd( CoolSystem[1]:ShowSEER > 0 ))
																										then  ClSysEER / 0.875					; EER -> SEER   ???
																										else	UNDEFINED  endif endif endif endif  }

   ; added ClSysEER2 / ClSysEER2perEER scenario - SAC 10/09/22 (tic #3431)
	"Set ResHVACSys:cseRSYS:rsEER"				ResHVACSys:cseRSYS:rsEER			= {	if (HaveCooling == 0) then  UNDEFINED
                                                                              else if (EffMetric = 2 .AND. IfValidAnd( ClSysEER2 > 0 ) .AND.
                                                                                       IfValidAnd( ClSysEER2perEER > 0 ))
                                                                              then  ClSysEER2 / ClSysEER2perEER
																										else if (IfValidAnd( ClSysEER > 0 ))
																										then  ClSysEER								; EER
																										else	UNDEFINED  endif endif endif  }

   ; SAC 12/7/12 - added heat pump stuff
   ; added HPSysHSPF2 / HPSysHSPF2perHSPF scenario - SAC 10/09/22 (tic #3431)
	"Set ResHVACSys:cseRSYS:rsHSPF"				ResHVACSys:cseRSYS:rsHSPF			= {	if (HaveHtPump < 1 .OR. LocalRef( cseRSYS:rsType ) == 7) then  UNDEFINED
                                                                              else if (EffMetric = 2 .AND. IfValidAnd( HPSysHSPF2 > 0 ) .AND.
                                                                                       IfValidAnd( HPSysHSPF2perHSPF > 0 ))
                                                                              then  HPSysHSPF2 / HPSysHSPF2perHSPF
																										else if (IfValidAnd( HPSysHSPF > 0 ))
																										then  HPSysHSPF
																										else  UNDEFINED  endif endif endif  }
	"Set ResHVACSys:cseRSYS:rsCap47"				ResHVACSys:cseRSYS:rsCap47			= {	if (HaveHtPump < 1) then  UNDEFINED
																										else if (IfValidAnd( HPSysCap47 > 0 ))
																										then  HPSysCap47
																										else  UNDEFINED  endif endif  }
	; SAC 6/22/20 - revised to ensure writing of COP47 for ASHPPkgRoom (tic #1226)      ; VCHP2 - SAC 11/09/20    ; SAC 04/05/22 (WSHP)
	"Set ResHVACSys:cseRSYS:rsCOP47"				ResHVACSys:cseRSYS:rsCOP47			= {	if (HaveHtPump < 1 .OR. ((ResProj:ResAnalysisType > 2 .AND. cseRSYS:rsType != 7) .AND.
	                                                                                                    cseRSYS:rsType != 8 .AND. cseRSYS:rsType != 12 .AND. cseRSYS:rsType != 13)) then  UNDEFINED
																										else if (IfValidAnd( HPSysCOP47 > 0 ))
																										then  HPSysCOP47
																										else  UNDEFINED  endif endif  }
	"Set ResHVACSys:cseRSYS:rsCap35"				ResHVACSys:cseRSYS:rsCap35			= {	if (HaveHtPump < 1 .OR. (ResProj:ResAnalysisType > 2 .AND. cseRSYS:rsType != 12)) then  UNDEFINED
																										else if (IfValidAnd( HPSysCap35 > 0 ))
																										then  HPSysCap35
																										else  UNDEFINED  endif endif  }
	"Set ResHVACSys:cseRSYS:rsCOP35"				ResHVACSys:cseRSYS:rsCOP35			= {	if (HaveHtPump < 1 .OR. (ResProj:ResAnalysisType > 2 .AND. cseRSYS:rsType != 12)) then  UNDEFINED
																										else if (IfValidAnd( HPSysCOP35 > 0 ))
																										then  HPSysCOP35
																										else  UNDEFINED  endif endif  }
	"Set ResHVACSys:cseRSYS:rsCap17"				ResHVACSys:cseRSYS:rsCap17			= {	if (HaveHtPump < 1) then  UNDEFINED
																										else if (IfValidAnd( HPSysCap17 > 0 ))
																										then  HPSysCap17
																										else  UNDEFINED  endif endif  }
	"Set ResHVACSys:cseRSYS:rsCOP17"				ResHVACSys:cseRSYS:rsCOP17			= {	if (HaveHtPump < 1 .OR. ((ResProj:ResAnalysisType > 2 .AND. cseRSYS:rsType != 7) .AND.
                                                                                                       cseRSYS:rsType != 12)) then  UNDEFINED
																										else if (IfValidAnd( HPSysCOP17 > 0 ))
																										then  HPSysCOP17
																										else  UNDEFINED  endif endif  }

   ; SAC 6/24/20 - hard-wired to 1.2 for ALL heat pumps      ; include this fix stating w/ 2019.1.3 - SAC 7/15/20
   ; added for all HtPumpCap47AutoSz HPs based on logic from VCHP2 work - SAC 03/03/22
   "Set ResHVACSys:cseRSYS:rsFxCapAuxH"      ResHVACSys:cseRSYS:rsFxCapAuxH   =
      {  if (HaveHtPump < 1 .OR. IfValidAnd( Proj:AnalysisVersion >= 190103 )==0) then  UNDEFINED
         else if (HtPumpCap47AutoSz > 0.5 .AND. IfValidAnd( ResProj:RunAbbrev = "s" )==0 .AND. Proj:RunAbbrev != "zb" .AND.
                  IfValidAnd( ResProj:RunAbbrev = "smf" )==0 .AND. IfValidAnd( ResProj:RunAbbrev = "dr" )==0 .AND.
                  IfValidAnd( Proj:EnableResearchMode > 0.5 ) .AND. IfValidAnd( HtPumpSystem[1]:HtgAuxSizingFactor > 0 ))
         then  HtPumpSystem[1]:HtgAuxSizingFactor
         else  1.2  endif endif  }

  ; SAC 12/7/12 - added additional heat pump item - rsCapAuxH
  ; SAC 10/3/13 - removed AuxHtgCap from UI due to it being unnecessary as of CSE version 0.732
	;"Set ResHVACSys:cseRSYS:rsCapAuxH"			ResHVACSys:cseRSYS:rsCapAuxH		= {	if (HaveHtPump < 1) then  UNDEFINED
	;																									else if (IfValidAnd( HPSysAuxHtgCap > 0 ))
	;																									then  HPSysAuxHtgCap
	;																									else  UNDEFINED  endif endif  }

   ; rules/logic to support dual fuel HPs - SAC 12/09/20
   "Set ResHVACSys:cseRSYS:rsTypeAuxH - type of aux heating equipment"     ResHVACSys:cseRSYS:rsTypeAuxH =     ; (0) None, (1) Furnace, (2) Resistance
      {  if (IfValidAnd( HPModelDualFuel > 0 ) .AND. IfValidAnd( HPDFAFUE > 0 ))
         then  "Furnace"
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsAFUEAuxH"          ResHVACSys:cseRSYS:rsAFUEAuxH =
      {  if (IfValidAnd( cseRSYS:rsTypeAuxH = 1 ))
         then  HPDFAFUE / 100
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsASHPLockOutT"      ResHVACSys:cseRSYS:rsASHPLockOutT =
      {  if (IfValidAnd( cseRSYS:rsTypeAuxH = 1 ) .AND. IfValidAnd( HPLockoutTemp > -999 ))
         then  HPLockoutTemp
         else  UNDEFINED  endif  }

  ; SAC 8/29/13 - quick fix for heat pumps from Bruce via e-mail   ; SAC 6/25/20 - prevent rsParElec output for ASHPPkgRoom (8) (tic #1225 & #1226)   ; SAC 03/17/22 (WSHP)
	"Set ResHVACSys:cseRSYS:rsParElec_x"		ResHVACSys:cseRSYS:rsParElec_x	=        ; revised logic for new 2022+ crankcase htr formula that now also includes AC units - SAC 03/06/23
      {  if (Type == 4 .AND. IfValidAnd( CentralEqpType = 4 ) ) ; VRF
         then Format( "($tdboHrAv < %.1f) * %.3f", VRFCrankcaseCtrlTemp, VRFTotCprsrCrankcaseHtrCap )
         else if (IfValidAnd( Proj:CompCodeBase >= 2022 ))
         then  switch (cseRSYS:rsType)
                  case   8 :  UNDEFINED   ; "ASHPPkgRoom" 
                  case   9 :  UNDEFINED   ; "ACPkgRoom"   
                  case  10 :  UNDEFINED   ; "ACPkgRoomFurnace" 
                  case  11 :  UNDEFINED   ; "ACPkgRoomResistance" 
                  case  14 :  UNDEFINED   ; "FANCOIL"       ; SAC 03/07/23
                  default  :  Format( "($tdboHrAv < 50.) * (1.-@RSYSRes[%c%s%c].prior.H.hrsOn) * @RSYS[%c%s%c].capNomC * 10./12000.",
                                       34, cseRSYS:Name, 34, 34, cseRSYS:Name, 34 )
               endswitch
         else  if (cseRSYS:rsType == 8) then  UNDEFINED
               else if (IfValidAnd( HaveHtPump > 0 ) .AND. IfValidAnd( NumHtPumpSysUnits > 0 ))
               then  Format( "($tdboHrAv < 50) * 40 * %g", NumHtPumpSysUnits )
               else if (Type == 4 .AND. IfValidAnd( CentralEqpType = 2 ) .AND. IfValidAnd( NumCentralEqpUnits > 0 )) ; WSHP
               then Format( "($tdboHrAv < 50) * 40 * %g", NumCentralEqpUnits )
               else if (Type == 4 .AND. IfValidAnd( CentralEqpType = 4 ) ) ; VRF
               then Format( "($tdboHrAv < %.1f) * %.3f", VRFCrankcaseCtrlTemp, VRFTotCprsrCrankcaseHtrCap )
               else  UNDEFINED  endif endif endif endif
         endif endif  }
     ; {  if (cseRSYS:rsType == 8) then  UNDEFINED
     ;    else if (IfValidAnd( HaveHtPump > 0 ) .AND. IfValidAnd( NumHtPumpSysUnits > 0 ))
     ;    then  Format( "($tdboHrAv < 50) * 40 * %g", NumHtPumpSysUnits )
     ;    else if (Type == 4 .AND. IfValidAnd( CentralEqpType = 2 ) .AND. IfValidAnd( NumCentralEqpUnits > 0 )) ; WSHP
     ;    then Format( "($tdboHrAv < 50) * 40 * %g", NumCentralEqpUnits )
     ;    else if (Type == 4 .AND. IfValidAnd( CentralEqpType = 4 ) ) ; VRF
     ;    then Format( "($tdboHrAv < %.1f) * %.3f", VRFCrankcaseCtrlTemp, VRFTotCprsrCrankcaseHtrCap )
     ;    else  UNDEFINED  endif endif endif endif }

   "Set ResHVACSys:cseRSYS:rsDefrostModel - modeling options for ASHP outdoor coil defrosting when 17°F < TDbO < 45°F"        ; SAC 6/26/20 (tic #1225)
      ResHVACSys:cseRSYS:rsDefrostModel = {  if (cseRSYS:rsType == 8)      ; ASHPPkgRoom
							                     then  "None"  else  UNDEFINED  endif  }  

; "debug" ResHVACSys:action = { MessageBox( "HVACSys '%s' HaveCooling = %g / ClSysCFMperTon = %g", Name, HaveCooling, ClSysCFMperTon ) }
	"Set ResHVACSys:cseRSYS:rsVfPerTon"			ResHVACSys:cseRSYS:rsVfPerTon		= {	if (HaveCooling == 0) then  UNDEFINED
																										else if (IfValidAnd( ClSysCFMperTon > 0 ))
																										then  ClSysCFMperTon
																										else	UNDEFINED  endif endif  }

  ; SAC 5/13/13 - logic to account for ht/cl ducts toggled off    ; SAC 6/22/20 - prevent output for rsType = ASHPPkgRoom or ACPkgRoom (tic #1225, #1226)
	"Set ResHVACSys:cseRSYS:rsFanPwrH"			ResHVACSys:cseRSYS:rsFanPwrH		= {	if (LocalCompAssigned( Fan ) == 0) then  UNDEFINED
	                                                                           else if (cseRSYS:rsType == 8) then  UNDEFINED
																										else if (IfValidAnd( Fan:WperCFMCool > 0 ))
																										then  if (LocalRef( cseRSYS:rsDSEH ) == 1) then  0.0
																												else  Fan:WperCFMCool  endif
																										else	UNDEFINED  endif endif endif  }
	"Set ResHVACSys:cseRSYS:rsFanPwrC"			ResHVACSys:cseRSYS:rsFanPwrC		= {	if (LocalCompAssigned( Fan ) == 0 .OR. HaveCooling < 1) then  UNDEFINED
	                                                                           else if (cseRSYS:rsType >= 8 .AND. cseRSYS:rsType <= 11) then  UNDEFINED
																										else if (IfValidAnd( Fan:WperCFMCool > 0 ))
																										then  if (LocalRef( cseRSYS:rsDSEC ) == 1) then  0.0
																												else  Fan:WperCFMCool  endif
																										else	UNDEFINED  endif endif endif  }

; SAC 8/26/13 - added OAV (CFI (Central Fan Integrated) Cool Vent stuff)
; SAC 9/4/13 - revised to reflect NEW primary inputs of ResHVACSys:CFIClVentFlow & CFIClVentPwr  (as opposed to CFIClVentFan)
	"Set ResHVACSys:cseRSYS:rsOAVType"			ResHVACSys:cseRSYS:rsOAVType		= {	if (ResProj:EnableClVent > 0.5 .AND. ResProj:UnitClVentOption == 3)
																							;			then	if ( LocalCompAssigned( CFIClVentFan ) .AND.
																										then	if ( 
																													  ( Type == 3 .OR. 
																														 ((Type == 1 .OR. Type == 2) .AND. CFIClVentOption > 0) ) )
																							;					then	if (LocalStatus( CFIClVentFan:CoolingVent ) < 2 .OR. LocalStatus( CFIClVentFan:WperCFMCool ) < 2) then  0
																							;							else if (CFIClVentFan:CoolingVent <= 0 .OR. CFIClVentFan:WperCFMCool < 0) then  0
																												then	if (LocalStatus( CFIClVentFlow ) < 2 .OR. LocalStatus( CFIClVentPwr ) < 2) then  0
																														else if (CFIClVentFlow <= 0 .OR. CFIClVentPwr < 0) then  0
																														else if (Type == 3)
																														then	2				; "VarFlow"
																														else	1				; "FixedFlow"
																														endif endif endif
																												else  0  endif
																										else  0  endif  }

;	"Set ResHVACSys:cseRSYS:rsOAVReliefZn-1"		ResHVACSys:cseRSYS:Action	= {	if (GlobalCompAssigned( ResAttic:CSE_ZONE ))
;																									then	MessageBox( "GlobalCompAssigned( ResAttic:CSE_ZONE ) return TRUE" )
;																									else	MessageBox( "GlobalCompAssigned( ResAttic:CSE_ZONE ) return FALSE" )  endif  }
;	"Set ResHVACSys:cseRSYS:rsOAVReliefZn-2"		ResHVACSys:cseRSYS:Action	= {	MessageBox( "GlobalRef( ResAttic:CSE_ZONE:Name ) = '%s'", GlobalRef( ResAttic:CSE_ZONE:Name ) )  }
;	"Set ResHVACSys:cseRSYS:rsOAVReliefZn-msg"	ResHVACSys:cseRSYS:Action	= {	if (LocalRef( cseRSYS:rsOAVType ) < 0.5 .OR. LocalCompAssigned( CFIClVentAttic ) < 0.5) then  UNCHANGED
;																									else if (LocalCompAssigned( CFIClVentAttic:CSE_ZONE ) < 0.5) then  UNCHANGED
;																									else	PostMessageToLog( "   assigning Attic '%s' as rsOAVReliefZn for CSE RSYS '%s'", LocalRef( CFIClVentAttic:CSE_ZONE:Name ), Localref( cseRSYS:Name ) )  endif endif  }
;	"Set ResHVACSys:cseRSYS:rsOAVReliefZn"		ResHVACSys:cseRSYS:rsOAVReliefZn	= {	if (LocalRef( cseRSYS:rsOAVType ) > 0.5 .AND. GlobalCompAssigned( ResAttic:CSE_ZONE ) > 0.5) then  GlobalRef( ResAttic:CSE_ZONE:Name )  else  UNDEFINED  endif  }
	"Set ResHVACSys:cseRSYS:rsOAVReliefZn"		ResHVACSys:cseRSYS:rsOAVReliefZn	= {	if (LocalRef( cseRSYS:rsOAVType ) < 0.5 .OR. LocalCompAssigned( CFIClVentAttic ) < 0.5) then  UNDEFINED
																										else if (LocalCompAssigned( CFIClVentAttic:CSE_ZONE ) < 0.5) then  UNDEFINED
																										else	LocalRef( CFIClVentAttic:CSE_ZONE:Name )  endif endif  }
; SAC 9/4/13 - revised to reflect NEW primary inputs of ResHVACSys:CFIClVentFlow & CFIClVentPwr  (as opposed to CFIClVentFan)
	"Set ResHVACSys:cseRSYS:rsOAVVfDs"			ResHVACSys:cseRSYS:rsOAVVfDs		= {	if (LocalCompAssigned( cseRSYS:rsOAVReliefZn )) then  CFIClVentFlow  else  UNDEFINED  endif  }
	"Set ResHVACSys:cseRSYS:rsOAVFanPwr"		ResHVACSys:cseRSYS:rsOAVFanPwr	= {	if (LocalCompAssigned( cseRSYS:rsOAVReliefZn )) then  CFIClVentPwr   else  UNDEFINED  endif  }


;	"Set ResHVACSys:cseRSYS:rsMtrH"				ResHVACSys:cseRSYS:rsMtrH			= {	if (LocalCompAssigned( HeatSystem ) == 0) then  UNDEFINED
;																										else if (Global( ResProj:NatGasAvailable ) > 0.5)
;																										then  Global( ResProj:cseNatGasHVACMtr )
;																										else  Global( ResProj:cseElecHVACMtr )  endif endif  }
;	"Set ResHVACSys:cseRSYS:rsMtrC"				ResHVACSys:cseRSYS:rsMtrC			= {	if (LocalCompAssigned( CoolSystem ) == 0) then  UNDEFINED
;																										else  Global( ResProj:cseElecHVACMtr )  endif  }

   ; SAC 11/4/18 - separate rules to setup VCHP RSYS inputs  - SAC 11/5/18 - logic to prevent these settings for runs other than User or Prop*   ; VCHP2 - SAC 11/01/20
   "Setup VCHP or WSHP RSYS"     ResHVACSys:cseRSYS:Action  =     ; SAC 03/17/22 (WSHP)  ; SAC 04/05/22 (WSHP)
      {  if (HaveHtPump > 0 .AND. 
             (ResProj:RunAbbrev = "p"   .OR. ResProj:RunAbbrev = "p-N" .OR. ResProj:RunAbbrev = "p-E" .OR. 
                                          ResProj:RunAbbrev = "p-S" .OR. ResProj:RunAbbrev = "p-W" .OR.
              ResProj:RunAbbrev = "pfx" .OR. ResProj:RunAbbrev = "pfx-N" .OR. ResProj:RunAbbrev = "pfx-E" .OR.
                                          ResProj:RunAbbrev = "pfx-S" .OR. ResProj:RunAbbrev = "pfx-W" .OR.
              ResProj:RunAbbrev = "pp"  .OR. ResProj:RunAbbrev = "pp-N" .OR. ResProj:RunAbbrev = "pp-E" .OR.
                                          ResProj:RunAbbrev = "pp-S" .OR. ResProj:RunAbbrev = "pp-W" ))
         then  if (HtPumpSysType == 22)
               then  EvalRulelist( "HVACSys_SetupRSYS_VCHP", 1 )
               else if (HtPumpSysType == 33)
               then  EvalRulelist( "HVACSys_SetupRSYS_VCHP2", 1 )
               else if (Type == 4 .AND. CentralEqpType == 1)
               then  EvalRulelist( "HVACSys_SetupRSYS_CentralFPFC", 1 )
               else if (Type == 4 .AND. CentralEqpType == 2)
               then  EvalRulelist( "HVACSys_SetupRSYS_CentralWSHP", 1 )
               else if (Type == 4 .AND. CentralEqpType == 4)
               then  EvalRulelist( "HVACSys_SetupRSYS_CentralVRF", 1 )
               else  UNCHANGED  endif endif endif endif endif
         else  UNCHANGED  endif  }
   "Setup FPFC RSYS"     ResHVACSys:cseRSYS:Action  =     ; JP 11/03/22 (FPFC)
    { if (Type == 4 .AND. CentralEqpType == 1) then  EvalRulelist( "HVACSys_SetupRSYS_CentralFPFC", 1 ) else UNCHANGED endif }

; TO DO - default properly based on the TYPE of HVAC equipment defined
	"Set ResHVACSys:cseRSYS:Fuel_HaveElec"		ResHVACSys:cseRSYS:Fuel_HaveElec    = {	1  }
;	"Set ResHVACSys:cseRSYS:Fuel_HaveNatGas"	ResHVACSys:cseRSYS:Fuel_HaveNatGas  = {	1  }
;	"Set ResHVACSys:cseRSYS:Fuel_HaveOther"	ResHVACSys:cseRSYS:Fuel_HaveOther   = {	0  }
	"Set ResHVACSys:cseRSYS:Fuel_HaveNatGas"	ResHVACSys:cseRSYS:Fuel_HaveNatGas  = {	if (ResProj:Fuel_HaveNatGas > 0.5) then  1  else  0  endif  }
	"Set ResHVACSys:cseRSYS:Fuel_HaveOther"	ResHVACSys:cseRSYS:Fuel_HaveOther   = {	if (ResProj:Fuel_HaveNatGas > 0.5) then  0  else  1  endif  }

   "Blast rsEER if rsCOP95 is specified"  cseRSYS:rsEER =                     ; SAC 09/23/21 (VCHP2)
      {  if (IfValidAnd( rsEER > 0 ) .AND. IfValidAnd( rsCOP95 > 0 ))
         then  UNDEFINED
         else  UNCHANGED  endif  }

  ; Assignment of CSE ZONEs to CSE RSYSs
;	"Set cseZONE:znRSysH"	cseZONE:znRSysH	= {	if (LocalCompAssigned( SourceZone ) == 0) then  UNDEFINED
;																	else if (LocalCompAssigned( SourceZone:HVACSystem ) == 0) then  UNDEFINED
;																	else if (LocalCompAssigned( SourceZone:HVACSystem:HeatSystem ) == 0) then  UNDEFINED
;																	else if (LocalCompAssigned( SourceZone:HVACSystem:cseRSYS ) == 0) then  UNDEFINED
;																	else  LocalRef( SourceZone:HVACSystem:cseRSYS )  endif endif endif endif  }
;	"Set cseZONE:znRSysC"	cseZONE:znRSysC	= {	if (LocalCompAssigned( SourceZone ) == 0) then  UNDEFINED
;																	else if (LocalCompAssigned( SourceZone:HVACSystem ) == 0) then  UNDEFINED
;																	else if (LocalCompAssigned( SourceZone:HVACSystem:CoolSystem ) == 0) then  UNDEFINED
;																	else if (LocalCompAssigned( SourceZone:HVACSystem:cseRSYS ) == 0) then  UNDEFINED
;																	else  LocalRef( SourceZone:HVACSystem:cseRSYS )  endif endif endif endif  }
;	"debugging"		cseZONE:Action		= {	MessageBox( "cseZONE:znRSys rule:  SourceZone = '%s' | ResProj:RunScope = %g | SourceZone:HVACSysStatus = %g | SourceZone:HVACSystem = '%s' | SourceZone:HVACSystem:cseRSYS = '%s' | SourceZone:HVACSystem:HaveHeating = %g | SourceZone:HVACSystem:HaveCooling = %g",
;																			SourceZone:Name, ResProj:RunScope, SourceZone:HVACSysStatus, SourceZone:HVACSystem:Name, SourceZone:HVACSystem:cseRSYS:Name, SourceZone:HVACSystem:HaveHeating, SourceZone:HVACSystem:HaveCooling )  }
; SAC 12/16/13 - mods to rule to assign appropriate new vs. E+A+A system to cseZONE
   ; SAC 9/10/19 - revisions for OtherZone (MFamProto)
   ; revise logic to ensure no znRSys assigned when ResOtherZn assigns an AirSys (translated to TERMINAL & AIRHANDLER) - SAC 05/11/22
	"Set cseZONE:znRSys"		cseZONE:znRSys		=
      {  if (LocalCompAssigned( SourceZone ) > 0)
         then  if (ResProj:RunScope == 2 .AND. SourceZone:HVACSysStatus == 2)
					then       if (LocalCompAssigned( SourceZone:AltHVACSystem ) == 0) then  UNDEFINED
							else if (LocalCompAssigned( SourceZone:AltHVACSystem:cseRSYS ) == 0) then  UNDEFINED
							else if (SourceZone:AltHVACSystem:HaveHeating == 0 .AND.
										SourceZone:AltHVACSystem:HaveCooling == 0) then  UNDEFINED
							else  LocalRef( SourceZone:AltHVACSystem:cseRSYS )  endif endif endif
					else if (ResProj:RunScope == 2 .AND. SourceZone:HVACSysStatus == 1)
					then       if (LocalCompAssigned( SourceZone:exHVACSystem ) == 0) then  UNDEFINED
							else if (LocalCompAssigned( SourceZone:exHVACSystem:cseRSYS ) == 0) then  UNDEFINED
							else if (SourceZone:exHVACSystem:HaveHeating == 0 .AND.
										SourceZone:exHVACSystem:HaveCooling == 0) then  UNDEFINED
							else  LocalRef( SourceZone:exHVACSystem:cseRSYS )  endif endif endif
					else       if (LocalCompAssigned( SourceZone:HVACSystem ) == 0) then  UNDEFINED
							else if (LocalCompAssigned( SourceZone:HVACSystem:cseRSYS ) == 0) then  UNDEFINED
							else if (SourceZone:HVACSystem:HaveHeating == 0 .AND.
										SourceZone:HVACSystem:HaveCooling == 0) then  UNDEFINED
							else  LocalRef( SourceZone:HVACSystem:cseRSYS )  endif endif endif
					endif endif
			else if (LocalCompAssigned( SourceOtherZone ) > 0)  
			then       if (LocalCompAssigned( SourceOtherZone:ozHVACSystem ) == 0 .OR.
                        LocalCompAssigned( SourceOtherZone:ozHVACSystem ) == ComponentType( "AirSys" )) then  UNDEFINED
					else if (LocalCompAssigned( SourceOtherZone:ozHVACSystem:cseRSYS ) == 0) then  UNDEFINED
					else if (SourceOtherZone:ozHVACSystem:HaveHeating == 0 .AND.
								SourceOtherZone:ozHVACSystem:HaveCooling == 0) then  UNDEFINED
					else  LocalRef( SourceOtherZone:ozHVACSystem:cseRSYS )  endif endif endif
			else  UNDEFINED  endif endif  }

; SAC 5/16/12 - experiment w/out ducts...
;	"Create new cseRSYS:DuctWrapMaterial"  			cseRSYS:DuctWrapMaterial				= {	CreateComp( cseMATERIAL, "DuctWrap-" + Local( Name ) )  }
;	"Default cseRSYS:DuctWrapMaterial:matCond"		cseRSYS:DuctWrapMaterial:matCond  	= {	0.032  } 		; prioperties based on contents of sample CSE input from CB ACtest1x.cse 5/9/12
;	"Default cseRSYS:DuctWrapMaterial:matCondCT"		cseRSYS:DuctWrapMaterial:matCondCT	= {	0.00418  }
;	"Default cseRSYS:DuctWrapMaterial:matSpHt"		cseRSYS:DuctWrapMaterial:matSpHt  	= {	0.2  }
;	"Default cseRSYS:DuctWrapMaterial:matDens"		cseRSYS:DuctWrapMaterial:matDens  	= {	0.7  }
;	"Default cseRSYS:DuctWrapMaterial:matThk"			cseRSYS:DuctWrapMaterial:matThk   	= {	4/12  }


; SAC 5/13/13 - moved UP to include in logic related to setting rsDSEC & rsDSEH
;	"Set cseRSYS:Cr8SupplyDuct"		cseRSYS:Cr8SupplyDuct	= {
;				if (LocalCompAssigned( SourceHVACSys:DistribSystem ) == 0) then  0
;				else if (SourceHVACSys:DistribSystem:DuctsPresent == 0) then  0
;				else if (SourceHVACSys:DistribSystem:DuctLeakageValUse <= 0 .OR.
;							SourceHVACSys:DistribSystem:DuctInsAdjRval <= 0 .OR.
;							SourceHVACSys:DistribSystem:SupplyDuctArea <= 0 .OR.
;							SourceHVACSys:DistribSystem:SupplyDuctDiam <= 0 ) then  0
;				else  1  endif endif endif  }
;
;	"Set cseRSYS:Cr8ReturnDuct"		cseRSYS:Cr8ReturnDuct	= {
;				if (LocalCompAssigned( SourceHVACSys:DistribSystem ) == 0) then  0
;				else if (SourceHVACSys:DistribSystem:DuctsPresent == 0) then  0
;				else if (SourceHVACSys:DistribSystem:DuctLeakageValUse <= 0 .OR.
;							SourceHVACSys:DistribSystem:RetDuctInsAdjRval <= 0 .OR.
;							SourceHVACSys:DistribSystem:ReturnDuctArea <= 0 .OR.
;							SourceHVACSys:DistribSystem:ReturnDuctDiam <= 0 ) then  0
;				else  1  endif endif endif  }


	"Create a CSE Supply DUCTSEG for each cseRSYS"	cseRSYS:SupplyDuct	= {	if (Cr8SupplyDuct < 0.5) then  UNCHANGED
																										else  CreateComp( cseDUCTSEG, "SupplyDuct-" + substr( Name, 0, 42 ) )  endif  }
	"Set cseRSYS:SupplyDuct:Parent"			cseRSYS:SupplyDuct:Parent		= {	Local( Name )  }
	"Set cseRSYS:SupplyDuct:dsTy"				cseRSYS:SupplyDuct:dsTy			= {	"SUPPLY"  }
	"Set cseRSYS:SupplyDuct:dsInArea"		cseRSYS:SupplyDuct:dsInArea	= {	SourceHVACSys:DistribSystem:SupplyDuctArea  }
	"Set cseRSYS:SupplyDuct:dsDiameter"		cseRSYS:SupplyDuct:dsDiameter	= {	SourceHVACSys:DistribSystem:SupplyDuctDiam / 12  }
	"Set cseRSYS:SupplyDuct:dsInsulR"		cseRSYS:SupplyDuct:dsInsulR	= {	SourceHVACSys:DistribSystem:DuctInsAdjRval  }
	"Set cseRSYS:SupplyDuct:dsLeakF"			cseRSYS:SupplyDuct:dsLeakF		= {	SourceHVACSys:DistribSystem:DuctLeakageValUse * 0.585 / 100  }
	"Set cseRSYS:SupplyDuct:dsExCnd"			cseRSYS:SupplyDuct:dsExCnd		= {	if (SourceHVACSys:DistribSystem:DuctLocation == 6) then  "AMBIENT"		; DuctLocation = "Outside"  - SAC 9/4/13 - to address GC issue 164
																										else  UNDEFINED  endif  }
; SupplyDuctLoc could point to several different object types, meaning eval-time parsing of LocalRef() is required
	"Set cseRSYS:SupplyDuct:dsAdjZn"			cseRSYS:SupplyDuct:dsAdjZn		= {	if (SourceHVACSys:DistribSystem:DuctLocation == 6 .OR.
																											 LocalCompAssigned( SourceHVACSys:DistribSystem:SupplyDuctLocUse ) < 0.5) then  UNDEFINED
																										else  SourceHVACSys:DistribSystem:SupplyDuctLocUse:CSE_ZONE  endif  }

;	"Set cseRSYS:SupplyDuct:dsAdjZn - 1"	cseRSYS:SupplyDuct:dsAdjZn		= {	if (ComponentCount( Attic ) > 0.5)
;																										then	if (GlobalCompAssigned( ResAttic:CSE_ZONE ) > 0.5)
;																												then	Global( ResAttic:CSE_ZONE )
;																												else  UNDEFINED  endif
;																										else  UNDEFINED  endif  }
;	"Set cseRSYS:SupplyDuct:dsAdjZn - 2"	cseRSYS:SupplyDuct:dsAdjZn		= {	if (LocalCompAssigned( SupplyDuct:dsAdjZn ) > 0.5) then  UNCHANGED
;																										else	if (ComponentCount( CrawlSpace ) > 0.5)
;																												then	if (GlobalCompAssigned( ResCrawlSpc:CSE_ZONE ) > 0.5)
;																														then	Global( ResCrawlSpc:CSE_ZONE )
;																														else  UNCHANGED  endif
;																												else  UNCHANGED  endif endif  }
;	"Set cseRSYS:SupplyDuct:dsAdjZn - 3"	cseRSYS:SupplyDuct:dsAdjZn		= {	if (LocalCompAssigned( SupplyDuct:dsAdjZn ) > 0.5) then  UNCHANGED
;																										else	if (ComponentCount( cseZONE ) > 0.5)
;																												then	MaxAllComp( cseZONE:znVol )
;																												else	UNCHANGED  endif endif  }
;	"Set cseRSYS:SupplyDuct:dsInsulMat"		cseRSYS:SupplyDuct:dsInsulMat	= {	Local( DuctWrapMaterial )  }


	"Create a CSE Return DUCTSEG for each cseRSYS"	cseRSYS:ReturnDuct	= {	if (Cr8ReturnDuct < 0.5) then  UNCHANGED
																										else  CreateComp( cseDUCTSEG, "ReturnDuct-" + substr( Name, 0, 42 ) )  endif  }
	"Set cseRSYS:ReturnDuct:Parent"			cseRSYS:ReturnDuct:Parent		= {	Local( Name )  }
	"Set cseRSYS:ReturnDuct:dsTy"				cseRSYS:ReturnDuct:dsTy			= {	"RETURN"  }
	"Set cseRSYS:ReturnDuct:dsInArea"		cseRSYS:ReturnDuct:dsInArea	= {	SourceHVACSys:DistribSystem:ReturnDuctArea  }
	"Set cseRSYS:ReturnDuct:dsDiameter"		cseRSYS:ReturnDuct:dsDiameter	= {	SourceHVACSys:DistribSystem:ReturnDuctDiam / 12  }
	"Set cseRSYS:ReturnDuct:dsInsulR"		cseRSYS:ReturnDuct:dsInsulR	= {	SourceHVACSys:DistribSystem:RetDuctInsAdjRval  }
	"Set cseRSYS:ReturnDuct:dsLeakF"			cseRSYS:ReturnDuct:dsLeakF		= {	SourceHVACSys:DistribSystem:DuctLeakageValUse * 0.415 / 100  }
	"Set cseRSYS:ReturnDuct:dsExCnd"			cseRSYS:ReturnDuct:dsExCnd		= {	if (SourceHVACSys:DistribSystem:DuctLocation == 6) then  "AMBIENT"		; DuctLocation = "Outside"  - SAC 9/4/13 - to address GC issue 164
																										else  UNDEFINED  endif  }
; ReturnDuctLoc could point to several different object types, meaning eval-time parsing of LocalRef() is required
	"Set cseRSYS:ReturnDuct:dsAdjZn"			cseRSYS:ReturnDuct:dsAdjZn		= {	if (SourceHVACSys:DistribSystem:DuctLocation == 6 .OR.
																											 LocalCompAssigned( SourceHVACSys:DistribSystem:ReturnDuctLocUse ) < 0.5) then  UNDEFINED
																										else  SourceHVACSys:DistribSystem:ReturnDuctLocUse:CSE_ZONE  endif  }

;	"Set cseRSYS:ReturnDuct:dsAdjZn - 1"	cseRSYS:ReturnDuct:dsAdjZn		= {	if (ComponentCount( Attic ) > 0.5)
;																										then	if (GlobalCompAssigned( ResAttic:CSE_ZONE ) > 0.5)
;																												then	Global( ResAttic:CSE_ZONE )
;																												else  UNDEFINED  endif
;																										else  UNDEFINED  endif  }
;	"Set cseRSYS:ReturnDuct:dsAdjZn - 2"	cseRSYS:ReturnDuct:dsAdjZn		= {	if (LocalCompAssigned( ReturnDuct:dsAdjZn ) > 0.5) then  UNCHANGED
;																										else	if (ComponentCount( CrawlSpace ) > 0.5)
;																												then	if (GlobalCompAssigned( ResCrawlSpc:CSE_ZONE ) > 0.5)
;																														then	Global( ResCrawlSpc:CSE_ZONE )
;																														else  UNCHANGED  endif
;																												else  UNCHANGED  endif endif  }
;	"Set cseRSYS:ReturnDuct:dsAdjZn - 3"	cseRSYS:ReturnDuct:dsAdjZn		= {	if (LocalCompAssigned( ReturnDuct:dsAdjZn ) > 0.5) then  UNCHANGED
;																										else	if (ComponentCount( cseZONE ) > 0.5)
;																												then	MaxAllComp( cseZONE:znVol )
;																												else	UNCHANGED  endif endif  }
;	"Set cseRSYS:ReturnDuct:dsInsulMat"		cseRSYS:ReturnDuct:dsInsulMat	= {	Local( DuctWrapMaterial )  }


;  0,  "ResZn",     "ResZn (not attic)",    100,  0,  0, "Project", "", "", "", "", -1,  1,  0,   3000
;  1,           "Type",              BEMP_Sym,  1, "",                 0, "",         0, "",             3004, "Zone type"    
;	1,           "HVACSystem",        BEMP_Obj,  1,  0,  0, "",         0,  1, "HVACSys",  1, "Type",  3006, "HVAC system assignment" 
;	1,           "CoolVentSystem",    BEMP_Obj,  1,  0,  0, "",         0,  1, "HVACSys", 10, "Type",  3006, "Cooling Ventilation System assignment" 
;	1,           "IAQVentSystem",     BEMP_Obj,  1,  0,  0, "",         0,  1, "HVACSys", 20, "Type",  3006, "IAQ Ventilation System assignment" 
;  
;  0,  "cseZONE",  "cseZONE",            200,  0,  0, "Project", "", "", "", "", -1,  1,  0,   3400
;  1,           "SourceZone",        BEMP_Obj,  1, "",                 0, "Zone",     0, "",             6095, "CZone that is the source of this component" 
;  1,           "znRSysH",           BEMP_Obj,  1, "",                 0, "cseRSYS",  0, "",             6095, "RSYS component supplying Space Heating to this ZONE" 
;  1,           "znRSysC",           BEMP_Obj,  1, "",                 0, "cseRSYS",  0, "",             6095, "RSYS component supplying Cooling to this ZONE" 
;  
;  0,  "HVACSys", "HVAC System",         100,  0,  0, "",        "", "", "", "", -1,  1,  0,   8000
;  1,           "Type",              BEMP_Sym,  1, "",                 0, "",            0, "",             8001, "HVAC system type"    
;  1,           "HeatSystem",        BEMP_Obj,  1, "",                 0, "HVACHeat",    0, "",             8004, "Heating component"    
;  1,           "CoolSystem",        BEMP_Obj,  1, "",                 0, "HVACCool",    0, "",             8006, "Cooling component"    
;  1,           "DistribSystem",     BEMP_Obj,  1, "",                 0, "HVACDist",    0, "",             8008, "Distribution system"    
;  1,           "Fan",               BEMP_Obj,  1, "",                 0, "HVACFan",     0, "",             8010, "Fan type/system"    
;  1,           "FloorAreaServed",   BEMP_Flt,  1, "ft2",              0, "",            0, "",             8008, "Floor area served by this system"    
;  1,           "HasCentralFurnace", BEMP_Int,  1, "",                 0, "",            0, "",             8008, "Flag indicating presence of central furnace"    
;  1,           "CSE_RSYS",          BEMP_Obj,  1, "",                 0, "cseRSYS",     0, "",             7010, "CSE RSYS component" 
;  
;  0,  "cseMETER", "cseMETER",            100,  0,  0, "",        "", "", "", "", -1,  1,  0,   1800
;  
;  0,  "cseRSYS",  "cseRSYS",            1000,  0,  0, "",        "", "", "", "", -1,  1,  0,   3000
;  1,           "rsEffH",            BEMP_Flt,  1, "??",               0, "",         0, "",            3208, "Heating efficiency"    
;  1,           "rsEffC",            BEMP_Flt,  1, "??",               0, "",         0, "",            3208, "Cooling efficiency"    
;  1,           "rsMtrH",            BEMP_Obj,  1, "",                 0, "cseMETER", 0, "",            3208, "Heating energy use meter"    
;  1,           "rsMtrC",            BEMP_Obj,  1, "",                 0, "cseMETER", 0, "",            3208, "Cooling energy use meter"    
;  1,           "SourceHVACSys",     BEMP_Obj,  1, "",                 0, "HVACSys",  0, "",            7010, "HVACSys that is the source of this component" 


 ;-----------------------
 ; HVACSys AirNet
 ;-----------------------
; old (second round version) of cool vent (ClVent) data
; SAC 8/27/13 - RESTORED use of ResHVACSys:AirNet_CoolVent & ResHVACSys:AirNet_CoolVentWpCFM for CFI-based CoolVent
	"Set ResHVACSys:AirNet_CoolVent"			ResHVACSys:AirNet_CoolVent			= {	CFIClVentFlow  }
	"Set ResHVACSys:AirNet_CoolVentWpCFM"	ResHVACSys:AirNet_CoolVentWpCFM	= {	CFIClVentPwr   }
;	"Set ResHVACSys:AirNet_CoolVent"			ResHVACSys:AirNet_CoolVent			= {	if (Local( Type ) == 1 .OR. Local( Type ) == 10)  ; central cool/heat or cooling vent systems
;																									then	if (LocalCompAssigned( Fan ))
;																											then	LocalRef( Fan:CoolingVent )
;																											else	0  endif
;																									else	0  endif  }
;	"Set ResHVACSys:AirNet_CoolVentWpCFM"	ResHVACSys:AirNet_CoolVentWpCFM	= {	if (Local( Type ) == 1 .OR. Local( Type ) == 10)  ; central cool/heat or cooling vent systems
;																									then	if (LocalCompAssigned( Fan ))
;																											then	LocalRef( Fan:WperCFMCool )
;																											else	0  endif
;																									else	0  endif  }

;	mjb	use Evap Cond Effectiveness in CSE string to define outdoor air temp seen by HVACSys (if CoolSystem = EvapCond)	7/29/14
;	"Set ResHVACSys:cseRSYS:rsTdbOut_x"			ResHVACSys:cseRSYS:rsTdbOut_x		= {	if (HaveEvapCond > 0 .AND. ResProj:RunNumber < 2) then
;																											Format("%g * $tWbO + %g * $tDbO", SysEvapCondEff, (1 - SysEvapCondEff))
;																										else  UNDEFINED  endif  }
;	"debugging"		ResHVACSys:Action	= {	MessageBox( "cseRSYS rsTdbOut:  %s", ResHVACSys:cseRSYS:rsTdbOut_x )  }

; testing response to CSE ERRORS
;	"Blast ResHVACSys:cseRSYS:rsType"		ResHVACSys:cseRSYS:rsType	= {   UNDEFINED  }
;	"Blast ResHVACSys:cseRSYS:rsSEER"		ResHVACSys:cseRSYS:rsSEER	= {	UNDEFINED  }
;	"Blast ResHVACSys:cseRSYS:rsEER"			ResHVACSys:cseRSYS:rsEER	= {	UNDEFINED  }

END
;*************************************************************************


;*************************************************************************
RULELIST "HVACSys_SetupRSYS_VCHP" 1 0 0 1
;*************************************************************************
   "Set ResHVACSys:cseRSYS:rsFEffC_x"     ResHVACSys:cseRSYS:rsFEffC_x    = {  "1/FVCHPC"  }
   "Set ResHVACSys:cseRSYS:rsFanPwrC"     ResHVACSys:cseRSYS:rsFanPwrC    = {  UNDEFINED  }
   "Set ResHVACSys:cseRSYS:rsFanPwrC_x"   ResHVACSys:cseRSYS:rsFanPwrC_x  = {  "0.35*FVCHPC"  }

   "Set ResHVACSys:cseRSYS:rsFEffH_x"     ResHVACSys:cseRSYS:rsFEffH_x    = {  "1/FVCHPH"  }
   "Set ResHVACSys:cseRSYS:rsFanPwrH"     ResHVACSys:cseRSYS:rsFanPwrH    = {  UNDEFINED  }
   "Set ResHVACSys:cseRSYS:rsFanPwrH_x"   ResHVACSys:cseRSYS:rsFanPwrH_x  = {  "0.35*FVCHPH"  }

   "Blast ResHVACSys:cseRSYS:rsCap35"     ResHVACSys:cseRSYS:rsCap35      = {  UNDEFINED  }  ; SAC 11/13/18 - removed Cap35 & Cap17 for VCHP
   "Blast ResHVACSys:cseRSYS:rsCap17"     ResHVACSys:cseRSYS:rsCap17      = {  UNDEFINED  }

   "Set ResHVACSys:cseRSYS:rsDefrostModel"   ResHVACSys:cseRSYS:rsDefrostModel  = {  "REVCYCLE"  }
END
;*************************************************************************

;************************************************************************* - SAC 11/01/20 - SAC 11/10/20
RULELIST "HVACSys_SetupRSYS_VCHP2" 1 0 0 1
;*************************************************************************
   "Set ResHVACSys:cseRSYS:rsFEffC_x"     ResHVACSys:cseRSYS:rsFEffC_x    = {  UNDEFINED  }   ; "1/FVCHPC"  }
   "Set ResHVACSys:cseRSYS:rsFanPwrC"     ResHVACSys:cseRSYS:rsFanPwrC    =
      {  if (IfValidAnd( HtPumpSystem[1]:VCHPFanPwrHC[2] > 0 ))
         then  HtPumpSystem[1]:VCHPFanPwrHC[2]
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsFanPwrC_x"   ResHVACSys:cseRSYS:rsFanPwrC_x  = {  UNDEFINED  }   ; "0.35*FVCHPC"  }

   "Set ResHVACSys:cseRSYS:rsFEffH_x"     ResHVACSys:cseRSYS:rsFEffH_x    = {  UNDEFINED  }   ; "1"  }     ; don't use VCHP mult for htg - was: 1/FVCHPH - SAC 11/01/20
   "Set ResHVACSys:cseRSYS:rsFanPwrH"     ResHVACSys:cseRSYS:rsFanPwrH    =
      {  if (IfValidAnd( HtPumpSystem[1]:VCHPFanPwrHC[1] > 0 ))
         then  HtPumpSystem[1]:VCHPFanPwrHC[1]
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsFanPwrH_x"   ResHVACSys:cseRSYS:rsFanPwrH_x  = {  UNDEFINED  }   ; "0.35*FVCHPH"  }

   "Blast ResHVACSys:cseRSYS:rsCap17"     ResHVACSys:cseRSYS:rsCap17      = {  UNDEFINED  }     ; removed Cap17 & Cap05 for VCHP2 - SAC 07/26/21
;   "Blast ResHVACSys:cseRSYS:rsCap05"     ResHVACSys:cseRSYS:rsCap05      = {  UNDEFINED  } 

   ; SAC 03/03/22 - was: {  1.2  }  ; UNDEFINED  }      ; undef -> 1.2 - SAC 02/25/22
   "Set ResHVACSys:cseRSYS:rsFxCapAuxH"   ResHVACSys:cseRSYS:rsFxCapAuxH   =   ; revised logic to set rsFxCapAuxH regardless of AutoSize flag - SAC 03/22/22
      {  if (IfValidAnd( Proj:EnableResearchMode > 0.5 ) .AND.
             IfValidAnd( HtPumpSystem[1]:HtgAuxSizingFactor > 0 ))
         then  HtPumpSystem[1]:HtgAuxSizingFactor
         else  1.2  endif  }

	"throw error if ResHVACSys:cseRSYS:rsOAVType != 'None'"		ResHVACSys:Action		=     ; VCHP2 - SAC 11/10/20
      {	if (IfValidAnd( cseRSYS:rsOAVType > 0 ))
         then  switch (cseRSYS:rsOAVType)
                  case  1 :   PostError( "OAV type 'FixedFlow' incompatible with VCHP2 system '%s' (CSE RSYS '%s')", Name, cseRSYS:Name )
                  case  2 :   PostError( "OAV type 'VarFlow' incompatible with VCHP2 system '%s' (CSE RSYS '%s')", Name, cseRSYS:Name )
                  default :  UNCHANGED
               endswitch
         else  UNCHANGED  endif  }

   "Set ResHVACSys:cseRSYS:rsCap17"       ResHVACSys:cseRSYS:rsCap17  =             ; SAC 09/23/21
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
             IfValidAnd( HtPumpSystem[1]:Cap17 > 0 ))
         then  HtPumpSystem[1]:Cap17
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat1747_x" ResHVACSys:cseRSYS:rsCapRat1747_x  =     ; SAC 02/11/22
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap17 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap47  > 0 ))
         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap17, HtPumpSystem[1]:Cap47 )
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat1747"  ResHVACSys:cseRSYS:rsCapRat1747  =        ; mod to output even when autosizing - SAC 07/26/21
      {  if (LocalStatus( cseRSYS:rsCapRat1747_x ) < 1 .AND.
             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap1747Ratio > 0 ))
         then  HtPumpSystem[1]:Cap1747Ratio
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCap115"      ResHVACSys:cseRSYS:rsCap115  =            ; SAC 09/22/21
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
             IfValidAnd( HtPumpSystem[1]:Cap115 > 0 ))
         then  HtPumpSystem[1]:Cap115
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat11595_x" ResHVACSys:cseRSYS:rsCapRat11595_x  =   ; SAC 02/11/22
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap115 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap95  > 0 ))
         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap115, HtPumpSystem[1]:Cap95 )
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat11595" ResHVACSys:cseRSYS:rsCapRat11595  =       ; SAC 09/22/21
      {  if (LocalStatus( cseRSYS:rsCapRat11595_x ) < 1 .AND.
             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap11595Ratio > 0 ))
         then  HtPumpSystem[1]:Cap11595Ratio
         else  UNDEFINED  endif  }

;   "Set ResHVACSys:cseRSYS:rsCap95"       ResHVACSys:cseRSYS:rsCap95  =             ; SAC 09/22/21
   "Set ResHVACSys:cseRSYS:rsCapC"        ResHVACSys:cseRSYS:rsCapC  =              ; SAC 09/23/21
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
             IfValidAnd( HtPumpSystem[1]:Cap95 > 0 ))
         then  HtPumpSystem[1]:Cap95
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat9547_x" ResHVACSys:cseRSYS:rsCapRat9547_x  =     ; SAC 02/11/22
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap95 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap47  > 0 ))
         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap95, HtPumpSystem[1]:Cap47 )
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat9547"  ResHVACSys:cseRSYS:rsCapRat9547  =        ; SAC 01/08/22
      {  if (LocalStatus( cseRSYS:rsCapRat9547_x ) < 1 .AND.
             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap95 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap47 > 0 ))
         then  HtPumpSystem[1]:Cap95 / HtPumpSystem[1]:Cap47
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCap82"       ResHVACSys:cseRSYS:rsCap82  =             ; SAC 09/22/21
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
             IfValidAnd( HtPumpSystem[1]:Cap82 > 0 ))
         then  HtPumpSystem[1]:Cap82
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat8295_x" ResHVACSys:cseRSYS:rsCapRat8295_x  =     ; SAC 02/11/22
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap82 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap95  > 0 ))
         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap82, HtPumpSystem[1]:Cap95 )
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat8295"  ResHVACSys:cseRSYS:rsCapRat8295  =        ; SAC 09/22/21
      {  if (LocalStatus( cseRSYS:rsCapRat8295_x ) < 1 .AND.
             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap8295Ratio > 0 ))
         then  HtPumpSystem[1]:Cap8295Ratio
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCap05"       ResHVACSys:cseRSYS:rsCap05  =             ; SAC 09/22/21
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
             IfValidAnd( HtPumpSystem[1]:Cap05 > 0 ))
         then  HtPumpSystem[1]:Cap05
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat0547_x" ResHVACSys:cseRSYS:rsCapRat0547_x  =     ; SAC 02/11/22
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap05 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap47  > 0 ))
         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap05, HtPumpSystem[1]:Cap47 )
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCapRat0547"  ResHVACSys:cseRSYS:rsCapRat0547  =        ; SAC 07/26/21   ; mod to only output when autosizing - SAC 09/22/21
      {  if (LocalStatus( cseRSYS:rsCapRat0547_x ) < 1 .AND.
             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap0547Ratio > 0 ))
         then  HtPumpSystem[1]:Cap0547Ratio
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCOP115"      ResHVACSys:cseRSYS:rsCOP115      =        ; SAC 09/22/21
      {  if (IfValidAnd( HtPumpSystem[1]:COP115 > 0 ))
         then  HtPumpSystem[1]:COP115
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCOPMin115"   ResHVACSys:cseRSYS:rsCOPMin115   =  
      {  if (IfValidAnd( HtPumpSystem[1]:COPMin115 > 0 ))
         then  HtPumpSystem[1]:COPMin115
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCOP95"       ResHVACSys:cseRSYS:rsCOP95       =  
      {  if (IfValidAnd( HtPumpSystem[1]:COP95 > 0 ))
         then  HtPumpSystem[1]:COP95
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCOPMin95"    ResHVACSys:cseRSYS:rsCOPMin95    =  
      {  if (IfValidAnd( HtPumpSystem[1]:COPMin95 > 0 ))
         then  HtPumpSystem[1]:COPMin95
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCOP82"       ResHVACSys:cseRSYS:rsCOP82       =  
      {  if (IfValidAnd( HtPumpSystem[1]:COP82 > 0 ))
         then  HtPumpSystem[1]:COP82
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCOPMin82"    ResHVACSys:cseRSYS:rsCOPMin82    =  
      {  if (IfValidAnd( HtPumpSystem[1]:COPMin82 > 0 ))
         then  HtPumpSystem[1]:COPMin82
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCOP05"       ResHVACSys:cseRSYS:rsCOP05       =        ; SAC 07/26/21
      {  if (IfValidAnd( HtPumpSystem[1]:COP05 > 0 ))
         then  HtPumpSystem[1]:COP05
         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsCOPMin47"    ResHVACSys:cseRSYS:rsCOPMin47    =
      {  if (IfValidAnd( HtPumpSystem[1]:COPMin47 > 0 ))
         then  HtPumpSystem[1]:COPMin47
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCOPMin17"    ResHVACSys:cseRSYS:rsCOPMin17    =
      {  if (IfValidAnd( HtPumpSystem[1]:COPMin17 > 0 ))
         then  HtPumpSystem[1]:COPMin17
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsCOPMin05"    ResHVACSys:cseRSYS:rsCOPMin05    =        ; SAC 07/26/21
      {  if (IfValidAnd( HtPumpSystem[1]:COPMin05 > 0 ))
         then  HtPumpSystem[1]:COPMin05
         else  UNDEFINED  endif  }

;   "Set ResHVACSys:cseRSYS:rsLoadFMinH"     ResHVACSys:cseRSYS:rsLoadFMinH     =      ; removed - SAC 07/24/21
;      {  if (IfValidAnd( HtPumpSystem[1]:VCHPTurndnRat > 0 ))
;         then  HtPumpSystem[1]:VCHPTurndnRat
;         else  UNDEFINED  endif  }

   "Set ResHVACSys:cseRSYS:rsLoadFMin115"    ResHVACSys:cseRSYS:rsLoadFMin115   =      ; SAC 09/22/21
      {  if (IfValidAnd( HtPumpSystem[1]:CapMin115 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap115    > 0 ))
         then  (HtPumpSystem[1]:CapMin115 / HtPumpSystem[1]:Cap115)
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsLoadFMin95"     ResHVACSys:cseRSYS:rsLoadFMin95    =  
      {  if (IfValidAnd( HtPumpSystem[1]:CapMin95 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap95    > 0 ))
         then  (HtPumpSystem[1]:CapMin95 / HtPumpSystem[1]:Cap95)
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsLoadFMin82"     ResHVACSys:cseRSYS:rsLoadFMin82    =  
      {  if (IfValidAnd( HtPumpSystem[1]:CapMin82 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap82    > 0 ))
         then  (HtPumpSystem[1]:CapMin82 / HtPumpSystem[1]:Cap82)
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsLoadFMin47"     ResHVACSys:cseRSYS:rsLoadFMin47    =      ; SAC 07/26/21
      {  if (IfValidAnd( HtPumpSystem[1]:CapMin47 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap47    > 0 ))
         then  (HtPumpSystem[1]:CapMin47 / HtPumpSystem[1]:Cap47)
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsLoadFMin17"     ResHVACSys:cseRSYS:rsLoadFMin17    =
      {  if (IfValidAnd( HtPumpSystem[1]:CapMin17 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap17    > 0 ))
         then  (HtPumpSystem[1]:CapMin17 / HtPumpSystem[1]:Cap17)
         else  UNDEFINED  endif  }
   "Set ResHVACSys:cseRSYS:rsLoadFMin05"     ResHVACSys:cseRSYS:rsLoadFMin05    =
      {  if (IfValidAnd( HtPumpSystem[1]:CapMin05 > 0 ) .AND.
             IfValidAnd( HtPumpSystem[1]:Cap05    > 0 ))
         then  (HtPumpSystem[1]:CapMin05 / HtPumpSystem[1]:Cap05)
         else  UNDEFINED  endif  }

   ; removed 0.75 denominator & default to 1.1 - SAC 02/11/22 (VCHP2)
   "Set ResHVACSys:cseRSYS:rsFxCapH"      ResHVACSys:cseRSYS:rsFxCapH      =        ; VCHP2 - SAC 11/10/20  ; default 1.1->1.2 - SAC 02/25/22  ; disable when not autosizing and specify only when EnableResearchMode activated - SAC 03/03/22
      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0) then  UNDEFINED
         else if (IfValidAnd( ResProj:RunAbbrev = "s" ) .OR. Proj:RunAbbrev == "zb" .OR.
                  IfValidAnd( ResProj:RunAbbrev == "smf" ) .OR. IfValidAnd( ResProj:RunAbbrev == "dr" )) 
         then  0.75
         else if (IfValidAnd( Proj:EnableResearchMode > 0.5 ) .AND.
                  IfValidAnd( HtPumpSystem[1]:HtgSizingFactor > 0 ))
         then  HtPumpSystem[1]:HtgSizingFactor
         else  1.2  endif endif endif  }
	"Set ResHVACSys:cseRSYS:rsParElec_x"	ResHVACSys:cseRSYS:rsParElec_x   =        ; VCHP2 - SAC 11/10/20
      {  if (LocalStatus( HtPumpSystem[1]:ParElecExprs ))
         then  HtPumpSystem[1]:ParElecExprs
         else  UNCHANGED  endif  }

   "Set ResHVACSys:cseRSYS:rsDefrostModel"   ResHVACSys:cseRSYS:rsDefrostModel  = {  "REVCYCLE"  }
END

;************************************************************************* - JP 11/03/22 (FPFC)
RULELIST "HVACSys_SetupRSYS_CentralFPFC" 1 0 0 1
;*************************************************************************
; Since for FPFC the reading of rsSrcSideLoadMtr and rsLoadMtr will be the same
; we use one for chill water system and the other for hot water system.
; Heating and cooling loads are logged in both meters, but when export the data
; we only export heating or cooling for each meter.

   "Set ResHVACSys:cseRSYS:rsSrcSideLoadMtr"    ResHVACSys:cseRSYS:rsSrcSideLoadMtr  =
      {  if (LocalStatus( HVACCentralRef[1]:ChWFluidSysRef:CSE_LoadMeter ) > 0)
         then  HVACCentralRef[1]:ChWFluidSysRef:CSE_LoadMeter
         else  UNDEFINED  endif  } 

   "Set ResHVACSys:cseRSYS:rsLoadMtr"    ResHVACSys:cseRSYS:rsLoadMtr  =
      {  if (LocalStatus( HVACCentralRef[1]:HWFluidSysRef:CSE_LoadMeter ) > 0)
         then  HVACCentralRef[1]:HWFluidSysRef:CSE_LoadMeter
         else  UNDEFINED  endif  } 

; ResCentralHtgClgSys   User: "FPFC System"  
;    HWFluidSysRef = RVal: "HWFluidSystem"
;    ChWFluidSysRef = RVal: "ChWFluidSystem"
; 
; FluidSys   User: "HWFluidSystem"  
;    CSE_LoadMeter = RVal: "LdMtr1"
; 
; FluidSys   User: "ChWFluidSystem
;    CSE_LoadMeter = RVal: "LdMtr2"
; 
; LOADMETER   "LdMtr1"
; LOADMETER   "LdMtr2"
;
;RSYS <name>
;   rsType = "FANCOIL"                    // System type
;   rsVfPerTon = 350                     // cfm/ton (default = 350)
;   rsFanPwrH = 0.45                     // Heating fan power, w/cfm
;   rsFanPwrC = 0.45                     // Cooling fan power, w/cfm
;   AUTOSIZE rsCapH                      // or hardsized heating capacity, Btuh
;   AUTOSIZE rsCapC                      // or hardsized cooling capacity, Btuh
;   rsSHRtarget = .75                    // assumed cooling sensible heat ratio
;   // rsParElec = 0                     // Parasitic electric use, W (always 0?)
;   rsElecMtr = "MtrElec"                // Electric use meter
;   rsFuelMtr = "MtrNatGas"              // Natural gas use meter
;   rsLoadMtr = "LdMtr1"                 // Load meter (heat transfer to air accumulated here -- .qHtg and .qClg)
;   rsSrcSideLoadMtr = "LdMtr2"          // Load meter (heat transfer to
         
END

;************************************************************************* - SAC 03/17/22 (WSHP)
RULELIST "HVACSys_SetupRSYS_CentralWSHP" 1 0 0 1
;*************************************************************************

; to be updated...
;   "Set ResHVACSys:cseRSYS:rsSEER"     ResHVACSys:cseRSYS:rsSEER    = {  14   } 
;   "Set ResHVACSys:cseRSYS:rsFxCapH"   ResHVACSys:cseRSYS:rsFxCapH  = {  1.2  } 
;   "Set ResHVACSys:cseRSYS:rsHSPF"     ResHVACSys:cseRSYS:rsHSPF    = {  8.2  } 

   "Set ResHVACSys:cseRSYS:rsTdbOut_x"          ResHVACSys:cseRSYS:rsTdbOut_x  =       ; revised per guidance from DR - SAC 03/24/22
      {  if (IfValidAnd( HVACCentralRef[1]:CWFluidSysRef:FixedSupTemp    > 0 ) .AND.
             IfValidAnd( HVACCentralRef[1]:CWFluidSysRef:HtgFixedSupTemp > 0 ))
         then  Format( "select(@RSYS[%c%s%c].modeLastActive == 2, %g, default %g)", 34, cseRSYS:Name, 34,
                           HVACCentralRef[1]:CWFluidSysRef:FixedSupTemp, HVACCentralRef[1]:CWFluidSysRef:HtgFixedSupTemp )
         else  Format( "select(@RSYS[%c%s%c].modeLastActive == 2, min($tWbOSh + 10, $tdbOSh), default 59)", 34, cseRSYS:Name, 34 )
         endif  } 
   "Set ResHVACSys:cseRSYS:rsSrcSideLoadMtr"    ResHVACSys:cseRSYS:rsSrcSideLoadMtr  =
      {  if (LocalStatus( HVACCentralRef[1]:CWFluidSysRef:CSE_LoadMeter ) > 0)
         then  HVACCentralRef[1]:CWFluidSysRef:CSE_LoadMeter
         else  UNDEFINED  endif  } 

;   rsTdbOut = select(@RSYS["rsys-WSHP HVACSys"].modeLastActive == 2, min($tWbOSh + 10, $tdbOSh), default 59)    // Source side temperature for performance corrections (heat = mode 1, cool = mode 2)
;   rsSrcSideLoadMtr = "MtrWSHPSrc"      // LOADMETER used to generate pland load profiles for condenser/boiler loops

; ResCentralHtgClgSys   User: "WSHP System"  
;    CWFluidSysRef = RVal: "WSHP FluidSys"
; 
; FluidSeg   User: "WSHP Supply"  
;    ParentFluidSysRef = RVal: "WSHP FluidSys"
; 
; FluidSys:
;    CSE_LoadMeter = RVal: "LdMtr1"
; 
; LOADMETER   "LdMtr1"  

;   AUTOSIZE rsCapC
;   AUTOSIZE rsCapAuxH
;   AUTOSIZE rsCap47
;   rsFxCapC = 1.1                       // Cooling sizing factor
;   rsFChg = 0.96                        // Refrigerant charge adjustment factor
;   rsSEER = 14                          // Cooling SEER
;   rsEER = 11.7                         // Cooling EER (required for *PkgRoom types)
;   rsVfPerTon = 350                     // CFM per Ton (default = 350)
;   rsFanPwrH = 0.58                     // Heating fan power.  Heating air flow is estimated based on a 50 ?F temperature rise.
;   rsFanPwrC = 0.58                     // Cooling fan power.
;   rsParElec = ($tdboHrAv < 50) * 40 * 1    // Parasitic electric use, W
;   rsFxCapH = 1.2                       // Heating sizing factor
;   rsHSPF = 8.2                         // ratio of BTU heat output over the heating season to watt-hours of electricity used, ratio
;   rsFxCapAuxH = 1.2                    // Auxiliary (backup) heating sizing factor
;   rsTdbOut = select(@RSYS["rsys-WSHP HVACSys"].modeLastActive == 2, min($tWbOSh + 10, $tdbOSh), default 59)    // Source side temperature for performance corrections (heat = mode 1, cool = mode 2)
;   rsOAVType = "None"                   // OAV system type
;   rsElecMtr = "MtrElec"                // Electric use meter
;   rsFuelMtr = "MtrNatGas"              // Natural gas use meter
;   rsSrcSideLoadMtr = "MtrWSHPSrc"      // LOADMETER used to generate pland load profiles for condenser/boiler loops


	"Set ResHVACSys:cseRSYS:rsCapAuxH"			ResHVACSys:cseRSYS:rsCapAuxH		=     ; SAC 04/05/22 (WSHP)
      {  if (IfValidAnd( HPSysAuxHtgCap > 0 ))
         then  HPSysAuxHtgCap
         else  UNDEFINED  endif  }



;   "Set ResHVACSys:cseRSYS:rsFEffC_x"     ResHVACSys:cseRSYS:rsFEffC_x    = {  UNDEFINED  }   ; "1/FVCHPC"  }
;   "Set ResHVACSys:cseRSYS:rsFanPwrC"     ResHVACSys:cseRSYS:rsFanPwrC    =
;      {  if (IfValidAnd( HtPumpSystem[1]:VCHPFanPwrHC[2] > 0 ))
;         then  HtPumpSystem[1]:VCHPFanPwrHC[2]
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsFanPwrC_x"   ResHVACSys:cseRSYS:rsFanPwrC_x  = {  UNDEFINED  }   ; "0.35*FVCHPC"  }
;
;   "Set ResHVACSys:cseRSYS:rsFEffH_x"     ResHVACSys:cseRSYS:rsFEffH_x    = {  UNDEFINED  }   ; "1"  }     ; don't use VCHP mult for htg - was: 1/FVCHPH - SAC 11/01/20
;   "Set ResHVACSys:cseRSYS:rsFanPwrH"     ResHVACSys:cseRSYS:rsFanPwrH    =
;      {  if (IfValidAnd( HtPumpSystem[1]:VCHPFanPwrHC[1] > 0 ))
;         then  HtPumpSystem[1]:VCHPFanPwrHC[1]
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsFanPwrH_x"   ResHVACSys:cseRSYS:rsFanPwrH_x  = {  UNDEFINED  }   ; "0.35*FVCHPH"  }
;
;   "Blast ResHVACSys:cseRSYS:rsCap17"     ResHVACSys:cseRSYS:rsCap17      = {  UNDEFINED  }     ; removed Cap17 & Cap05 for VCHP2 - SAC 07/26/21
;;   "Blast ResHVACSys:cseRSYS:rsCap05"     ResHVACSys:cseRSYS:rsCap05      = {  UNDEFINED  } 
;
;   "Set ResHVACSys:cseRSYS:rsFxCapAuxH"   ResHVACSys:cseRSYS:rsFxCapAuxH   =   ; SAC 03/03/22 - was: {  1.2  }  ; UNDEFINED  }      ; undef -> 1.2 - SAC 02/25/22
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0) then  UNDEFINED
;         else if (IfValidAnd( Proj:EnableResearchMode > 0.5 ) .AND.
;                  IfValidAnd( HtPumpSystem[1]:HtgAuxSizingFactor > 0 ))
;         then  HtPumpSystem[1]:HtgAuxSizingFactor
;         else  1.2  endif endif  }
;
;	"throw error if ResHVACSys:cseRSYS:rsOAVType != 'None'"		ResHVACSys:Action		=     ; VCHP2 - SAC 11/10/20
;      {	if (IfValidAnd( cseRSYS:rsOAVType > 0 ))
;         then  switch (cseRSYS:rsOAVType)
;                  case  1 :   PostError( "OAV type 'FixedFlow' incompatible with VCHP2 system '%s' (CSE RSYS '%s')", Name, cseRSYS:Name )
;                  case  2 :   PostError( "OAV type 'VarFlow' incompatible with VCHP2 system '%s' (CSE RSYS '%s')", Name, cseRSYS:Name )
;                  default :  UNCHANGED
;               endswitch
;         else  UNCHANGED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCap17"       ResHVACSys:cseRSYS:rsCap17  =             ; SAC 09/23/21
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap17 > 0 ))
;         then  HtPumpSystem[1]:Cap17
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat1747_x" ResHVACSys:cseRSYS:rsCapRat1747_x  =     ; SAC 02/11/22
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap17 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap47  > 0 ))
;         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap17, HtPumpSystem[1]:Cap47 )
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat1747"  ResHVACSys:cseRSYS:rsCapRat1747  =        ; mod to output even when autosizing - SAC 07/26/21
;      {  if (LocalStatus( cseRSYS:rsCapRat1747_x ) < 1 .AND.
;             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap1747Ratio > 0 ))
;         then  HtPumpSystem[1]:Cap1747Ratio
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCap115"      ResHVACSys:cseRSYS:rsCap115  =            ; SAC 09/22/21
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap115 > 0 ))
;         then  HtPumpSystem[1]:Cap115
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat11595_x" ResHVACSys:cseRSYS:rsCapRat11595_x  =   ; SAC 02/11/22
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap115 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap95  > 0 ))
;         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap115, HtPumpSystem[1]:Cap95 )
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat11595" ResHVACSys:cseRSYS:rsCapRat11595  =       ; SAC 09/22/21
;      {  if (LocalStatus( cseRSYS:rsCapRat11595_x ) < 1 .AND.
;             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap11595Ratio > 0 ))
;         then  HtPumpSystem[1]:Cap11595Ratio
;         else  UNDEFINED  endif  }
;
;;   "Set ResHVACSys:cseRSYS:rsCap95"       ResHVACSys:cseRSYS:rsCap95  =             ; SAC 09/22/21
;   "Set ResHVACSys:cseRSYS:rsCapC"        ResHVACSys:cseRSYS:rsCapC  =              ; SAC 09/23/21
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap95 > 0 ))
;         then  HtPumpSystem[1]:Cap95
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat9547_x" ResHVACSys:cseRSYS:rsCapRat9547_x  =     ; SAC 02/11/22
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap95 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap47  > 0 ))
;         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap95, HtPumpSystem[1]:Cap47 )
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat9547"  ResHVACSys:cseRSYS:rsCapRat9547  =        ; SAC 01/08/22
;      {  if (LocalStatus( cseRSYS:rsCapRat9547_x ) < 1 .AND.
;             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap95 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap47 > 0 ))
;         then  HtPumpSystem[1]:Cap95 / HtPumpSystem[1]:Cap47
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCap82"       ResHVACSys:cseRSYS:rsCap82  =             ; SAC 09/22/21
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap82 > 0 ))
;         then  HtPumpSystem[1]:Cap82
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat8295_x" ResHVACSys:cseRSYS:rsCapRat8295_x  =     ; SAC 02/11/22
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap82 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap95  > 0 ))
;         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap82, HtPumpSystem[1]:Cap95 )
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat8295"  ResHVACSys:cseRSYS:rsCapRat8295  =        ; SAC 09/22/21
;      {  if (LocalStatus( cseRSYS:rsCapRat8295_x ) < 1 .AND.
;             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap8295Ratio > 0 ))
;         then  HtPumpSystem[1]:Cap8295Ratio
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCap05"       ResHVACSys:cseRSYS:rsCap05  =             ; SAC 09/22/21
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0 .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap05 > 0 ))
;         then  HtPumpSystem[1]:Cap05
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat0547_x" ResHVACSys:cseRSYS:rsCapRat0547_x  =     ; SAC 02/11/22
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap05 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap47  > 0 ))
;         then  Format( "%.1f/%.1f", HtPumpSystem[1]:Cap05, HtPumpSystem[1]:Cap47 )
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCapRat0547"  ResHVACSys:cseRSYS:rsCapRat0547  =        ; SAC 07/26/21   ; mod to only output when autosizing - SAC 09/22/21
;      {  if (LocalStatus( cseRSYS:rsCapRat0547_x ) < 1 .AND.
;             IfValidAnd( HtPumpSystem[1]:AutoSize > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap0547Ratio > 0 ))
;         then  HtPumpSystem[1]:Cap0547Ratio
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCOP115"      ResHVACSys:cseRSYS:rsCOP115      =        ; SAC 09/22/21
;      {  if (IfValidAnd( HtPumpSystem[1]:COP115 > 0 ))
;         then  HtPumpSystem[1]:COP115
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCOPMin115"   ResHVACSys:cseRSYS:rsCOPMin115   =  
;      {  if (IfValidAnd( HtPumpSystem[1]:COPMin115 > 0 ))
;         then  HtPumpSystem[1]:COPMin115
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCOP95"       ResHVACSys:cseRSYS:rsCOP95       =  
;      {  if (IfValidAnd( HtPumpSystem[1]:COP95 > 0 ))
;         then  HtPumpSystem[1]:COP95
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCOPMin95"    ResHVACSys:cseRSYS:rsCOPMin95    =  
;      {  if (IfValidAnd( HtPumpSystem[1]:COPMin95 > 0 ))
;         then  HtPumpSystem[1]:COPMin95
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCOP82"       ResHVACSys:cseRSYS:rsCOP82       =  
;      {  if (IfValidAnd( HtPumpSystem[1]:COP82 > 0 ))
;         then  HtPumpSystem[1]:COP82
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCOPMin82"    ResHVACSys:cseRSYS:rsCOPMin82    =  
;      {  if (IfValidAnd( HtPumpSystem[1]:COPMin82 > 0 ))
;         then  HtPumpSystem[1]:COPMin82
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCOP05"       ResHVACSys:cseRSYS:rsCOP05       =        ; SAC 07/26/21
;      {  if (IfValidAnd( HtPumpSystem[1]:COP05 > 0 ))
;         then  HtPumpSystem[1]:COP05
;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsCOPMin47"    ResHVACSys:cseRSYS:rsCOPMin47    =
;      {  if (IfValidAnd( HtPumpSystem[1]:COPMin47 > 0 ))
;         then  HtPumpSystem[1]:COPMin47
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCOPMin17"    ResHVACSys:cseRSYS:rsCOPMin17    =
;      {  if (IfValidAnd( HtPumpSystem[1]:COPMin17 > 0 ))
;         then  HtPumpSystem[1]:COPMin17
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsCOPMin05"    ResHVACSys:cseRSYS:rsCOPMin05    =        ; SAC 07/26/21
;      {  if (IfValidAnd( HtPumpSystem[1]:COPMin05 > 0 ))
;         then  HtPumpSystem[1]:COPMin05
;         else  UNDEFINED  endif  }
;
;;   "Set ResHVACSys:cseRSYS:rsLoadFMinH"     ResHVACSys:cseRSYS:rsLoadFMinH     =      ; removed - SAC 07/24/21
;;      {  if (IfValidAnd( HtPumpSystem[1]:VCHPTurndnRat > 0 ))
;;         then  HtPumpSystem[1]:VCHPTurndnRat
;;         else  UNDEFINED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsLoadFMin115"    ResHVACSys:cseRSYS:rsLoadFMin115   =      ; SAC 09/22/21
;      {  if (IfValidAnd( HtPumpSystem[1]:CapMin115 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap115    > 0 ))
;         then  (HtPumpSystem[1]:CapMin115 / HtPumpSystem[1]:Cap115)
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsLoadFMin95"     ResHVACSys:cseRSYS:rsLoadFMin95    =  
;      {  if (IfValidAnd( HtPumpSystem[1]:CapMin95 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap95    > 0 ))
;         then  (HtPumpSystem[1]:CapMin95 / HtPumpSystem[1]:Cap95)
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsLoadFMin82"     ResHVACSys:cseRSYS:rsLoadFMin82    =  
;      {  if (IfValidAnd( HtPumpSystem[1]:CapMin82 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap82    > 0 ))
;         then  (HtPumpSystem[1]:CapMin82 / HtPumpSystem[1]:Cap82)
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsLoadFMin47"     ResHVACSys:cseRSYS:rsLoadFMin47    =      ; SAC 07/26/21
;      {  if (IfValidAnd( HtPumpSystem[1]:CapMin47 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap47    > 0 ))
;         then  (HtPumpSystem[1]:CapMin47 / HtPumpSystem[1]:Cap47)
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsLoadFMin17"     ResHVACSys:cseRSYS:rsLoadFMin17    =
;      {  if (IfValidAnd( HtPumpSystem[1]:CapMin17 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap17    > 0 ))
;         then  (HtPumpSystem[1]:CapMin17 / HtPumpSystem[1]:Cap17)
;         else  UNDEFINED  endif  }
;   "Set ResHVACSys:cseRSYS:rsLoadFMin05"     ResHVACSys:cseRSYS:rsLoadFMin05    =
;      {  if (IfValidAnd( HtPumpSystem[1]:CapMin05 > 0 ) .AND.
;             IfValidAnd( HtPumpSystem[1]:Cap05    > 0 ))
;         then  (HtPumpSystem[1]:CapMin05 / HtPumpSystem[1]:Cap05)
;         else  UNDEFINED  endif  }
;
;   ; removed 0.75 denominator & default to 1.1 - SAC 02/11/22 (VCHP2)
;   "Set ResHVACSys:cseRSYS:rsFxCapH"      ResHVACSys:cseRSYS:rsFxCapH      =        ; VCHP2 - SAC 11/10/20  ; default 1.1->1.2 - SAC 02/25/22  ; disable when not autosizing and specify only when EnableResearchMode activated - SAC 03/03/22
;      {  if (IfValidAnd( HtPumpSystem[1]:AutoSize > 0 )==0) then  UNDEFINED
;         else if (IfValidAnd( ResProj:RunAbbrev = "s" ) .OR. Proj:RunAbbrev == "zb" .OR.
;                  IfValidAnd( ResProj:RunAbbrev == "smf" ) .OR. IfValidAnd( ResProj:RunAbbrev == "dr" )) 
;         then  0.75
;         else if (IfValidAnd( Proj:EnableResearchMode > 0.5 ) .AND.
;                  IfValidAnd( HtPumpSystem[1]:HtgSizingFactor > 0 ))
;         then  HtPumpSystem[1]:HtgSizingFactor
;         else  1.2  endif endif endif  }
;	"Set ResHVACSys:cseRSYS:rsParElec_x"	ResHVACSys:cseRSYS:rsParElec_x   =        ; VCHP2 - SAC 11/10/20
;      {  if (LocalStatus( HtPumpSystem[1]:ParElecExprs ))
;         then  HtPumpSystem[1]:ParElecExprs
;         else  UNCHANGED  endif  }
;
;   "Set ResHVACSys:cseRSYS:rsDefrostModel"   ResHVACSys:cseRSYS:rsDefrostModel  = {  "REVCYCLE"  }


END
;*************************************************************************

;************************************************************************* - JP 04/28/22 
RULELIST "HVACSys_SetupRSYS_CentralVRF" 1 0 0 1
;*************************************************************************

	"throw error if ResHVACSys:cseRSYS:rsOAVType != 'None'"		ResHVACSys:Action		=
      {	if (IfValidAnd( cseRSYS:rsOAVType > 0 ))
         then  switch (cseRSYS:rsOAVType)
                  case  1 :   PostError( "OAV type 'FixedFlow' incompatible with VCHP2 system '%s' (CSE RSYS '%s')", Name, cseRSYS:Name )
                  case  2 :   PostError( "OAV type 'VarFlow' incompatible with VCHP2 system '%s' (CSE RSYS '%s')", Name, cseRSYS:Name )
                  default :  UNCHANGED
               endswitch
         else  UNCHANGED  endif  }

   "Set ResHVACSys:cseRSYS:rsHSPF"       ResHVACSys:cseRSYS:rsHSPF  = { 8.2 } ; code minimum for split 1 phase heat pump ( not used in simulation )

   "Set ResHVACSys:cseRSYS:rsSEER"       ResHVACSys:cseRSYS:rsSEER  = { 16 } ; code minimum for split 1 phase heat pump ( not used in simulation )

   "Set ResHVACSys:cseRSYS:rsCapC"      ResHVACSys:cseRSYS:rsCapC  = { if( AutoSizeCool[1] < 1 ) then CentralSysClgCap else UNDEFINED endif }

   "Set ResHVACSys:cseRSYS:rsCap47"      ResHVACSys:cseRSYS:rsCap47  = { if( HtPumpCap47AutoSz < 1 ) then CentralSysHtgCap else UNDEFINED endif }    ; SAC 07/22/22

   "Set ResHVACSys:cseRSYS:rsCapRat11595"     ResHVACSys:cseRSYS:rsCapRat11595  = { VRFMaxClgCapRat11595 }
   
   "Set ResHVACSys:cseRSYS:rsCapRat8295"      ResHVACSys:cseRSYS:rsCapRat8295  = { VRFMaxClgCapRat8295 }
   
   "Set ResHVACSys:cseRSYS:rsCapRat1747"      ResHVACSys:cseRSYS:rsCapRat1747  = { VRFMaxHtgCapRat1747 }
   
   "Set ResHVACSys:cseRSYS:rsCapRat0547"      ResHVACSys:cseRSYS:rsCapRat0547  = { VRFMaxHtgCapRat0547 }

   "Set ResHVACSys:cseRSYS:rsCOP115"      ResHVACSys:cseRSYS:rsCOP115 = { VRFMaxClgCOP115 }
   
   "Set ResHVACSys:cseRSYS:rsCOP95"      ResHVACSys:cseRSYS:rsCOP95 = { VRFMaxClgCOP95 }
   
   "Set ResHVACSys:cseRSYS:rsCOP82"      ResHVACSys:cseRSYS:rsCOP82 = { VRFMaxClgCOP82 }
   
   "Set ResHVACSys:cseRSYS:rsCOP47"      ResHVACSys:cseRSYS:rsCOP47 = { VRFMaxHtgCOP47 }
   
   "Set ResHVACSys:cseRSYS:rsCOP17"      ResHVACSys:cseRSYS:rsCOP17 = { VRFMaxHtgCOP17 }
   
   "Set ResHVACSys:cseRSYS:rsCOP05"      ResHVACSys:cseRSYS:rsCOP05 = { VRFMaxHtgCOP05 }

   "Set ResHVACSys:cseRSYS:rsCOPMin115"      ResHVACSys:cseRSYS:rsCOPMin115 = { VRFMinClgCOP115 }
   
   "Set ResHVACSys:cseRSYS:rsCOPMin95"      ResHVACSys:cseRSYS:rsCOPMin95 = { VRFMinClgCOP95 }
   
   "Set ResHVACSys:cseRSYS:rsCOPMin82"      ResHVACSys:cseRSYS:rsCOPMin82 = { VRFMinClgCOP82 }
   
   "Set ResHVACSys:cseRSYS:rsCOPMin47"      ResHVACSys:cseRSYS:rsCOPMin47 = { VRFMinHtgCOP47 }
   
   "Set ResHVACSys:cseRSYS:rsCOPMin17"      ResHVACSys:cseRSYS:rsCOPMin17 = { VRFMinHtgCOP17 }
   
   "Set ResHVACSys:cseRSYS:rsCOPMin05"      ResHVACSys:cseRSYS:rsCOPMin05 = { VRFMinHtgCOP05 }

   "Set ResHVACSys:cseRSYS:rsLoadFMin115"    ResHVACSys:cseRSYS:rsLoadFMin115 = { VRFClgPLRMin }

   "Set ResHVACSys:cseRSYS:rsLoadFMin95"     ResHVACSys:cseRSYS:rsLoadFMin95 = { VRFClgPLRMin }

   "Set ResHVACSys:cseRSYS:rsLoadFMin82"     ResHVACSys:cseRSYS:rsLoadFMin82 = { VRFClgPLRMin }

   "Set ResHVACSys:cseRSYS:rsLoadFMin47"     ResHVACSys:cseRSYS:rsLoadFMin47 = { VRFHtgPLRMin }

   "Set ResHVACSys:cseRSYS:rsLoadFMin17"     ResHVACSys:cseRSYS:rsLoadFMin17 = { VRFHtgPLRMin }

   "Set ResHVACSys:cseRSYS:rsLoadFMin05"     ResHVACSys:cseRSYS:rsLoadFMin05 = { VRFHtgPLRMin }

   "Set ResHVACSys:cseRSYS:rsDefrostModel"   ResHVACSys:cseRSYS:rsDefrostModel  = {  "REVCYCLE"  }
   
   "Set ResHVACSys:cseRSYS:rsCdH"   ResHVACSys:cseRSYS:rsCdH  = {  0.35  }
      
   "Set ResHVACSys:cseRSYS:rsCdC"   ResHVACSys:cseRSYS:rsCdC  = {  0.50  }
   
END

;*************************************************************************
RULELIST "DOAS_CSE_Defaulting" 1 0 0 1
;*************************************************************************
// ---------- Fan Power ----------
  "Create a cseDOAS for each ResCentralVentSys"  ResCentralVentSys:cseDOAS = {
    CreateComp( cseDOAS, "doas-" + substr( Name, 0, 48 ) ) }
    
  "Set ResCentralVentSys:cseDOAS:oaSupFanElecPwr" ResCentralVentSys:cseDOAS:oaSupFanElecPwr = {
    if( SupFanCap > 0 ) then SupFanPwrIdx else UNDEFINED endif }
    
  "Set ResCentralVentSys:cseDOAS:oaSupFanMtr" ResCentralVentSys:cseDOAS:oaSupFanMtr = {
    if( SupFanCap > 0 ) then Global( Proj:CSE_ElecMETER ) else UNDEFINED endif }

  "Set ResCentralVentSys:cseDOAS:oaSupFanEndUse" ResCentralVentSys:cseDOAS:oaSupFanEndUse = {
    if( SupFanCap > 0 ) then "FANV" else UNDEFINED endif }    
    
  "Set ResCentralVentSys:cseDOAS:oaExhFanElecPwr" ResCentralVentSys:cseDOAS:oaExhFanElecPwr = {
    if( ExhFanCap > 0 ) then ExhFanPwrIdx else UNDEFINED endif }
    
  "Set ResCentralVentSys:cseDOAS:oaExhFanMtr" ResCentralVentSys:cseDOAS:oaExhFanMtr = {
    if( ExhFanCap > 0 ) then Global( Proj:CSE_ElecMETER ) else UNDEFINED endif }

  "Set ResCentralVentSys:cseDOAS:oaExhFanEndUse" ResCentralVentSys:cseDOAS:oaExhFanEndUse = {
    if( ExhFanCap > 0 ) then "FANV" else UNDEFINED endif }    

// ----------- Heat Recovery ----------
  "Set ResCentralVentSys:cseDOAS:oaHXVfDs" ResCentralVentSys:cseDOAS:oaHXVfDs = {
    if( HXType > 0 ) then HtRcvrySupFlowRtd else UNDEFINED endif }

  "Set ResCentralVentSys:cseDOAS:oaHXf2" ResCentralVentSys:cseDOAS:oaHXf2 = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then 0.75 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXSenEffHDs" ResCentralVentSys:cseDOAS:oaHXSenEffHDs = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then HtgSensEff100 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXSenEffHf2" ResCentralVentSys:cseDOAS:oaHXSenEffHf2 = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then HtgSensEff75 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXLatEffHDs" ResCentralVentSys:cseDOAS:oaHXLatEffHDs = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then HtgLatEff100 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXLatEffHf2" ResCentralVentSys:cseDOAS:oaHXLatEffHf2 = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then HtgLatEff75 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXSenEffCDs" ResCentralVentSys:cseDOAS:oaHXSenEffCDs = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then ClgSensEff100 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXSenEffCf2" ResCentralVentSys:cseDOAS:oaHXSenEffCf2 = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then ClgSensEff75 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXLatEffCDs" ResCentralVentSys:cseDOAS:oaHXLatEffCDs = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then ClgLatEff100 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXLatEffCf2" ResCentralVentSys:cseDOAS:oaHXLatEffCf2 = {
    if( HXType > 0 .AND. HtRcvryCertification = 1 ) then ClgLatEff75 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXBypass" ResCentralVentSys:cseDOAS:oaHXBypass = {
    if( HXType > 0 ) 
    then if( HasHXBypass = 1 ) then 1 else 2 endif
    else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXAuxPwr" ResCentralVentSys:cseDOAS:oaHXAuxPwr = {
    if( HXType > 0 ) then AuxPwr else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaHXAuxMtr" ResCentralVentSys:cseDOAS:oaHXAuxMtr = {
    if( HXType > 0 ) then Global( Proj:CSE_ElecMETER ) else UNDEFINED endif }

// ----------- Tempering ----------
  "Set ResCentralVentSys:cseDOAS:oaSupTC_x" ResCentralVentSys:cseDOAS:oaSupTC_x = {
    if( TempCtrl = 2 ) ; Fixed
    then Format( "%.1f", ClgFixedSupTemp + 0.5 )
    else if( TempCtrl = 8 ) ; FixedDualSetpoint
    then Format( "%.1f", ClgFixedSupTemp )
    else if( TempCtrl = 4 ) ; %.1f OutsideAirReset
    then Format( "select( $tDbO < %.1f, %.1f, $tDbO > %.1f, %.1f, default %.1f + ( $tDbO - %.1f ) * ( %.1f - %.1f ) / ( %.1f - %.1f ) ) + 0.5",
                 ClRstOutdrHi, ClRstSupHi, ClRstOutdrLow, ClRstSupLow, ClRstSupHi, ClRstOutdrHi,
                 ClRstSupLow, ClRstSupHi, ClRstOutdrLow, ClRstOutdrHi )
    else UNDEFINED
    endif endif endif }
    
  "Set ResCentralVentSys:cseDOAS:oaEIRC" ResCentralVentSys:cseDOAS:oaEIRC = {
    if( TempCtrl != 1 .AND. CoilClgType = 2 ) 
    then 1 / ( EER / 3.412 ) ; DirectExpansion
    else UNDEFINED ; ChilledWater
    endif }
    
  "Set ResCentralVentSys:cseDOAS:oaSHRtarget" ResCentralVentSys:cseDOAS:oaSHRtarget = {
    if( TempCtrl != 1 .AND. CoilClgType = 2 ) then 0.80 else UNDEFINED endif }
  
  "Set ResCentralVentSys:cseDOAS:oaCoilCMtr" ResCentralVentSys:cseDOAS:oaCoilCMtr = {
    if( TempCtrl != 1 .AND. CoilClgType = 2 ) then Global( Proj:CSE_ElecMETER ) else UNDEFINED endif }

  "Set ResCentralVentSys:cseDOAS:oaSupTH_x" ResCentralVentSys:cseDOAS:oaSupTH_x = {
    if( TempCtrl = 2 ) ; Fixed
    then Format( "%.1f", ClgFixedSupTemp - 0.5 )
    else if( TempCtrl = 8 ) ; FixedDualSetpoint
    then Format( "%.1f", HtgFixedSupTemp )
    else if( TempCtrl = 4 ) ; %.1f OutsideAirReset
    then Format( "select( $tDbO < %.1f, %.1f, $tDbO > %.1f, %.1f, default %.1f + ( $tDbO - %.1f ) * ( %.1f - %.1f ) / ( %.1f - %.1f ) ) - 0.5",
                 ClRstOutdrHi, ClRstSupHi, ClRstOutdrLow, ClRstSupLow, ClRstSupHi, ClRstOutdrHi,
                 ClRstSupLow, ClRstSupHi, ClRstOutdrLow, ClRstOutdrHi )
    else UNDEFINED
    endif endif endif }
  
  "Set ResCentralVentSys:cseDOAS:oaEIRH" ResCentralVentSys:cseDOAS:oaEIRH = {
    if( TempCtrl = 1 )
    then UNDEFINED
    else if( CoilHtgType = 1 ) ; Resistance
    then 1
    else if( CoilHtgType = 2 ) ; Furnace
    then 1 / ( ( 0.0051427 * ( FurnAFUE * 100 ) ) + 0.3989 )
    else if( CoilHtgType = 3 )  ; HeatPump
    then 1 / COP47
    else UNDEFINED ; HotWater
    endif endif endif endif }
  
  "Set ResCentralVentSys:cseDOAS:oaCoilHMtr" ResCentralVentSys:cseDOAS:oaCoilHMtr = {
    if( TempCtrl = 1 )
    then UNDEFINED
    else if( CoilHtgType = 1 .OR. CoilHtgType = 3 ) ; Resistance or HeatPump
    then Global( Proj:CSE_ElecMETER )
    else if( CoilHtgType = 2 ) ; Furnace
    then Global( Proj:CSE_NatGasMETER )
    else UNDEFINED
    endif endif endif }

END

;*************************************************************************
RULELIST "ForceDefault_CSE_AirNet_ELA" 1 0 0 1
;*************************************************************************
; "debug"		ResProj:Action	= {	if (LocalStatus( RunNumber ) < 1) then  MessageBox( "Force-default CSE_AirNet_ELA:  RunNumber undefined" )
; 										else  MessageBox( "Force-default CSE_AirNet_ELA:  RunNumber = %.0f", RunNumber )  endif  }
	"Blast ResProj:EffLeakageArea"		ResProj:EffLeakageArea			= {	UNDEFINED  }
	"Blast ResProj:SlabRatio"				ResProj:SlabRatio					= {	UNDEFINED  }
	"Blast ResProj:UncondZnTotSF"			ResProj:UncondZnTotSF			= {	UNDEFINED  }
   "Blast ResProj:BldgELA_CeilSF"		ResProj:BldgELA_CeilSF			= {   UNDEFINED  }
   "Blast ResProj:BldgELA_RaisedFlrSF"	ResProj:BldgELA_RaisedFlrSF	= {   UNDEFINED  }
   "Blast ResProj:BldgELA_GarageSF"		ResProj:BldgELA_GarageSF		= {   UNDEFINED  }
   "Blast ResProj:BldgELA_WallSF"		ResProj:BldgELA_WallSF			= {   UNDEFINED  }
END
;*************************************************************************
RULELIST "Default_CSE_AirNet_ELA" 0 0 0 1
;*************************************************************************
; SAC 2/2/15 - moved here from following rulelist (SimPrep_CSE_AirNet) to facilitate review and mods in BypassRuleLimits scenarios (analysis R&D)
; SAC 7/11/20 - modified to better handle MFam zonal leakage
	"Set ResProj:EffLeakageArea"		ResProj:EffLeakageArea		= {	Local( CondFloorAreaWithMult ) * Local( ACH50 ) / (2 * 10000)  }    ; SAC 9/7/12 - restore original formula per write-up v7 // SAC 8/31/12 - revise formula per update in airnet write-up (rev 5->6)  ; revised to ..WithMult - SAC 04/28/23 (tic #3392)
	"Set ResProj:SlabRatio"				ResProj:SlabRatio				= {	if (BldgSlabFloorArea < 0.0001 .AND. BldgExtFloorArea < 0.0001 .AND.
	                                                                BldgOZSlabFloorArea < 0.0001 .AND. BldgOZExtFloorArea < 0.0001) then  0
																					else  (BldgSlabFloorArea + BldgOZSlabFloorArea) /
																					      (BldgSlabFloorArea + BldgExtFloorArea + BldgOZSlabFloorArea + BldgOZExtFloorArea)  endif  }
	"Set ResProj:UncondZnTotSF"		ResProj:UncondZnTotSF		= {  BldgZnAdjUZnArea + BldgOZAdjUZnArea  }        ; OtherZone garage mods - SAC 11/30/20
      ;{	if (HasGarage < 0.1 .AND. SumAcrossIf( ResOtherZn:Area, ResOtherZn:Isgarage > 0 ) < 0.1) then  0
      ;   else  SumAll( ResZn:AdjUncondZnArea ) + SumAll( ResOtherZn:AdjUncondZnArea )  endif  }
		;																			else  SumAll( ResIntWall:ParUZnAdjCndZnArea ) + SumAll( ResIntFlr:ParCndZnAdjUZnArea ) +
		;																					SumAll( ResIntWall:ParCndZnAdjUZnArea ) + SumAll( ResIntCeiling:ParUZnAdjCndZnArea )  endif  }

;   "Set ResProj:NResLeakageRatio - ratio of NRes surface leakage (per ft2) / Res surface leakage"     ResProj:NResLeakageRatio =    ; SAC 7/12/20

   ; SAC 7/12/20 - revised following rules for new Zonal vent control mechanism
   "Set ResProj:BldgELA_CeilSF"        ResProj:BldgELA_CeilSF       =      ; fix divide by zero issue that can arise in Com - SAC 10/21/21 (MFam)
      {  if ((  BldgClgBlwAtticArea +   BldgCathCeilingArea +   BldgExtFloorArea + BldgZnAdjUZnArea +   BldgExtWallArea +
              BldgOZClgBlwAtticArea + BldgOZCathCeilingArea + BldgOZExtFloorArea + BldgOZAdjUZnArea + BldgOZExtWallArea) < 0.1) then  0
         else if (CSEVentAvailZonal)
         then  EffLeakageArea / (BldgClgBlwAtticArea + BldgCathCeilingArea + BldgExtFloorArea + BldgZnAdjUZnArea + BldgExtWallArea +
                                 (NResLeakageRatio * (BldgOZClgBlwAtticArea + BldgOZCathCeilingArea + BldgOZExtFloorArea + BldgOZAdjUZnArea + BldgOZExtWallArea)))
         else if (BldgClgBlwAtticArea < 0.0001 .AND. BldgCathCeilingArea < 0.0001 .AND.
                  BldgOZClgBlwAtticArea < 0.0001 .AND. BldgOZCathCeilingArea < 0.0001) then  0
         else  EffLeakageArea * (0.4 + (0.1 * SlabRatio)) /
               (BldgClgBlwAtticArea + BldgCathCeilingArea + BldgOZClgBlwAtticArea + BldgOZCathCeilingArea)
         endif endif endif  }
   "Set ResProj:BldgELA_RaisedFlrSF"   ResProj:BldgELA_RaisedFlrSF  =
      {  if (CSEVentAvailZonal) then  BldgELA_CeilSF
         else if (BldgExtFloorArea < 0.0001 .AND. BldgOZExtFloorArea < 0.0001) then  0
         else  EffLeakageArea * (0.2 * (  1 - SlabRatio)) / (BldgExtFloorArea + BldgOZExtFloorArea)
         endif endif  }
   "Set ResProj:BldgELA_GarageSF"      ResProj:BldgELA_GarageSF     =
      {  if (CSEVentAvailZonal) then  BldgELA_CeilSF
         else if (UncondZnTotSF < 0.0001) then  0
         else  EffLeakageArea * 0.1 / UncondZnTotSF
         endif endif  }
   "Set ResProj:BldgELA_WallSF"        ResProj:BldgELA_WallSF       =
      {  if (CSEVentAvailZonal) then  BldgELA_CeilSF
         else if (BldgExtWallArea < 0.0001 .AND. BldgOZExtWallArea < 0.0001) then  0
         else if (UncondZnTotSF < 0.0001)
         then  EffLeakageArea * (0.4 + (0.1 * SlabRatio)) / (BldgExtWallArea + BldgOZExtWallArea)
         else  EffLeakageArea * (0.3 + (0.1 * SlabRatio)) / (BldgExtWallArea + BldgOZExtWallArea)
         endif endif endif  }
   ; added for screen display
   "Set ResProj:BldgELA_Total"      ResProj:BldgELA_Total   =
      {  (BldgELA_CeilSF      * (BldgClgBlwAtticArea + BldgCathCeilingArea +
                                                    (ValidOr( NResLeakageRatio, 0 ) * (BldgOZClgBlwAtticArea + BldgOZCathCeilingArea)))) +
         (BldgELA_RaisedFlrSF * (BldgExtFloorArea + (ValidOr( NResLeakageRatio, 0 ) *  BldgOZExtFloorArea ))) +
         (BldgELA_GarageSF    * (BldgZnAdjUZnArea + (ValidOr( NResLeakageRatio, 0 ) *  BldgOZAdjUZnArea   )))     +
         (BldgELA_WallSF      * (BldgExtWallArea  + (ValidOr( NResLeakageRatio, 0 ) *  BldgOZExtWallArea  )))  }
   "Set ResProj:BldgELA_Msg[1]"     ResProj:BldgELA_Msg[1]  = {   if (CSEVentAvailZonal) then  Format( "Zn: %.1f ft2 | OZ: %.1f ft2", (BldgClgBlwAtticArea + BldgCathCeilingArea), (BldgOZClgBlwAtticArea + BldgOZCathCeilingArea) )
                                                            else  Format( "x  %.1f ft2", (BldgClgBlwAtticArea + BldgCathCeilingArea + BldgOZClgBlwAtticArea + BldgOZCathCeilingArea) )  endif  }
   "Set ResProj:BldgELA_Msg[2]"     ResProj:BldgELA_Msg[2]  = {   if (CSEVentAvailZonal) then  Format( "Zn: %.1f ft2 | OZ: %.1f ft2", BldgExtFloorArea, BldgOZExtFloorArea )
                                                            else  Format( "x  %.1f ft2", (BldgExtFloorArea + BldgOZExtFloorArea) )  endif  }
   "Set ResProj:BldgELA_Msg[3]"     ResProj:BldgELA_Msg[3]  = {   if (CSEVentAvailZonal) then  Format( "Zn: %.1f ft2 | OZ: %.1f ft2", BldgZnAdjUZnArea, BldgOZAdjUZnArea )
                                                            else  Format( "x  %.1f ft2",  UncondZnTotSF    )  endif  }
   "Set ResProj:BldgELA_Msg[4]"     ResProj:BldgELA_Msg[4]  = {   if (CSEVentAvailZonal) then  Format( "Zn: %.1f ft2 | OZ: %.1f ft2", BldgExtWallArea, BldgOZExtWallArea )
                                                            else  Format( "x  %.1f ft2", (BldgExtWallArea + BldgOZExtWallArea)   )  endif  }
   "Set ResProj:BldgELA_Msg[5]"     ResProj:BldgELA_Msg[5]  = {   if (CSEVentAvailZonal) then  Format( "Total Lkg Area Calc Check:  %.3f ft2 =? %.3f ft2", BldgELA_Total, EffLeakageArea )
                                                            else  Format( "Total above = %.3f ft2  (vs. total lkg area of %.3f)", BldgELA_Total, EffLeakageArea )  endif  }      ; updated message removing 'ELA' - SAC 09/24/20
END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet" 0 0 0 1
;*************************************************************************

;;	"Set ResProj:BldgExtWallArea"			ResProj:BldgExtWallArea			= {	SumAll( ResZn:ExtWallArea     )  }
;;	"Set ResProj:BldgClgBlwAtticArea"	ResProj:BldgClgBlwAtticArea	= {	SumAll( ResZn:ClgBlwAtticArea )  }
;;	"Set ResProj:BldgCathCeilingArea"	ResProj:BldgCathCeilingArea	= {	SumAll( ResZn:CathCeilingArea )  }
;;	"Set ResProj:BldgSlabFloorArea"		ResProj:BldgSlabFloorArea		= {	SumAll( ResZn:SlabFloorArea   )  }
;;	"Set ResProj:BldgExtFloorArea"		ResProj:BldgExtFloorArea		= {	SumAll( ResZn:ExtFloorArea    )  }
;;
;;	"Set ResProj:CondFloorArea"			ResProj:CondFloorArea			= {	SumAll( ResZn:CondFloorArea   )  }

; SAC 2/9/15 - rules to force re-default of (possibly user-defined) AirNet properties
; "debug"		ResProj:Action	= {	if (LocalStatus( RunNumber ) < 1) then  MessageBox( "SimPrep_CSE_AirNet:  RunNumber undefined" )
; 										else  MessageBox( "SimPrep_CSE_AirNet:  RunNumber = %.0f", RunNumber )  endif  }
; SAC 8/4/17 - replaced if statement logic dependent on RunNumber - was:							(	(AllOrientations < 0.5 .AND. RunNumber < 2) .OR.
;																																(AllOrientations > 0.5 .AND. RunNumber < 5) ) ) then  UNCHANGED
   ; modified to prevent ForceDefault_CSE_AirNet_ELA when EnableResearchMode activated - SAC 12/02/20
	"force-default of (possibly user-defined) AirNet properties"		ResProj:Action	= {	if ((BypassRuleLimits > 0.5 .OR. Proj:EnableResearchMode > 0.5) .AND. 
	                                                                                          RunAbbrev != "s" .AND. RunAbbrev != "zb" .AND. RunAbbrev != "zb" .AND. ResProj:RunAbbrev != "smf" .AND. RunAbbrev != "dr") then  UNCHANGED
																													else	EvalRulelist( "ForceDefault_CSE_AirNet_ELA" )  endif  }
; SAC 2/2/15 - moved various AirNet ELA setting rules from this rulelist to 'Default_CSE_AirNet_ELA' in order to facilitate review and mods in BypassRuleLimits scenarios (analysis R&D)
	"Default various AirNet ELA settings"	ResProj:Action		= {	EvalRulelist( "Default_CSE_AirNet_ELA" )  }
;	"Set ResProj:EffLeakageArea"		ResProj:EffLeakageArea		= {	Local( CondFloorArea ) * Local( ACH50 ) / (2 * 10000)  }    ; SAC 9/7/12 - restore original formula per write-up v7 // SAC 8/31/12 - revise formula per update in airnet write-up (rev 5->6)
;	"Set ResProj:SlabRatio"				ResProj:SlabRatio				= {	if (Local( BldgSlabFloorArea ) < 0.0001 .AND. Local( BldgExtFloorArea ) < 0.0001) then  0
;																					else  Local( BldgSlabFloorArea ) / (Local( BldgSlabFloorArea ) + Local( BldgExtFloorArea ))  endif  }
;	"Set ResProj:UncondZnTotSF"		ResProj:UncondZnTotSF		= {	if (HasGarage < 0.1) then  0
;																					else  SumAll( ResIntWall:ParUZnAdjCndZnArea ) + SumAll( ResIntFlr:ParCndZnAdjUZnArea ) +
;																							SumAll( ResIntWall:ParCndZnAdjUZnArea ) + SumAll( ResIntCeiling:ParUZnAdjCndZnArea )  endif  }
;
;   "Set ResProj:BldgELA_CeilSF"			ResProj:BldgELA_CeilSF			= {   if (Local( BldgClgBlwAtticArea ) < 0.0001 .AND. Local( BldgCathCeilingArea ) < 0.0001) then  0
;																							else  Local( EffLeakageArea ) * (0.4 + (0.1 * Local( SlabRatio ))) / (Local( BldgClgBlwAtticArea ) + Local( BldgCathCeilingArea ))  endif  }
;   "Set ResProj:BldgELA_RaisedFlrSF"	ResProj:BldgELA_RaisedFlrSF	= {   if (Local( BldgExtFloorArea ) < 0.0001) then  0
;																							else  Local( EffLeakageArea ) * (0.2 * (  1 - Local( SlabRatio ))) /  Local( BldgExtFloorArea )  endif  }
;   "Set ResProj:BldgELA_GarageSF"		ResProj:BldgELA_GarageSF		= {   if (Local( UncondZnTotSF ) < 0.0001) then  0
;																							else  Local( EffLeakageArea ) * 0.1 / Local( UncondZnTotSF )  endif  }
;   "Set ResProj:BldgELA_WallSF"			ResProj:BldgELA_WallSF			= {   if (BldgExtWallArea < 0.0001) then  0
;																							else if (UncondZnTotSF < 0.0001)
;																							then  EffLeakageArea * (0.4 + (0.1 * SlabRatio)) / BldgExtWallArea
;																							else  EffLeakageArea * (0.3 + (0.1 * SlabRatio)) / BldgExtWallArea  endif endif  }


;           "BldgExtWallArea",       BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Sum of areas of children ResExtWall:Area"    
;           "BldgClgBlwAtticArea",   BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Sum of areas of children ResCeilingBelowAttic:Area"    
;           "BldgCathCeilingArea",   BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Sum of areas of children ResCathedralCeiling:Area"    
;           "BldgSlabFloorArea",     BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Sum of areas of children ResSlabFlr:Area"    
;           "BldgExtFloorArea",      BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Sum of areas of children ResExtFlr:Area"    
;
;           "EffLeakageArea",        BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Effective leakage area (ELAtot for AirNet)"    
;           "SlabRatio",             BEMP_Flt,  1, "",                 0, "",         0, "",             3008, "Ratio of slab/total floor area (for AirNet)"    
;           "UncondZnTotSF",         BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Total area of all (cond zone) surfaces adjacent to uncond zones (for AirNet)"    
;
;           "BldgELA_CeilSF",        BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Effective Leakage Area through Ceiling surfaces (for AirNet)"
;           "BldgELA_RaisedFlrSF",   BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Effective Leakage Area through Raised Floor surfaces (for AirNet)"
;           "BldgELA_GarageSF",      BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Effective Leakage Area through Garage surfaces (for AirNet)"
;           "BldgELA_WallSF",        BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Effective Leakage Area through Other Wall surfaces (for AirNet)"

	; SAC 5/1/13 - new rulelists to handle IAQ summing into referenced ZONES
	"Set ResZn:IAQ*"		ResProj:Action	= {	if (IsMultiFamily < 0.5)
														then  EvalRulelist( "Set_ZoneIAQ_SFam" )
														else	EvalRulelist( "Set_ZoneIAQ_MFam" )  endif  }

; SAC 7/25/14 - moved some ResZn AirNet rules out of subordinate rulelist to ensure they are evaluated across entire model before evaluating individual ResZn AirNet stuff
	"Set ResZn:ZoneBotZ"				ResZn:ZoneBotZ     		= {	Local( Bottom )  }
	"Set ResZn:ZoneTopZ"				ResZn:ZoneTopZ     		= {	Local( ZoneBotZ ) + (Local( NumStories ) * Local( FloorHeight )) - max( 0, (Local( FloorHeight ) - Local( CeilingHeight )) )  }
	"Set ResZn:ZoneHeight"			ResZn:ZoneHeight   		= {	Local( ZoneTopZ ) - Local( ZoneBotZ )  }
  ; SAC 9/12/12 - restored this rule that was previously commented out
;	"Set ResZn:WinHHTop"				ResZn:WinHHTop     		= {	Local( ZoneBotZ ) + (Local( FloorHeight ) * (Local( NumStories ) - 1)) + Local( WinHeadHeight )  }
;	"Set ResZn:WinHHTopUse"			ResZn:WinHHTopUse			= {	Local( ZoneBotZ ) + Local( WinHeadHeight )  }   ; SAC 5/22/13 - adjust for airnet algorithm 14
	"Set ResZn:WinHHTopUse[1]"		ResZn:WinHHTopUse[1]		= {	if (IfValidAnd( FloorHeight > 1 ) .AND. IfValidAnd( NumStories > 0.5 ))
																					then	if (WinHeadHeight > FloorHeight)
																							then	ZoneBotZ + WinHeadHeight		; user accounting for multi-stories in WinHeadHeight already
																							else	ZoneBotZ + WinHeadHeight + (FloorHeight * (NumStories - 1))    endif
																					else			ZoneBotZ + WinHeadHeight    endif  }
; SAC 7/24/14 - revised WinHHTopUse[1] (above) to take into account multi-story zones (essentially reverting back to a earlier logic) AND added second array value (below) to account for SFam/MFam differences
	"Set ResZn:WinHHTopUse[2]"		ResZn:WinHHTopUse[2]		= {	if (ResProj:IsMultiFamily > 0.5) then  WinHHTopUse[1]
																					else  MaxAll( ResZn:WinHHTopUse[1] )  endif  }

   ; SAC 9/19/19 - OtherZOne (MFamProto)
	"Set ResOtherZn:ZoneBotZ"			ResOtherZn:ZoneBotZ     		= {	Local( Bottom )  }
	"Set ResOtherZn:ZoneTopZ"			ResOtherZn:ZoneTopZ     		= {	Local( ZoneBotZ ) + (Local( NumStories ) * Local( FloorHeight )) - max( 0, (Local( FloorHeight ) - Local( CeilingHeight )) )  }
	"Set ResOtherZn:ZoneHeight"			ResOtherZn:ZoneHeight   		= {	Local( ZoneTopZ ) - Local( ZoneBotZ )  }
	"Set ResOtherZn:WinHHTopUse[1]"	ResOtherZn:WinHHTopUse[1]	= {	if (IfValidAnd( FloorHeight > 1 ) .AND. IfValidAnd( NumStories > 0.5 ))
																							then	if (WinHeadHeight > FloorHeight)
																									then	ZoneBotZ + WinHeadHeight		; user accounting for multi-stories in WinHeadHeight already
																									else	ZoneBotZ + WinHeadHeight + (FloorHeight * (NumStories - 1))    endif
																							else			ZoneBotZ + WinHeadHeight    endif  }
	"Set ResOtherZn:WinHHTopUse[2]"	ResOtherZn:WinHHTopUse[2]	= {	WinHHTopUse[1]  }

	"Setup AirNet ResZn IZXFER objects"			ResZn:Action		= {	if (Local( Type ) == 10) then  UNCHANGED		; Unconditioned
																						else  EvalRulelist( "SimPrep_CSE_AirNet_Zone", 1 )  endif  }
	"Setup AirNet ResOtherZn IZXFER objects"		ResOtherZn:Action	= {	if (Local( Type ) == 10) then  UNCHANGED		; Unconditioned
																						else  EvalRulelist( "SimPrep_CSE_AirNet_ResOtherZone", 1 )  endif  }

   "Setup airnet IZXFERs for CondZn/UncondZn vertical (wall) boundaries (when CSEVentAvailZonal)"   ResProj:Action =    ; SAC 12/01/20
      {  if (CSEVentAvailZonal)
         then  EvalRulelist( "SimPrep_CSE_AirNet_ZoneUncondZone_ByWall" )
         else  UNCHANGED  endif  }

   ; revised to create Zone Balanced IXZFER MFam HRV using rulelist "SimPrep_CSE_AirNet_Zone"- JP 11/27/22 (tic #3425)
;   "Setup MFam DwellingUnit HRV IAQ IZXFERs for individual fans"     DwellingUnit:Action  =     ; SAC 2/6/20 (tic #1174)
;      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. ResProj:IsMultiFamily > 0.5)
;         then  EvalRulelist( "Setup_HRVIAQ_IZXFERs_MFamDwellUnit", 0, "ResProj:HRVIAQ_IZXFER_DwellUnitRef" ) 
;         else  UNCHANGED  endif  }

	"Setup AirNet (other) IZXFER objects"		ResProj:Action		= {	EvalRulelist( "SimPrep_CSE_AirNet_Other" )  }

   ; SAC 10/19/20
	"Create ResOtherZn:ExhaustIZXFERs[1] (exhaust)"		ResOtherZn:ExhaustIZXFERs[1]	= {	if (PrkgGarExhFlow <= 0 .OR. Area <= 0) then  UNCHANGED
																														else  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-Exhst" )  endif  }
	"Set ResOtherZn:ExhaustIZXFERs[1]:izNVType"			ResOtherZn:ExhaustIZXFERs[1]:izNVType		=	{	6  }		; AIRNETEXTFAN  - Fan from exterior to zone
	"Set ResOtherZn:ExhaustIZXFERs[1]:izZn1"				ResOtherZn:ExhaustIZXFERs[1]:izZn1			=	{	CSE_ZONE  }
	"Set ResOtherZn:ExhaustIZXFERs[1]:izVFmin"				ResOtherZn:ExhaustIZXFERs[1]:izVFmin			=	{	PrkgGarExhFlow * -1  }
	"Set ResOtherZn:ExhaustIZXFERs[1]:izVFmax"				ResOtherZn:ExhaustIZXFERs[1]:izVFmax   		=	{	PrkgGarExhFlow * -1  }
	"Set ResOtherZn:ExhaustIZXFERs[1]:izFanVfDs"			ResOtherZn:ExhaustIZXFERs[1]:izFanVfDs 		=	{	PrkgGarExhFlow  }
	"Set ResOtherZn:ExhaustIZXFERs[1]:izFanElecPwr"		ResOtherZn:ExhaustIZXFERs[1]:izFanElecPwr	=	{	if (IfValidAnd( PrkgGarExhFanPwr > 0 )==0) 
	                                                                                                then  UNDEFINED
                                                                                                  else if( PrkgGarExhCtrlMthd = 5) 
                                                                                                       then PrkgGarExhFanPwr * 0.125 ; Reduction for CO controls
                                                                                                       else PrkgGarExhFanPwr
                                                                                                  endif endif   }
	"Set ResOtherZn:ExhaustIZXFERs[1]:izFanMtr"			ResOtherZn:ExhaustIZXFERs[1]:izFanMtr  		=        ; revised to assign Elec2Mtr if IsGarage (so that result posts to Process Motors enduse) - SAC 04/13/22 (Com tic #3366)
      {  if (IfValidAnd( IsGarage > 0 )) then  Proj:CSE_Elec2METER
         else  Proj:CSE_ElecMETER  endif  }
	"Set ResOtherZn:ExhaustIZXFERs[1]:izFanEndUse"		ResOtherZn:ExhaustIZXFERs[1]:izFanEndUse	=	{	"FANV"          }

   "Create ResOtherZn:ExhaustIZXFERs[2]"         ResOtherZn:ExhaustIZXFERs[2]  =  {   if (ExhstOutsideOpening <= 0) then  UNDEFINED
                                                                                    else  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-ExhstOpn" )  endif  }
   "Set ResOtherZn:ExhaustIZXFERs[2]:izNVType"   ResOtherZn:ExhaustIZXFERs[2]:izNVType  = {  4  }       ; AIRNETEXT - Single opening to ambient
   "Set ResOtherZn:ExhaustIZXFERs[2]:izZn1"      ResOtherZn:ExhaustIZXFERs[2]:izZn1     = {  CSE_ZONE  }
   "Set ResOtherZn:ExhaustIZXFERs[2]:izALo"      ResOtherZn:ExhaustIZXFERs[2]:izALo     = {  ExhstOutsideOpening  }
   "Set ResOtherZn:ExhaustIZXFERs[2]:izHD"       ResOtherZn:ExhaustIZXFERs[2]:izHD      = {  max( 0, Bottom )  }
   "Set ResOtherZn:ExhaustIZXFERs[2]:izNVEff"    ResOtherZn:ExhaustIZXFERs[2]:izNVEff   = {  1  }
   "Set ResOtherZn:ExhaustIZXFERs[2]:izExp"      ResOtherZn:ExhaustIZXFERs[2]:izExp     = {  0.65  }
   "Set ResOtherZn:ExhaustIZXFERs[2]:izAFCat"    ResOtherZn:ExhaustIZXFERs[2]:izAFCat   = {  "VentEx"  }

END


;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Zone" 0 0 0 1
;*************************************************************************

   "Set ResZn:ELA_ACeil"				ResZn:ELA_ACeil				= {   Global( ResProj:BldgELA_CeilSF      ) *  Local( ClgBlwAtticArea )  }
   "Set ResZn:ELA_XCeil"				ResZn:ELA_XCeil				= {   Global( ResProj:BldgELA_CeilSF      ) * (				0				  + Local( CathCeilingArea ))  }   ; AtticEdgeArea to be inserted for 0 here
   "Set ResZn:ELA_XWall"				ResZn:ELA_XWall				= {   Global( ResProj:BldgELA_WallSF      ) *  Local( ExtWallArea     )  }
;   "Set ResZn:ELA_GWall"				ResZn:ELA_GWall				= {   0  }     ; Global( ResProj:BldgELA_GarageSF    ) *  Local( <area of ResZn walls adjacent to garage spaces> )  }
   "Set ResZn:ELA_Floor"				ResZn:ELA_Floor				= {   Global( ResProj:BldgELA_RaisedFlrSF ) *  Local( ExtFloorArea    )  }
;   "Set ResZn:ELA_GFloor"			ResZn:ELA_GFloor			= {   if (ResProj:HasGarage > 0.1) then  SumAll( ResGarage:Area ) * Local( FlrOverUncondZnArea ) * 1.45
;																					else  0  endif  }

; SAC 7/25/14 - moved following rules into calling rulelist to ensure they are evaluated across entire model before evaluating individual ResZn AirNet stuff
;		"Set ResZn:ZoneBotZ"				ResZn:ZoneBotZ     		= {	Local( Bottom )  }
;		"Set ResZn:ZoneTopZ"				ResZn:ZoneTopZ     		= {	Local( ZoneBotZ ) + (Local( NumStories ) * Local( FloorHeight )) - max( 0, (Local( FloorHeight ) - Local( CeilingHeight )) )  }
;		"Set ResZn:ZoneHeight"			ResZn:ZoneHeight   		= {	Local( ZoneTopZ ) - Local( ZoneBotZ )  }
;	  ; SAC 9/12/12 - restored this rule that was previously commented out
;	;	"Set ResZn:WinHHTop"				ResZn:WinHHTop     		= {	Local( ZoneBotZ ) + (Local( FloorHeight ) * (Local( NumStories ) - 1)) + Local( WinHeadHeight )  }
;	;	"Set ResZn:WinHHTopUse"			ResZn:WinHHTopUse			= {	Local( ZoneBotZ ) + Local( WinHeadHeight )  }   ; SAC 5/22/13 - adjust for airnet algorithm 14
;		"Set ResZn:WinHHTopUse[1]"		ResZn:WinHHTopUse[1]		= {	if (IfValidAnd( FloorHeight > 1 ) .AND. IfValidAnd( NumStories > 0.5 ))
;																						then	if (WinHeadHeight > FloorHeight)
;																								then	ZoneBotZ + WinHeadHeight		; user accounting for multi-stories in WinHeadHeight already
;																								else	ZoneBotZ + WinHeadHeight + (FloorHeight * (NumStories - 1))    endif
;																						else			ZoneBotZ + WinHeadHeight    endif  }
;	; SAC 7/24/14 - revised WinHHTopUse[1] (above) to take into account multi-story zones (essentially reverting back to a earlier logic) AND added second array value (below) to account for SFam/MFam differences
;		"Set ResZn:WinHHTopUse[2]"		ResZn:WinHHTopUse[2]		= {	if (ResProj:IsMultiFamily > 0.5) then  WinHHTopUse[1]
;																						else  MaxAll( ResZn:WinHHTopUse[1] )  endif  }

	"Set ResZn:WallHoleSize"			ResZn:WallHoleSize			= {	Local( ELA_XWall ) * 1.45 / 8  }

	"Create & setup ResZn:AirNetIZXFERs[1-6] iff WallHoleSize > 0"
			ResZn:Action	 = {	if (WallHoleSize <= 0) then  UNCHANGED
									else  EvalRulelist( "SimPrep_CSE_AirNet_Zone_ExtWall", 1 )  endif  }

 ;-----------------------
 ; WINDOW AirNet
 ;-----------------------
; SAC 6/17/14 - switched to array of 3 for nat vent testing
;	"Set ResZn:WinVentHtDiff"		ResZn:WinVentHtDiff 	= {	2.0  }
	; Expression describing hourly window hole area (1=>WnLU/LD, 2=>WnLS)
	; from AirNetAlgorithm2.txt -- WnHole = 0.5*(WnVentArea/8.)*Win_hr*Windowmode // 1/8th in each hole,  ft2.  1/2 of nominal area to account for screens etc.  Hourly and seasonal availability 

				; 2.  Cooling Ventilation Setup:  4 types:  Windows only (all types have windows for some part of the year), Whole house fan, Smart Vent, NightBreeze
				;       Set up seasonal window control
				;  #if Smart Vent or NightBreeze //Windows are on in Winter, but off in summer when mechanical ventilation is on
				; 	   #redefine Windowmode select( @weather.taDbAvg07 >60., 0.00001,default 1.) 
				; 	   #define VentDiffMult  select( @top.tDbOSh < (@znRes[Single].prior.S.tAir-VentDiff), 1,default 0.000001) //Vent off if Tin-Vendiff > Tout  !! 110413  XXX
				; 	#Else  //everything but Econ and NightBreeeze Windows are on year round
				; 	   #reDefine Windowmode 1.       //Always available
				; 	   #Define VentDiff 0          // Differential.  No differential for windows or WWF  110309 BAW

	"Create & setup ResZn:WinAirNetIZXFERs[1-6] iff WinVentArea > 0"
			ResZn:Action	 = {	if (WinVentArea < 0.0001) then  UNCHANGED
									else	EvalRulelist( "SimPrep_CSE_AirNet_Zone_Windows_1Story", 1 )  endif  }
; SAC 7/24/14 - revised logic to ALWAYS generate window AirNet objects using the single story logic (removing below)
;									else if (NumStories < 1.5)
;									then  EvalRulelist( "SimPrep_CSE_AirNet_Zone_Windows_1Story", 1 )
;									else  EvalRulelist( "SimPrep_CSE_AirNet_Zone_Windows_MultiStory", 1 )  endif endif  }

; SAC 8/29/13 - moved to "SimPrep_CSE_AirNet_Other" rulelist, since rules here need to be evaluated on ResProj as well as Zone
; ;-----------------------
; ; AirNet for ceiling below attic in Conditioned Zone
; ;-----------------------

   "Setup airnet IZXFERs for CondZn/UncondZn vertical (wall) boundaries"   ResZn:Action =
      {  if (ResProj:CSEVentAvailZonal) then  UNCHANGED
         else  EvalRulelist( "SimPrep_CSE_AirNet_ZoneUncondZone_ByZone", 1 )  endif  }
; moved into rulelist(s) called above - SAC 11/30/20
;	; for garage wall
;	"Set ResZn:AdjUncondZnWallArea"						ResZn:AdjUncondZnWallArea		=	{	SumChildren( ResIntWall:ParCndZnAdjUZnArea)
;																													+ SumRevRef( ResIntWall:Outside, ResIntWall:ParUZnAdjCndZnArea)	}
;	"Set ResZn:GrgWallH"										ResZn:GrgWallH						=	{	Global(ResProj:BldgELA_GarageSF) * AdjUncondZnWallArea / 2.		}
;	"Set ResZn:GrgWallTopZ"									ResZn:GrgWallTopZ					=	{	min( Local(Top), Local(Top) )						}	;Global(ResGarage:Top)
;	"Set ResZn:GrgWallBotZ"									ResZn:GrgWallBotZ					=	{	min( Local(Bottom), Local(Bottom) )					}	;Global(ResGarage:Bottom)
;	"Set ResZn:GrgWallHt"										ResZn:GrgWallHt						=	{	Local(GrgWallTopZ) - Local(GrgWallBotZ)						}
;	"Set ResZn:GrgWallHoleHiZ"								ResZn:GrgWallHoleHiZ				=	{	Local(GrgWallBotZ) + (0.75 * Local(GrgWallHt))				}
;	"Set ResZn:GrgWallHoleLoZ"								ResZn:GrgWallHoleLoZ				=	{	Local(GrgWallBotZ) + (0.25 * Local(GrgWallHt))				}
;
;	"Create ResZn:GrgWallAirNetIZXFERs[1]"				ResZn:GrgWallAirNetIZXFERs[1]	=	{	if ( Local(GrgWallH) > 0. ) 
;																															then CreateComp( cseIZXFER, Local( Name ) + "-xGarageH")
;																															else UNDEFINED
;																															endif  }
;	"Set ResZn:GrgWallAirNetIZXFERs[1]:izNVType"			ResZn:GrgWallAirNetIZXFERs[1]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
;	"Set ResZn:GrgWallAirNetIZXFERs[1]:izZn1"				ResZn:GrgWallAirNetIZXFERs[1]:izZn1		=	{	Local( CSE_ZONE )  }
;	"Set ResZn:GrgWallAirNetIZXFERs[1]:izALo"				ResZn:GrgWallAirNetIZXFERs[1]:izALo		=	{	Local( GrgWallH )  }
;	"Set ResZn:GrgWallAirNetIZXFERs[1]:izHD"				ResZn:GrgWallAirNetIZXFERs[1]:izHD   	=	{	Local( GrgWallHoleHiZ )  }
;	"Set ResZn:GrgWallAirNetIZXFERs[1]:izNVEff"			ResZn:GrgWallAirNetIZXFERs[1]:izNVEff	=	{	1.0  }
;	"Set ResZn:GrgWallAirNetIZXFERs[1]:izExp"				ResZn:GrgWallAirNetIZXFERs[1]:izExp  	=	{	0.65  }
;	"Set ResZn:GrgWallAirNetIZXFERs[1]:izZN2"				ResZn:GrgWallAirNetIZXFERs[1]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }
;																					
;	"Create ResZn:GrgWallAirNetIZXFERs[2]"					ResZn:GrgWallAirNetIZXFERs[2]		=	{	if ( Local(GrgWallH) > 0. ) 
;																															then CreateComp( cseIZXFER, Local( Name ) + "-xGarageL")
;																															else UNDEFINED
;																															endif  }
;	"Set ResZn:GrgWallAirNetIZXFERs[2]:izNVType"			ResZn:GrgWallAirNetIZXFERs[2]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
;	"Set ResZn:GrgWallAirNetIZXFERs[2]:izZn1"				ResZn:GrgWallAirNetIZXFERs[2]:izZn1		=	{	Local( CSE_ZONE )  }
;	"Set ResZn:GrgWallAirNetIZXFERs[2]:izALo"				ResZn:GrgWallAirNetIZXFERs[2]:izALo		=	{	Local( GrgWallH )  }
;	"Set ResZn:GrgWallAirNetIZXFERs[2]:izHD"				ResZn:GrgWallAirNetIZXFERs[2]:izHD   	=	{	Local( GrgWallHoleLoZ )  }
;	"Set ResZn:GrgWallAirNetIZXFERs[2]:izNVEff"			ResZn:GrgWallAirNetIZXFERs[2]:izNVEff	=	{	1.0  }
;	"Set ResZn:GrgWallAirNetIZXFERs[2]:izExp"				ResZn:GrgWallAirNetIZXFERs[2]:izExp  	=	{	0.65  }
;	"Set ResZn:GrgWallAirNetIZXFERs[2]:izZN2"				ResZn:GrgWallAirNetIZXFERs[2]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }

 ;-----------------------
 ; AirNet for IAQ Ventilation
 ;-----------------------
	;   IAQ ventilation  For MF flows may be summed accross units being modelled together in a single zone with W/CFM and ASEF flow weighted.  130517
	;       Inputs for each zone
	;         IAQVentCFM     	// CFM of IAQ vent   
	;         IAQfanWperCFM  	// W/CFM of IAQ vent   
	;         Type IAQExhaust     	// "IAQExhaust", "IAQSupply", "IAQBalanced" "NoIAQVent"
	;	 ASEF     	// If type is IAQBalanced, the apparent sensible effectiveness, fraction (includes fan heat).  Range 0 - 1, default 0  130517
	;		Write Airnet Objects to CSE Input		
	;    
	;	 If Exhaust 
	;	    IZXFER (ResZn)IAQfan izNVTYPE = AirNetExtFan izZN1 = (ResZn) izVFmin=-IAQVentCFM izVFmax=-IAQVentCFM izFanVfDs=IAQVentCFM izFanElecPwr=IAQfanWperCFM izFanMtr=IAQventMtr
	;	
	;	 If IAQSupply
	;            IZXFER (ResZn)IAQfan izNVTYPE = AirNetExtFan izZN1 = (ResZn) izVFmin=IAQVentCFM izVFmax=-IAQVentCFM izFanVfDs=IAQVentCFM izFanElecPwr=IAQfanWperCFM izFanMtr=IAQventMtr
	;	
	;	 If IAQBalanced  // Balanced or Heat recovery ventilator 130517
	;	     IZXFER (ResZn)IAQHRV  izNVTYPE = AIRNETHERV izZN1 = (ResZn) izFanVFDS = IAQVentCFM  izFanElecPwr=IAQfanWperCFM izFanMtr=IAQventMtr izASEF=ASEF  

	;					where:		0, HVACFan:IAQFanType,  1
	;									2,              1,    "Exhaust"
	;									2,              2,    "Supply"
	;									2,              3,    "Balanced"

   ; SAC 3/20/19 - added in references to new IAQCFMScaleFactor[3&4] - used by CEC in testing IAQ CFM limits (tic #1083)
   ; SAC 4/17/19 - removed references to new IAQCFMScaleFactor[3&4] from rules setting izFanElecPwr to ensure same W/CFM between Prop & Std models (tic #1083)
   ; SAC 12/16/19 - switched from Proj to Zone IAQCFMScaleFactors and added use of ResZn:IAQPwrScaleFactor
  "Create ResZn:IAQVentAirNetIZXFERs[1] (supply)"   ResZn:IAQVentAirNetIZXFERs[1]	= {	if( (IAQCFM_Supply[1] <= 0 .OR. IAQPwr_Supply[1] <= 0 ) .AND. CentralSupplyCFM <= 0 ) then  UNCHANGED
																													                               else  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-IAQFanS" )  endif  }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izNVType"      ResZn:IAQVentAirNetIZXFERs[1]:izNVType     = { if( CentralSupplyCFM > 0 ) then 11 else 6 endif }		; AIRNETEXTFAN  - Fan from exterior to zone
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izZn1"         ResZn:IAQVentAirNetIZXFERs[1]:izZn1        = { CSE_ZONE  }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izDOAS"        ResZn:IAQVentAirNetIZXFERs[1]:izDOAS       = { if( CentralSupplyCFM > 0 ) then CentralVentSysRef:cseDOAS else UNDEFINED endif }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izVFmin"       ResZn:IAQVentAirNetIZXFERs[1]:izVFmin      = { if( CentralSupplyCFM > 0 ) then CentralSupplyCFM else IAQCFM_Supply[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izVFmax"       ResZn:IAQVentAirNetIZXFERs[1]:izVFmax      = { if( CentralSupplyCFM > 0 ) then UNDEFINED else IAQCFM_Supply[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izFanVfDs"     ResZn:IAQVentAirNetIZXFERs[1]:izFanVfDs    = { if( CentralSupplyCFM > 0 ) then UNDEFINED else IAQCFM_Supply[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izFanElecPwr"  ResZn:IAQVentAirNetIZXFERs[1]:izFanElecPwr = { if( CentralSupplyCFM > 0 ) then UNDEFINED else IAQPwr_Supply[1] * ValidOr( IAQPwrScaleFactor[1], 1 ) / IAQCFM_Supply[1] endif }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izFanMtr"      ResZn:IAQVentAirNetIZXFERs[1]:izFanMtr     = { if( CentralSupplyCFM > 0 ) then UNDEFINED else CSE_ElecMETER endif }
  "Set ResZn:IAQVentAirNetIZXFERs[1]:izFanEndUse"   ResZn:IAQVentAirNetIZXFERs[1]:izFanEndUse  = { if( CentralSupplyCFM > 0 ) then UNDEFINED else "FANV" endif }

  "Create ResZn:IAQVentAirNetIZXFERs[2] (exhaust)"  ResZn:IAQVentAirNetIZXFERs[2]	= {	if( (IAQCFM_Exhaust[1] <= 0 .OR. IAQPwr_Exhaust[1] <= 0) .AND. CentralExhaustCFM <= 0 ) then  UNCHANGED
  																												                          	else  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-IAQFanE" )  endif  }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izNVType"      ResZn:IAQVentAirNetIZXFERs[2]:izNVType     = { if( CentralExhaustCFM > 0 ) then 11 else 6 endif }		; AIRNETEXTFAN  - Fan from exterior to zone
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izZn1"         ResZn:IAQVentAirNetIZXFERs[2]:izZn1			   = { CSE_ZONE }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izDOAS"        ResZn:IAQVentAirNetIZXFERs[2]:izDOAS       = { if( CentralExhaustCFM > 0 ) then CentralVentSysRef:cseDOAS else UNDEFINED endif }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izVFmin"			  ResZn:IAQVentAirNetIZXFERs[2]:izVFmin      = { if( CentralExhaustCFM > 0 ) then -1 * CentralExhaustCFM else IAQCFM_Exhaust[1] * -1 * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izVFmax"			  ResZn:IAQVentAirNetIZXFERs[2]:izVFmax      = { if( CentralExhaustCFM > 0 ) then UNDEFINED else IAQCFM_Exhaust[1] * -1 * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izFanVfDs"     ResZn:IAQVentAirNetIZXFERs[2]:izFanVfDs    = { if( CentralExhaustCFM > 0 ) then UNDEFINED else IAQCFM_Exhaust[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izFanElecPwr"  ResZn:IAQVentAirNetIZXFERs[2]:izFanElecPwr = { if( CentralExhaustCFM > 0 ) then UNDEFINED else IAQPwr_Exhaust[1] * ValidOr( IAQPwrScaleFactor[1], 1 ) / IAQCFM_Exhaust[1] endif }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izFanMtr"      ResZn:IAQVentAirNetIZXFERs[2]:izFanMtr     = { if( CentralExhaustCFM > 0 ) then UNDEFINED else CSE_ElecMETER endif }
  "Set ResZn:IAQVentAirNetIZXFERs[2]:izFanEndUse"   ResZn:IAQVentAirNetIZXFERs[2]:izFanEndUse  = { if( CentralExhaustCFM > 0 ) then UNDEFINED else "FANV" endif}

   ; SAC 2/5/20 - mods to BYPASS creation of HRV IZXFER HERE for 2019.2.0+ - now needs to happen by individual zone & fan...
   ; revised to create Zone Balanced IZXFER if any Balanced-only fans assigned - SAC 7/25/20 (tic #1174)
   ; revised to create Zone Balanced IXZFER MFam HRV - JP 11/27/22 (tic #3425)
	"Create ResZn:IAQVentAirNetIZXFERs[3] (balanced)"	ResZn:IAQVentAirNetIZXFERs[3]	= {	if (IAQHRVCFM[1] <= 0 .OR. IAQHRVPwr[1] <= 0 .OR.
	                                                                                           (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. ResProj:IsMultiFamily < 0.5 .AND. IfValidAnd( IAQBalCFM[1] = 0 ))) then  UNCHANGED
																														else  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-IAQHRV" )  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izNVType"			ResZn:IAQVentAirNetIZXFERs[3]:izNVType		=	{	10  }		; AIRNETHERV  - IAQ balanced / heat recovery ventilator
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izZn1"				ResZn:IAQVentAirNetIZXFERs[3]:izZn1			=	{	CSE_ZONE  }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izFanVfDs"			ResZn:IAQVentAirNetIZXFERs[3]:izFanVfDs 	=	{	if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. ResProj:IsMultiFamily < 0.5)
	                                                                                                   then  IAQBalCFM[1] * ValidOr( IAQCFMScaleFactor[1], 1 )
	                                                                                                   else  IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor[1], 1 )  endif       }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izFanElecPwr"		ResZn:IAQVentAirNetIZXFERs[3]:izFanElecPwr	=	{	if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. ResProj:IsMultiFamily < 0.5)
	                                                                                                   then  IAQBalPwr[1] * ValidOr( IAQPwrScaleFactor[1], 1 ) / IAQBalCFM[1]
	                                                                                                   else  IAQHRVPwr[1] * ValidOr( IAQPwrScaleFactor[1], 1 ) / IAQHRVCFM[1]  endif   }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izASEF"				ResZn:IAQVentAirNetIZXFERs[3]:izASEF			=
      {  if (IAQHRVCFMxRcvEff[1] <= 0 .OR. IAQHRVCFMxRcvEff[1] > (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) * 100) .OR.
             (IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[1] >= IAQHRVCFMxSRE[1] ))) then  UNDEFINED
         else  (IAQHRVCFMxRcvEff[1] / (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor[1], 1 ))) / 100  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izSRE"				ResZn:IAQVentAirNetIZXFERs[3]:izSRE			=        ; SAC 10/21/19
      {  if (IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[1] >= IAQHRVCFMxSRE[1] ))
         then  (IAQHRVCFMxSRE[1] / (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor[1], 1 ))) / 100
         else  UNDEFINED  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izASRE"				ResZn:IAQVentAirNetIZXFERs[3]:izASRE			=
      {  if (IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[1] >= IAQHRVCFMxSRE[1] ))
         then  (IAQHRVCFMxASRE[1] / (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor[1], 1 ))) / 100
         else  UNDEFINED  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izFanMtr"			ResZn:IAQVentAirNetIZXFERs[3]:izFanMtr  	=	{	CSE_ElecMETER  }
	"Set ResZn:IAQVentAirNetIZXFERs[3]:izFanEndUse"		ResZn:IAQVentAirNetIZXFERs[3]:izFanEndUse	=	{	"FANV"          }
   ; SAC 2/5/20 - initiate rulelist calls to setup individual HRV IAQ IZXFERs by Fan... (tic #1174)
   "Setup SFam (main home) HRV IAQ IZXFERs for individual fans"      ResZn:Action  =
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. ResProj:IsMultiFamily < 0.5)
         then  EvalRulelist( "Setup_HRVIAQ_IZXFERs_SFamZone", 0, "ResProj:HRVIAQ_IZXFER_ZoneRef" ) 
         else  UNCHANGED  endif  }

   ; SAC 4/22/19 - added ADU IAQ object output  --------------
	"Create ResZn:IAQVentAirNetIZXFERs[4] (supply)"		ResZn:IAQVentAirNetIZXFERs[4]	= {	if (IAQCFM_Supply[2] <= 0 .OR. IAQPwr_Supply[2] <= 0) then  UNCHANGED
																														else  CreateComp( cseIZXFER, substr( Name, 0, 40 ) + "-ADUIAQFanS" )  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izNVType"			ResZn:IAQVentAirNetIZXFERs[4]:izNVType		=	{	6  }		; AIRNETEXTFAN  - Fan from exterior to zone
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izZn1"				ResZn:IAQVentAirNetIZXFERs[4]:izZn1			=	{	CSE_ZONE  }
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izVFmin"			ResZn:IAQVentAirNetIZXFERs[4]:izVFmin		=	{	IAQCFM_Supply[2] * ValidOr( IAQCFMScaleFactor[2], 1 )  }
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izVFmax"			ResZn:IAQVentAirNetIZXFERs[4]:izVFmax   	=	{	IAQCFM_Supply[2] * ValidOr( IAQCFMScaleFactor[2], 1 )  }
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izFanVfDs"			ResZn:IAQVentAirNetIZXFERs[4]:izFanVfDs 	=	{	IAQCFM_Supply[2] * ValidOr( IAQCFMScaleFactor[2], 1 )  }
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izFanElecPwr"		ResZn:IAQVentAirNetIZXFERs[4]:izFanElecPwr	=	{	IAQPwr_Supply[2] * ValidOr( IAQPwrScaleFactor[2], 1 ) / IAQCFM_Supply[2]   }
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izFanMtr"			ResZn:IAQVentAirNetIZXFERs[4]:izFanMtr  	=	{	CSE_ElecMETER  }
	"Set ResZn:IAQVentAirNetIZXFERs[4]:izFanEndUse"		ResZn:IAQVentAirNetIZXFERs[4]:izFanEndUse	=	{	"FANV"          }

	"Create ResZn:IAQVentAirNetIZXFERs[5] (exhaust)"		ResZn:IAQVentAirNetIZXFERs[5]	= {	if (IAQCFM_Exhaust[2] <= 0 .OR. IAQPwr_Exhaust[2] <= 0) then  UNCHANGED
																														else  CreateComp( cseIZXFER, substr( Name, 0, 40 ) + "-ADUIAQFanE" )  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izNVType"			ResZn:IAQVentAirNetIZXFERs[5]:izNVType		=	{	6  }		; AIRNETEXTFAN  - Fan from exterior to zone
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izZn1"				ResZn:IAQVentAirNetIZXFERs[5]:izZn1			=	{	CSE_ZONE  }
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izVFmin"			ResZn:IAQVentAirNetIZXFERs[5]:izVFmin		=	{	IAQCFM_Exhaust[2] * -1 * ValidOr( IAQCFMScaleFactor[2], 1 )  }
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izVFmax"			ResZn:IAQVentAirNetIZXFERs[5]:izVFmax   	=	{	IAQCFM_Exhaust[2] * -1 * ValidOr( IAQCFMScaleFactor[2], 1 )  }
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izFanVfDs"			ResZn:IAQVentAirNetIZXFERs[5]:izFanVfDs 	=	{	IAQCFM_Exhaust[2]      * ValidOr( IAQCFMScaleFactor[2], 1 )  }
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izFanElecPwr"		ResZn:IAQVentAirNetIZXFERs[5]:izFanElecPwr	=	{	IAQPwr_Exhaust[2]      * ValidOr( IAQPwrScaleFactor[2], 1 ) / IAQCFM_Exhaust[2]   }
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izFanMtr"			ResZn:IAQVentAirNetIZXFERs[5]:izFanMtr  	=	{	CSE_ElecMETER  }
	"Set ResZn:IAQVentAirNetIZXFERs[5]:izFanEndUse"		ResZn:IAQVentAirNetIZXFERs[5]:izFanEndUse	=	{	"FANV"          }

   ; SAC 2/6/20 - mods to BYPASS creation of ADU HRV IZXFER HERE for 2019.2.0+ - now needs to happen by individual zone & fan...
   ; revised to create Zone Balanced IZXFER if any Balanced-only fans assigned - SAC 7/25/20 (tic #1174)
	"Create ResZn:IAQVentAirNetIZXFERs[6] (balanced)"	ResZn:IAQVentAirNetIZXFERs[6]	= {	if (IAQHRVCFM[2] <= 0 .OR. IAQHRVPwr[2] <= 0 .OR.
	                                                                                           (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. ResProj:IsMultiFamily < 0.5 .AND. IfValidAnd( IAQBalCFM[2] = 0 ))) then  UNCHANGED
																														else  CreateComp( cseIZXFER, substr( Name, 0, 40 ) + "-ADUIAQHRV" )  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izNVType"			ResZn:IAQVentAirNetIZXFERs[6]:izNVType		=	{	10  }		; AIRNETHERV  - IAQ balanced / heat recovery ventilator
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izZn1"				ResZn:IAQVentAirNetIZXFERs[6]:izZn1			=	{	CSE_ZONE  }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izFanVfDs"			ResZn:IAQVentAirNetIZXFERs[6]:izFanVfDs 	=	{	if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
	                                                                                                   then  IAQBalCFM[2] * ValidOr( IAQCFMScaleFactor[2], 1 )
	                                                                                                   else  IAQHRVCFM[2] * ValidOr( IAQCFMScaleFactor[2], 1 )  endif       }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izFanElecPwr"		ResZn:IAQVentAirNetIZXFERs[6]:izFanElecPwr	=	{	if (IfValidAnd( Proj:AnalysisVersion >= 190200 ))
	                                                                                                   then  IAQBalPwr[2] * ValidOr( IAQPwrScaleFactor[2], 1 ) / IAQBalCFM[2]
	                                                                                                   else  IAQHRVPwr[2] * ValidOr( IAQPwrScaleFactor[2], 1 ) / IAQHRVCFM[2]  endif   }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izASEF"				ResZn:IAQVentAirNetIZXFERs[6]:izASEF			=
      {  if (IAQHRVCFMxRcvEff[2] <= 0 .OR. IAQHRVCFMxRcvEff[2] > (IAQHRVCFM[2] * ValidOr( IAQCFMScaleFactor[2], 1 ) * 100) .OR.
             (IfValidAnd( IAQHRVCFMxSRE[2] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[2] >= IAQHRVCFMxSRE[2] ))) then  UNDEFINED
         else  (IAQHRVCFMxRcvEff[2] / (IAQHRVCFM[2] * ValidOr( IAQCFMScaleFactor[2], 1 ))) / 100  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izSRE"				ResZn:IAQVentAirNetIZXFERs[6]:izSRE			=        ; SAC 10/21/19
      {  if (IfValidAnd( IAQHRVCFMxSRE[2] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[2] >= IAQHRVCFMxSRE[2] ))
         then  (IAQHRVCFMxSRE[2] / (IAQHRVCFM[2] * ValidOr( IAQCFMScaleFactor[2], 1 ))) / 100
         else  UNDEFINED  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izASRE"				ResZn:IAQVentAirNetIZXFERs[6]:izASRE			=
      {  if (IfValidAnd( IAQHRVCFMxSRE[2] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[2] >= IAQHRVCFMxSRE[2] ))
         then  (IAQHRVCFMxASRE[2] / (IAQHRVCFM[2] * ValidOr( IAQCFMScaleFactor[2], 1 ))) / 100
         else  UNDEFINED  endif  }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izFanMtr"			ResZn:IAQVentAirNetIZXFERs[6]:izFanMtr  	=	{	CSE_ElecMETER  }
	"Set ResZn:IAQVentAirNetIZXFERs[6]:izFanEndUse"		ResZn:IAQVentAirNetIZXFERs[6]:izFanEndUse	=	{	"FANV"          }
   ; SAC 2/6/20 - initiate rulelist calls to setup individual ADU HRV IAQ IZXFERs by Fan... (tic #1174)
   "Setup ADU HRV IAQ IZXFERs for individual fans"    ResZn:Action  =
      {  if (IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND. IfValidAnd( IAQHRVCFMxSRE[2] > 0 ))
         then  EvalRulelist( "Setup_HRVIAQ_IZXFERs_SFamADUZone", 0, "ResProj:HRVIAQ_IZXFER_ZoneRef" ) 
         else  UNCHANGED  endif  }

; previous version
;	"Create ResZn:IAQVentAirNetIZXFERs[1] (supply)"		ResZn:IAQVentAirNetIZXFERs[1]	= {	if (LocalCompAssigned( IAQVentSystem ) == 0) then  UNCHANGED
;																														else if (LocalRef( IAQVentSystem:Fan:IAQCFM ) > 0 .AND.
;																																	LocalRef( IAQVentSystem:Fan:IAQFanType ) > 1.1)  ; Supply or Balanced
;																														then  CreateComp( cseIZXFER, Local( Name ) + "-IAQFanS" )
;																														else  UNCHANGED  endif endif  }
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izNVType"			ResZn:IAQVentAirNetIZXFERs[1]:izNVType		=	{	6  }		; AIRNETEXTFAN  - Fan from exterior to zone
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izZn1"				ResZn:IAQVentAirNetIZXFERs[1]:izZn1			=	{	CSE_ZONE  }
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izVFmin"			ResZn:IAQVentAirNetIZXFERs[1]:izVFmin		=	{	IAQVentSystem:Fan:IAQCFM * CondFloorArea / IAQVentSystem:FloorAreaServed  }
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izVFmax"			ResZn:IAQVentAirNetIZXFERs[1]:izVFmax   	=	{	IAQVentSystem:Fan:IAQCFM * CondFloorArea / IAQVentSystem:FloorAreaServed  }
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izFanVfDs"			ResZn:IAQVentAirNetIZXFERs[1]:izFanVfDs 	=	{	IAQVentSystem:Fan:IAQCFM * CondFloorArea / IAQVentSystem:FloorAreaServed  }
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izFanElecPwr"		ResZn:IAQVentAirNetIZXFERs[1]:izFanElecPwr	=	{	IAQVentSystem:Fan:WperCFMIAQ   }
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izFanMtr"			ResZn:IAQVentAirNetIZXFERs[1]:izFanMtr  	=	{	CSE_ElecMETER  }
;	"Set ResZn:IAQVentAirNetIZXFERs[1]:izFanEndUse"		ResZn:IAQVentAirNetIZXFERs[1]:izFanEndUse	=	{	"FANV"          }
;
;	"Create ResZn:IAQVentAirNetIZXFERs[2] (exhaust)"		ResZn:IAQVentAirNetIZXFERs[2]	= {	if (LocalCompAssigned( IAQVentSystem ) == 0) then  UNCHANGED
;																														else if (LocalRef( IAQVentSystem:Fan:IAQCFM ) > 0 .AND.
;																																	LocalRef( IAQVentSystem:Fan:IAQFanType ) != 2)  ; Exhaust or Balanced
;																														then  CreateComp( cseIZXFER, Local( Name ) + "-IAQFanE" )
;																														else  UNCHANGED  endif endif  }
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izNVType"			ResZn:IAQVentAirNetIZXFERs[2]:izNVType		=	{	6  }		; AIRNETEXTFAN  - Fan from exterior to zone
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izZn1"				ResZn:IAQVentAirNetIZXFERs[2]:izZn1			=	{	CSE_ZONE  }
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izVFmin"			ResZn:IAQVentAirNetIZXFERs[2]:izVFmin		=	{	IAQVentSystem:Fan:IAQCFM * -1 * CondFloorArea / IAQVentSystem:FloorAreaServed  }
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izVFmax"			ResZn:IAQVentAirNetIZXFERs[2]:izVFmax   	=	{	IAQVentSystem:Fan:IAQCFM * -1 * CondFloorArea / IAQVentSystem:FloorAreaServed  }
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izFanVfDs"			ResZn:IAQVentAirNetIZXFERs[2]:izFanVfDs 	=	{	IAQVentSystem:Fan:IAQCFM      * CondFloorArea / IAQVentSystem:FloorAreaServed  }
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izFanElecPwr"		ResZn:IAQVentAirNetIZXFERs[2]:izFanElecPwr	=	{	IAQVentSystem:Fan:WperCFMIAQ   }
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izFanMtr"			ResZn:IAQVentAirNetIZXFERs[2]:izFanMtr  	=	{	CSE_ElecMETER  }
;	"Set ResZn:IAQVentAirNetIZXFERs[2]:izFanEndUse"		ResZn:IAQVentAirNetIZXFERs[2]:izFanEndUse	=	{	"FANV"          }

; SAC 4/18/13 - revised CoolVent whole house fan air net stuff to generate a single whole house fan per system, rather than per zone
; SAC 5/2/13 - RESTORED this call w/ revised logic, since now generating whole house fans (again) by zone and not system
 ;-----------------------
 ; AirNet for Cooling Ventilation (whole house fan / economizer / night breeze)
 ;-----------------------
   ; SAC 8/3/14 - added logic to prevent creation of IZXFER if no valid attic exists (and log this issue to project log file)
   ; SAC 1/20/19 - revised to prevent warning msg regardless of Attic presence/status for new ResProj:UnitClVentOption = 'Whole House Fan exhausting to outside' (tic #1040)
   "Log invalid WHF generation issue"     ResZn:Action  =
      {  if (ClVentAirFlow[1] > 0 .AND. ClVentPower[1] > 0 .AND. ResProj:IsMultiFamily < 1)
         then  if (ComponentCount( Attic ) < 1)
               then  PostWarning( "Zone '%s' should be modeled with whole house fan, but cannot be due to no Attic present.", Name )
               else  if (IfValidAnd( ResProj:CondFloorArea > 1 ))
                     then  if ((SumAll( ResAttic:FloorAreaOverCond ) / ResProj:CondFloorArea) < 0.1)
                           then  PostWarning( "Zone '%s' should be modeled with whole house fan, but cannot be due to Attic not adjacent to at least 10% of overall conditioned floor area.", Name )
                           else  UNCHANGED  endif
                     else  UNCHANGED  endif
               endif
         else  UNCHANGED  endif  }
   "Call subordinate rulelist to setup ClVent IZXFER object(s) to ATTIC"   ResZn:Action  =
      {  if (ClVentAirFlow[1] < 0.1 .OR. ClVentPower[1] < 0.1) then  UNCHANGED
         else if (LocalCompAssigned( MaxClVentableAttic ) > 0.5)
         then  if (IfValidAnd( ResProj:CondFloorArea > 1 ) .AND. LocalCompAssigned( MaxClVentableAttic:CSE_ZONE ) > 0.5)
               then  if ((SumAll( ResAttic:FloorAreaOverCond ) / ResProj:CondFloorArea) >= 0.1)
                     then  EvalRulelist( "SimPrep_CSE_AirNet_Zone_WholeHouseFan_ToAttic", 1 )
                     else  UNCHANGED  endif
               else  UNCHANGED  endif
         else  UNCHANGED  endif endif  }
   "Call subordinate rulelist to setup ClVent IZXFER object(s) to OUTSIDE"   ResZn:Action  =
      {  if (ClVentAirFlow[2] < 0.1 .OR. ClVentPower[2] < 0.1) then  UNCHANGED
         else if (ResProj:IsMultiFamily < 1 .AND. IfValidAnd( ResProj:CondFloorArea > 1 ))
         then  EvalRulelist( "SimPrep_CSE_AirNet_Zone_WholeHouseFan_ToOutside", 1 )
         else  UNCHANGED  endif endif  }

   "Call subordinate rulelist to setup ClVent IZXFER object to model WHF damper to outside (for ClVent to outside)"     ; SAC 1/20/19 (tic #1040)
      ResZn:Action  = {  if (ClVentAirFlow[2] > 0 .AND. ClVentPower[2] > 0 .AND.
                            IfValidAnd( ResProj:CondFloorArea > 1 ))
                        then  EvalRulelist( "SimPrep_CSE_AirNet_Zone_WholeHouseFan_OutsideDamper", 1 )
                        else  UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Zone_WholeHouseFan_ToAttic" 0 0 0 1
;*************************************************************************
	; from AirNetAlogorithm9.txt:
	;	7.  Mechanical Cooling Ventilation   //  The following does not work for multi-zone systems with Econ, NightBreeze.  Revise along with ducts model
	;		For each Cooling Ventilation System
	;		Inputs 
	;	         CoolVentType		//type of MECHANICAL cooling ventilation,  Choice of WHF, Econ, NightBreeze
	;		 CoolVentCFM		//Rated air flow of the mechanical cooling system
	;		 CoolVent W/CFM		// 
	;		 ReturnRegister		// If WHF the conditoned zone where it is located
	;		 
	;		 Calculate
	;			Relief = CoolVentCFM/375  // The minimum size of the attic vents required to let the WHF flow out of the attic
	;			
	;		If WHF  		// Whole House Fan
	;		   Calculate
	;		   	Relief = CoolVentCFM/375  // The minimum size of the attic vent required for this fan to let the WHF flow out of the attic
	;		   Write Airnet Objects to CSE Input
	;		   	       	IZXFER (ResZn)WHF izNVTYPE=AirNetIZFan izZN1=(ResZn) izVFmin=0. izVFMax=-CoolVentCFM*Win_hr izFanVfDs=CoolVentCFM izZn2=Attic izFanElecPwr=CoolVentWperCFM izFanMtr=CoolVentMtr
	;
	;  SAC 9/19/12 - now dividing user-specified CoolingVent by 4 per Bruce's bug rpt 027

   ; SAC 5/2/13 - new mechanism based on zone again (w/ original Zone version commented out)
	"Create ResZn:ClVentAirNetIZXFERs[1] (WHF)"			ResZn:ClVentAirNetIZXFERs[1]					= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-WHF2Atc" )  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izNVType"			ResZn:ClVentAirNetIZXFERs[1]:izNVType		= {	7 	}	; AIRNETIZFAN  - Fan between two zones
	"Set ResZn:ClVentAirNetIZXFERs[1]:izZn1"				ResZn:ClVentAirNetIZXFERs[1]:izZn1			= {	CSE_ZONE  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izZn2"				ResZn:ClVentAirNetIZXFERs[1]:izZn2			= {	MaxClVentableAttic:CSE_ZONE  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izVFmin"				ResZn:ClVentAirNetIZXFERs[1]:izVFmin			= {	0         }

; SAC 12/31/15 - added reference to new ResProj:ClVentAirFlowMult used to reduce WHF CFM for reduced attic relief vent free area (tic #596)
; SAC 11/5/17 - added effect of ClVentVerified (ClVentVerifMult) for 2019 analysis (tic #920)
	"Set ResZn:ClVentAirNetIZXFERs[1]:izVFmax_x"			ResZn:ClVentAirNetIZXFERs[1]:izVFmax_x 		=        ; SAC 2/13/20 - installed mod for 2019.2.0+ (tic #1175)     ; enable 19.2.0+ mod for 2019.1.3 - SAC 7/15/20
      {  if (IfValidAnd( AnalysisVersion >= 190103 ))
         then  Format( "%.1f * WINDOWVENTAVAIL * FANVENTAVAIL * (@ZONE[%c%s%c].tzls - $tDbOSh > 3)",
                           ((ClVentAirFlow[1] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
                           T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) * -1), 34, CSE_ZONE:Name, 34 )
         else  Format( "%.1f * WINDOWVENTAVAIL * FANVENTAVAIL", ((ClVentAirFlow[1] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
                           T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) * -1) )  endif  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanVfDs"			ResZn:ClVentAirNetIZXFERs[1]:izFanVfDs 		= {
         ClVentAirFlow[1] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
                     T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }

	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanElecPwr"		ResZn:ClVentAirNetIZXFERs[1]:izFanElecPwr	= {	ClVentPower[1] / ClVentAirFlow[1]   }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanMtr"			ResZn:ClVentAirNetIZXFERs[1]:izFanMtr  		= {	CSE_ElecMETER  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanEndUse"		ResZn:ClVentAirNetIZXFERs[1]:izFanEndUse	= {	"FANC"          }
	   ; SAC 2/13/20 - rolled BACK following mod which caused confusion in testing when revising WHF modeling for 2019.2.0+ (tic #175)
	   ;{  if (IfValidAnd( ResProj:EnableResearchMode > 0.5 ) .AND. GlobalStatus( ResProj:ClVentFanAvailExp ) > 0) then  "FAN"     ; SAC 1/10/20 - TEMPORARY logic to enable quicker ID of WHF energy use during testing (tic #1175)
	   ;   else  "FANC"  endif  }
END
;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Zone_WholeHouseFan_ToOutside" 0 0 0 1
;*************************************************************************
   ; SAC 1/20/19 - revisions to facilitate WHF to Outside (via ResZn:ClVentToOutside) (tic #1040)
	"Create ResZn:ClVentAirNetIZXFERs[1] (WHF)"			ResZn:ClVentAirNetIZXFERs[1]					= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-WHF2Out" )  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izNVType"			ResZn:ClVentAirNetIZXFERs[1]:izNVType		= {	6  }   ; AIRNETEXTFAN - Fan from exterior to zone
	"Set ResZn:ClVentAirNetIZXFERs[1]:izZn1"				ResZn:ClVentAirNetIZXFERs[1]:izZn1			= {	CSE_ZONE   }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izZn2"				ResZn:ClVentAirNetIZXFERs[1]:izZn2			= {	UNDEFINED  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izVFmin"				ResZn:ClVentAirNetIZXFERs[1]:izVFmin			= {	0          }

; SAC 12/31/15 - added reference to new ResProj:ClVentAirFlowMult used to reduce WHF CFM for reduced attic relief vent free area (tic #596)
; SAC 11/5/17 - added effect of ClVentVerified (ClVentVerifMult) for 2019 analysis (tic #920)
	"Set ResZn:ClVentAirNetIZXFERs[1]:izVFmax_x"			ResZn:ClVentAirNetIZXFERs[1]:izVFmax_x 		=        ; SAC 2/13/20 - installed mod for 2019.2.0+ (tic #1175)     ; enable 19.2.0+ mod for 2019.1.3 - SAC 7/15/20
      {  if (IfValidAnd( AnalysisVersion >= 190103 ))
         then  Format( "%.1f * WINDOWVENTAVAIL * FANVENTAVAIL * (@ZONE[%c%s%c].tzls - $tDbOSh > 3)", 
                           ((ClVentAirFlow[2] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
                           T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) * -1), 34, CSE_ZONE:Name, 34 )
         else  Format( "%.1f * WINDOWVENTAVAIL * FANVENTAVAIL", ((ClVentAirFlow[2] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
                           T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) * -1) )  endif  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanVfDs"			ResZn:ClVentAirNetIZXFERs[1]:izFanVfDs 		= {
         ClVentAirFlow[2] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
                     T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }

	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanElecPwr"		ResZn:ClVentAirNetIZXFERs[1]:izFanElecPwr	= {	ClVentPower[2] / ClVentAirFlow[2]   }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanMtr"			ResZn:ClVentAirNetIZXFERs[1]:izFanMtr  		= {	CSE_ElecMETER  }
	"Set ResZn:ClVentAirNetIZXFERs[1]:izFanEndUse"		ResZn:ClVentAirNetIZXFERs[1]:izFanEndUse	= {	"FANC"          }
	   ; SAC 2/13/20 - rolled BACK following mod which caused confusion in testing when revising WHF modeling for 2019.2.0+ (tic #175)
	   ;{  if (IfValidAnd( ResProj:EnableResearchMode > 0.5 ) .AND. GlobalStatus( ResProj:ClVentFanAvailExp ) > 0) then  "FAN"     ; SAC 1/10/20 - TEMPORARY logic to enable quicker ID of WHF energy use during testing (tic #1175)
	   ;   else  "FANC"  endif  }
END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Zone_WholeHouseFan_OutsideDamper" 0 0 0 1
;*************************************************************************
   "Create ResZn:ClVentAirNetIZXFERs[3] (WHF outside damper)"      ResZn:ClVentAirNetIZXFERs[3]  =
      {  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-WHFdamper" )  }
   "Set ResZn:ClVentAirNetIZXFERs[3]:izNVType"   ResZn:ClVentAirNetIZXFERs[3]:izNVType  = {  4  }       ; AIRNETEXT - Single opening to ambient
   "Set ResZn:ClVentAirNetIZXFERs[3]:izZn1"      ResZn:ClVentAirNetIZXFERs[3]:izZn1     = {  CSE_ZONE  }
   "Set ResZn:ClVentAirNetIZXFERs[3]:izALo"      ResZn:ClVentAirNetIZXFERs[3]:izALo     = {
         0.10  }  ; constant??
         ; ((ResProj:BldgELA_CeilSF *ClVentableClgArea* 1.45) + 0.11 )* ClVentableArea / ResZn:ClVentableClgArea  }
   "Set ResZn:ClVentAirNetIZXFERs[3]:izHD"       ResZn:ClVentAirNetIZXFERs[3]:izHD      = {  ResZn:ZoneTopZ  }
   "Set ResZn:ClVentAirNetIZXFERs[3]:izNVEff"    ResZn:ClVentAirNetIZXFERs[3]:izNVEff   = {  1  }
   "Set ResZn:ClVentAirNetIZXFERs[3]:izExp"      ResZn:ClVentAirNetIZXFERs[3]:izExp     = {  0.65  }
   "Set ResZn:ClVentAirNetIZXFERs[3]:izAFCat"    ResZn:ClVentAirNetIZXFERs[3]:izAFCat   = {  "VentEx"  }    ; SAC 09/17/20 (tic #1247)
END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Zone_ExtWall" 0 0 0 1
;*************************************************************************
	"Create ResZn:AirNetIZXFERs[1] - WlLU"		ResZn:AirNetIZXFERs[1]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfLU", "Default_ZoneIZXFER" )  }
	"Create ResZn:AirNetIZXFERs[2] - WlLS"		ResZn:AirNetIZXFERs[2]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfLS", "Default_ZoneIZXFER" )  }
	"Create ResZn:AirNetIZXFERs[3] - WlLD"		ResZn:AirNetIZXFERs[3]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfLD", "Default_ZoneIZXFER" )  }
	"Create ResZn:AirNetIZXFERs[4] - WlHU"		ResZn:AirNetIZXFERs[4]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfHU", "Default_ZoneIZXFER" )  }
	"Create ResZn:AirNetIZXFERs[5] - WlHS"		ResZn:AirNetIZXFERs[5]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfHS", "Default_ZoneIZXFER" )  }
	"Create ResZn:AirNetIZXFERs[6] - WlHD"		ResZn:AirNetIZXFERs[6]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfHD", "Default_ZoneIZXFER" )  }

	"Set ResZn:AirNetIZXFERs[1]:izZn1 - WlLU"		ResZn:AirNetIZXFERs[1]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:AirNetIZXFERs[2]:izZn1 - WlLS"		ResZn:AirNetIZXFERs[2]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:AirNetIZXFERs[3]:izZn1 - WlLD"		ResZn:AirNetIZXFERs[3]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:AirNetIZXFERs[4]:izZn1 - WlHU"		ResZn:AirNetIZXFERs[4]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:AirNetIZXFERs[5]:izZn1 - WlHS"		ResZn:AirNetIZXFERs[5]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:AirNetIZXFERs[6]:izZn1 - WlHD"		ResZn:AirNetIZXFERs[6]:izZn1	= {	Local( CSE_ZONE )  }

	"Set ResZn:AirNetIZXFERs[1]:izALo - WlLU"		ResZn:AirNetIZXFERs[1]:izALo	= {	Local( WallHoleSize )      }
	"Set ResZn:AirNetIZXFERs[2]:izALo - WlLS"		ResZn:AirNetIZXFERs[2]:izALo	= {	Local( WallHoleSize ) * 2  }
	"Set ResZn:AirNetIZXFERs[3]:izALo - WlLD"		ResZn:AirNetIZXFERs[3]:izALo	= {	Local( WallHoleSize )      }
	"Set ResZn:AirNetIZXFERs[4]:izALo - WlHU"		ResZn:AirNetIZXFERs[4]:izALo	= {	Local( WallHoleSize )      }
	"Set ResZn:AirNetIZXFERs[5]:izALo - WlHS"		ResZn:AirNetIZXFERs[5]:izALo	= {	Local( WallHoleSize ) * 2  }
	"Set ResZn:AirNetIZXFERs[6]:izALo - WlHD"		ResZn:AirNetIZXFERs[6]:izALo	= {	Local( WallHoleSize )      }

; SAC 11/18/14 - allow negative airnet hole positions
	"Set ResZn:AirNetIZXFERs[1]:izHD - WlLU"		ResZn:AirNetIZXFERs[1]:izHD		= {	Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight )) )  }
	"Set ResZn:AirNetIZXFERs[2]:izHD - WlLS"		ResZn:AirNetIZXFERs[2]:izHD		= {	Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight )) )  }
	"Set ResZn:AirNetIZXFERs[3]:izHD - WlLD"		ResZn:AirNetIZXFERs[3]:izHD		= {	Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight )) )  }
	"Set ResZn:AirNetIZXFERs[4]:izHD - WlHU"		ResZn:AirNetIZXFERs[4]:izHD		= {	Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight )) )  }
	"Set ResZn:AirNetIZXFERs[5]:izHD - WlHS"		ResZn:AirNetIZXFERs[5]:izHD		= {	Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight )) )  }
	"Set ResZn:AirNetIZXFERs[6]:izHD - WlHD"		ResZn:AirNetIZXFERs[6]:izHD		= {	Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight )) )  }

;	"Set ResZn:AirNetIZXFERs[1]:izCpr - WlLU"		ResZn:AirNetIZXFERs[1]:izCpr	= {	 0.6   }
	"Set ResZn:AirNetIZXFERs[2]:izCpr - WlLS"		ResZn:AirNetIZXFERs[2]:izCpr	= {	-0.65  }
	"Set ResZn:AirNetIZXFERs[3]:izCpr - WlLD"		ResZn:AirNetIZXFERs[3]:izCpr	= {	-0.3   }
;	"Set ResZn:AirNetIZXFERs[4]:izCpr - WlHU"		ResZn:AirNetIZXFERs[4]:izCpr	= {	 0.6   }
	"Set ResZn:AirNetIZXFERs[5]:izCpr - WlHS"		ResZn:AirNetIZXFERs[5]:izCpr	= {	-0.65  }
	"Set ResZn:AirNetIZXFERs[6]:izCpr - WlHD"		ResZn:AirNetIZXFERs[6]:izCpr	= {	-0.3   }
END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Zone_Windows_1Story" 0 0 0 1
;*************************************************************************
	"Set ResZn:WinHoleAreaExp[1]"		ResZn:WinHoleAreaExp[1]	= {	Format( "%.3f * WINDOWVENTAVAIL", (Local( WinVentArea ) / 16) )  }
	"Set ResZn:WinHoleAreaExp[2]"		ResZn:WinHoleAreaExp[2]	= {	Format( "%.3f * WINDOWVENTAVAIL", (Local( WinVentArea ) /  8) )  }

	"Create ResZn:WinAirNetIZXFERs[1] - WnLU"			ResZn:WinAirNetIZXFERs[1]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVLU", "Default_ZoneWinIZXFER" )  }
	"Create ResZn:WinAirNetIZXFERs[2] - WnLS"			ResZn:WinAirNetIZXFERs[2]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVLS", "Default_ZoneWinIZXFER" )  }
	"Create ResZn:WinAirNetIZXFERs[3] - WnLD"			ResZn:WinAirNetIZXFERs[3]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVLD", "Default_ZoneWinIZXFER" )  }
	"Create ResZn:WinAirNetIZXFERs[4] - WnHU"			ResZn:WinAirNetIZXFERs[4]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVHU", "Default_ZoneWinIZXFER" )  }
	"Create ResZn:WinAirNetIZXFERs[5] - WnHS"			ResZn:WinAirNetIZXFERs[5]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVHS", "Default_ZoneWinIZXFER" )  }
	"Create ResZn:WinAirNetIZXFERs[6] - WnHD"			ResZn:WinAirNetIZXFERs[6]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVHD", "Default_ZoneWinIZXFER" )  }

	"Set ResZn:WinAirNetIZXFERs[1]:izZn1 - WnLU"		ResZn:WinAirNetIZXFERs[1]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:WinAirNetIZXFERs[2]:izZn1 - WnLS"		ResZn:WinAirNetIZXFERs[2]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:WinAirNetIZXFERs[3]:izZn1 - WnLD"		ResZn:WinAirNetIZXFERs[3]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:WinAirNetIZXFERs[4]:izZn1 - WnHU"		ResZn:WinAirNetIZXFERs[4]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:WinAirNetIZXFERs[5]:izZn1 - WnHS"		ResZn:WinAirNetIZXFERs[5]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResZn:WinAirNetIZXFERs[6]:izZn1 - WnHD"		ResZn:WinAirNetIZXFERs[6]:izZn1	= {	Local( CSE_ZONE )  }

	"Set ResZn:WinAirNetIZXFERs[1]:izAHi_x - WnLU"	ResZn:WinAirNetIZXFERs[1]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
	"Set ResZn:WinAirNetIZXFERs[2]:izAHi_x - WnLS"	ResZn:WinAirNetIZXFERs[2]:izAHi_x	= {	Local( WinHoleAreaExp[2] )  }
	"Set ResZn:WinAirNetIZXFERs[3]:izAHi_x - WnLD"	ResZn:WinAirNetIZXFERs[3]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
	"Set ResZn:WinAirNetIZXFERs[4]:izAHi_x - WnHU"	ResZn:WinAirNetIZXFERs[4]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
	"Set ResZn:WinAirNetIZXFERs[5]:izAHi_x - WnHS"	ResZn:WinAirNetIZXFERs[5]:izAHi_x	= {	Local( WinHoleAreaExp[2] )  }
	"Set ResZn:WinAirNetIZXFERs[6]:izAHi_x - WnHD"	ResZn:WinAirNetIZXFERs[6]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }

;	"Set ResZn:WinAirNetIZXFERs[1]:izHD - WnLU"		ResZn:WinAirNetIZXFERs[1]:izHD		= {	max( 0.1, Local( WinHHTopUse ) - (3 + Local( WinVentHtDiff )) )  }
;	"Set ResZn:WinAirNetIZXFERs[2]:izHD - WnLS"		ResZn:WinAirNetIZXFERs[2]:izHD		= {	max( 0.1, Local( WinHHTopUse ) - (3 + Local( WinVentHtDiff )) )  }
;	"Set ResZn:WinAirNetIZXFERs[3]:izHD - WnLD"		ResZn:WinAirNetIZXFERs[3]:izHD		= {	max( 0.1, Local( WinHHTopUse ) - (3 + Local( WinVentHtDiff )) )  }
; SAC 7/24/14 - switched to second element of WinHHTopUse[] to address SFam vs. MFam differences
; SAC 11/18/14 - allow negative airnet hole positions
	"Set ResZn:WinAirNetIZXFERs[1]:izHD - WnLU"		ResZn:WinAirNetIZXFERs[1]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 3                                  ; max( 0.1, Local( WinHHTopUse[2] ) - 3 )                   
																														else	Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1]   endif  }    ; max( 0.1, Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1] )
	"Set ResZn:WinAirNetIZXFERs[2]:izHD - WnLS"		ResZn:WinAirNetIZXFERs[2]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 3 
																														else	Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1]   endif  }
	"Set ResZn:WinAirNetIZXFERs[3]:izHD - WnLD"		ResZn:WinAirNetIZXFERs[3]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 3 
																														else	Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1]   endif  }
	"Set ResZn:WinAirNetIZXFERs[4]:izHD - WnHU"		ResZn:WinAirNetIZXFERs[4]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 1 
																														else	Local( WinHHTopUse[2] ) - 1 + WinVentHtDiff[2]   endif  }
	"Set ResZn:WinAirNetIZXFERs[5]:izHD - WnHS"		ResZn:WinAirNetIZXFERs[5]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 1 
																														else	Local( WinHHTopUse[2] ) - 1 + WinVentHtDiff[2]   endif  }
	"Set ResZn:WinAirNetIZXFERs[6]:izHD - WnHD"		ResZn:WinAirNetIZXFERs[6]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 1 
																														else	Local( WinHHTopUse[2] ) - 1 + WinVentHtDiff[2]   endif  }

	"Set ResZn:WinAirNetIZXFERs[1]:izCpr - WnLU"		ResZn:WinAirNetIZXFERs[1]:izCpr	= {	 0.6  * NatVentWindPresCoefMult  }     ; SAC 7/13/20
	"Set ResZn:WinAirNetIZXFERs[2]:izCpr - WnLS"		ResZn:WinAirNetIZXFERs[2]:izCpr	= {	-0.65 * NatVentWindPresCoefMult  }
	"Set ResZn:WinAirNetIZXFERs[3]:izCpr - WnLD"		ResZn:WinAirNetIZXFERs[3]:izCpr	= {	-0.3  * NatVentWindPresCoefMult  }
	"Set ResZn:WinAirNetIZXFERs[4]:izCpr - WnHU"		ResZn:WinAirNetIZXFERs[4]:izCpr	= {	 0.6  * NatVentWindPresCoefMult  }
	"Set ResZn:WinAirNetIZXFERs[5]:izCpr - WnHS"		ResZn:WinAirNetIZXFERs[5]:izCpr	= {	-0.65 * NatVentWindPresCoefMult  }
	"Set ResZn:WinAirNetIZXFERs[6]:izCpr - WnHD"		ResZn:WinAirNetIZXFERs[6]:izCpr	= {	-0.3  * NatVentWindPresCoefMult  }
END

; SAC 7/24/14 - revised logic to ALWAYS generate window AirNet objects using the single story logic (hence removal of the following rulelist)
;		;*************************************************************************
;		RULELIST "SimPrep_CSE_AirNet_Zone_Windows_MultiStory" 0 0 0 1
;		;*************************************************************************
;			"Set ResZn:WinHoleAreaExp[1]"		ResZn:WinHoleAreaExp[1]	= {	Format( "%.3f * WINDOWVENTAVAIL", (WinVentArea / (8 * NumStories)) )  }
;			"Set ResZn:WinHoleAreaExp[2]"		ResZn:WinHoleAreaExp[2]	= {	Format( "%.3f * WINDOWVENTAVAIL", (WinVentArea / (4 * NumStories)) )  }
;		
;			"Create ResZn:WinAirNetIZXFERs[1] - Wn1U"			ResZn:WinAirNetIZXFERs[1]			= {	CreateComp( cseIZXFER, Local( Name ) + "-NV1U", "Default_ZoneWinIZXFER" )  }
;			"Create ResZn:WinAirNetIZXFERs[2] - Wn1S"			ResZn:WinAirNetIZXFERs[2]			= {	CreateComp( cseIZXFER, Local( Name ) + "-NV1S", "Default_ZoneWinIZXFER" )  }
;			"Create ResZn:WinAirNetIZXFERs[3] - Wn1D"			ResZn:WinAirNetIZXFERs[3]			= {	CreateComp( cseIZXFER, Local( Name ) + "-NV1D", "Default_ZoneWinIZXFER" )  }
;			"Create ResZn:WinAirNetIZXFERs[4] - Wn2U"			ResZn:WinAirNetIZXFERs[4]			= {	CreateComp( cseIZXFER, Local( Name ) + "-NV2U", "Default_ZoneWinIZXFER" )  }
;			"Create ResZn:WinAirNetIZXFERs[5] - Wn2S"			ResZn:WinAirNetIZXFERs[5]			= {	CreateComp( cseIZXFER, Local( Name ) + "-NV2S", "Default_ZoneWinIZXFER" )  }
;			"Create ResZn:WinAirNetIZXFERs[6] - Wn2D"			ResZn:WinAirNetIZXFERs[6]			= {	CreateComp( cseIZXFER, Local( Name ) + "-NV2D", "Default_ZoneWinIZXFER" )  }
;			"Create ResZn:WinAirNetIZXFERs[7] - Wn3U"			ResZn:WinAirNetIZXFERs[7]			= {	if (NumStories < 2.5) then  UNCHANGED
;																																else	CreateComp( cseIZXFER, Local( Name ) + "-NV3U", "Default_ZoneWinIZXFER" )  endif  }
;			"Create ResZn:WinAirNetIZXFERs[8] - Wn3S"			ResZn:WinAirNetIZXFERs[8]			= {	if (NumStories < 2.5) then  UNCHANGED
;																																else	CreateComp( cseIZXFER, Local( Name ) + "-NV3S", "Default_ZoneWinIZXFER" )  endif  }
;			"Create ResZn:WinAirNetIZXFERs[9] - Wn3D"			ResZn:WinAirNetIZXFERs[9]			= {	if (NumStories < 2.5) then  UNCHANGED
;																																else	CreateComp( cseIZXFER, Local( Name ) + "-NV3D", "Default_ZoneWinIZXFER" )  endif  }
;		
;			"Set ResZn:WinAirNetIZXFERs[1]:izZn1 - Wn1U"		ResZn:WinAirNetIZXFERs[1]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[2]:izZn1 - Wn1S"		ResZn:WinAirNetIZXFERs[2]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[3]:izZn1 - Wn1D"		ResZn:WinAirNetIZXFERs[3]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[4]:izZn1 - Wn2U"		ResZn:WinAirNetIZXFERs[4]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[5]:izZn1 - Wn2S"		ResZn:WinAirNetIZXFERs[5]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[6]:izZn1 - Wn2D"		ResZn:WinAirNetIZXFERs[6]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[7]:izZn1 - Wn3U"		ResZn:WinAirNetIZXFERs[7]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[8]:izZn1 - Wn3S"		ResZn:WinAirNetIZXFERs[8]:izZn1	= {	Local( CSE_ZONE )  }
;			"Set ResZn:WinAirNetIZXFERs[9]:izZn1 - Wn3D"		ResZn:WinAirNetIZXFERs[9]:izZn1	= {	Local( CSE_ZONE )  }
;		
;			"Set ResZn:WinAirNetIZXFERs[1]:izAHi_x - Wn1U"	ResZn:WinAirNetIZXFERs[1]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
;			"Set ResZn:WinAirNetIZXFERs[2]:izAHi_x - Wn1S"	ResZn:WinAirNetIZXFERs[2]:izAHi_x	= {	Local( WinHoleAreaExp[2] )  }
;			"Set ResZn:WinAirNetIZXFERs[3]:izAHi_x - Wn1D"	ResZn:WinAirNetIZXFERs[3]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
;			"Set ResZn:WinAirNetIZXFERs[4]:izAHi_x - Wn2U"	ResZn:WinAirNetIZXFERs[4]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
;			"Set ResZn:WinAirNetIZXFERs[5]:izAHi_x - Wn2S"	ResZn:WinAirNetIZXFERs[5]:izAHi_x	= {	Local( WinHoleAreaExp[2] )  }
;			"Set ResZn:WinAirNetIZXFERs[6]:izAHi_x - Wn2D"	ResZn:WinAirNetIZXFERs[6]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
;			"Set ResZn:WinAirNetIZXFERs[7]:izAHi_x - Wn3U"	ResZn:WinAirNetIZXFERs[7]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
;			"Set ResZn:WinAirNetIZXFERs[8]:izAHi_x - Wn3S"	ResZn:WinAirNetIZXFERs[8]:izAHi_x	= {	Local( WinHoleAreaExp[2] )  }
;			"Set ResZn:WinAirNetIZXFERs[9]:izAHi_x - Wn3D"	ResZn:WinAirNetIZXFERs[9]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
;		
;			"Set ResZn:WinAirNetIZXFERs[1]:izHD - Wn1U"		ResZn:WinAirNetIZXFERs[1]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[1] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[2]:izHD - Wn1S"		ResZn:WinAirNetIZXFERs[2]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[1] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[3]:izHD - Wn1D"		ResZn:WinAirNetIZXFERs[3]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[1] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[4]:izHD - Wn2U"		ResZn:WinAirNetIZXFERs[4]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 + FloorHeight )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[2] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[5]:izHD - Wn2S"		ResZn:WinAirNetIZXFERs[5]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 + FloorHeight )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[2] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[6]:izHD - Wn2D"		ResZn:WinAirNetIZXFERs[6]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 + FloorHeight )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[2] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[7]:izHD - Wn3U"		ResZn:WinAirNetIZXFERs[7]:izHD		= {	if (WinVentHtDiff[3] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 + (2 * FloorHeight) )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[3] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[8]:izHD - Wn3S"		ResZn:WinAirNetIZXFERs[8]:izHD		= {	if (WinVentHtDiff[3] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 + (2 * FloorHeight) )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[3] )  endif  }
;			"Set ResZn:WinAirNetIZXFERs[9]:izHD - Wn3D"		ResZn:WinAirNetIZXFERs[9]:izHD		= {	if (WinVentHtDiff[3] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
;																																then	max( 0.1, Local( WinHHTopUse ) - 2 + (2 * FloorHeight) )
;																																else	max( 0.1, Local( WinHHTopUse ) - 2 + WinVentHtDiff[3] )  endif  }
;		
;		;	"Set ResZn:WinAirNetIZXFERs[1]:izCpr - Wn1U"		ResZn:WinAirNetIZXFERs[1]:izCpr	= {	 0.6   }
;			"Set ResZn:WinAirNetIZXFERs[2]:izCpr - Wn1S"		ResZn:WinAirNetIZXFERs[2]:izCpr	= {	-0.65  }
;			"Set ResZn:WinAirNetIZXFERs[3]:izCpr - Wn1D"		ResZn:WinAirNetIZXFERs[3]:izCpr	= {	-0.3   }
;		;	"Set ResZn:WinAirNetIZXFERs[4]:izCpr - Wn2U"		ResZn:WinAirNetIZXFERs[4]:izCpr	= {	 0.6   }
;			"Set ResZn:WinAirNetIZXFERs[5]:izCpr - Wn2S"		ResZn:WinAirNetIZXFERs[5]:izCpr	= {	-0.65  }
;			"Set ResZn:WinAirNetIZXFERs[6]:izCpr - Wn2D"		ResZn:WinAirNetIZXFERs[6]:izCpr	= {	-0.3   }
;		;	"Set ResZn:WinAirNetIZXFERs[7]:izCpr - Wn3U"		ResZn:WinAirNetIZXFERs[7]:izCpr	= {	 0.6   }
;			"Set ResZn:WinAirNetIZXFERs[8]:izCpr - Wn3S"		ResZn:WinAirNetIZXFERs[8]:izCpr	= {	-0.65  }
;			"Set ResZn:WinAirNetIZXFERs[9]:izCpr - Wn3D"		ResZn:WinAirNetIZXFERs[9]:izCpr	= {	-0.3   }
;		END

;************************************************************************* - SAC 11/30/20
RULELIST "SimPrep_CSE_AirNet_ZoneUncondZone_ByZone" 0 0 0 1
;*************************************************************************
	; for garage wall
	"Set ResZn:AdjUncondZnWallArea"						ResZn:AdjUncondZnWallArea		=	{	SumChildren( ResIntWall:ParCndZnAdjUZnArea)
																													+ SumRevRef( ResIntWall:Outside, ResIntWall:ParUZnAdjCndZnArea)	}
	"Set ResZn:GrgWallH"										ResZn:GrgWallH						=	{	Global(ResProj:BldgELA_GarageSF) * AdjUncondZnWallArea / 2.		}
	"Set ResZn:GrgWallTopZ"									ResZn:GrgWallTopZ					=	{	min( Local(Top), Local(Top) )						}	;Global(ResGarage:Top)
	"Set ResZn:GrgWallBotZ"									ResZn:GrgWallBotZ					=	{	min( Local(Bottom), Local(Bottom) )					}	;Global(ResGarage:Bottom)
	"Set ResZn:GrgWallHt"										ResZn:GrgWallHt						=	{	Local(GrgWallTopZ) - Local(GrgWallBotZ)						}
	"Set ResZn:GrgWallHoleHiZ"								ResZn:GrgWallHoleHiZ				=	{	Local(GrgWallBotZ) + (0.75 * Local(GrgWallHt))				}
	"Set ResZn:GrgWallHoleLoZ"								ResZn:GrgWallHoleLoZ				=	{	Local(GrgWallBotZ) + (0.25 * Local(GrgWallHt))				}

	"Create ResZn:GrgWallAirNetIZXFERs[1]"				ResZn:GrgWallAirNetIZXFERs[1]	=	{	if ( Local(GrgWallH) > 0. ) 
																															then CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-xGarageH")
																															else UNDEFINED
																															endif  }
	"Set ResZn:GrgWallAirNetIZXFERs[1]:izNVType"			ResZn:GrgWallAirNetIZXFERs[1]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
	"Set ResZn:GrgWallAirNetIZXFERs[1]:izZn1"				ResZn:GrgWallAirNetIZXFERs[1]:izZn1		=	{	Local( CSE_ZONE )  }
	"Set ResZn:GrgWallAirNetIZXFERs[1]:izALo"				ResZn:GrgWallAirNetIZXFERs[1]:izALo		=	{	Local( GrgWallH )  }
	"Set ResZn:GrgWallAirNetIZXFERs[1]:izHD"				ResZn:GrgWallAirNetIZXFERs[1]:izHD   	=	{	Local( GrgWallHoleHiZ )  }
	"Set ResZn:GrgWallAirNetIZXFERs[1]:izNVEff"			ResZn:GrgWallAirNetIZXFERs[1]:izNVEff	=	{	1.0  }
	"Set ResZn:GrgWallAirNetIZXFERs[1]:izExp"				ResZn:GrgWallAirNetIZXFERs[1]:izExp  	=	{	0.65  }
	"Set ResZn:GrgWallAirNetIZXFERs[1]:izZN2"				ResZn:GrgWallAirNetIZXFERs[1]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }
																					
	"Create ResZn:GrgWallAirNetIZXFERs[2]"					ResZn:GrgWallAirNetIZXFERs[2]		=	{	if ( Local(GrgWallH) > 0. ) 
																															then CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-xGarageL")
																															else UNDEFINED
																															endif  }
	"Set ResZn:GrgWallAirNetIZXFERs[2]:izNVType"			ResZn:GrgWallAirNetIZXFERs[2]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
	"Set ResZn:GrgWallAirNetIZXFERs[2]:izZn1"				ResZn:GrgWallAirNetIZXFERs[2]:izZn1		=	{	Local( CSE_ZONE )  }
	"Set ResZn:GrgWallAirNetIZXFERs[2]:izALo"				ResZn:GrgWallAirNetIZXFERs[2]:izALo		=	{	Local( GrgWallH )  }
	"Set ResZn:GrgWallAirNetIZXFERs[2]:izHD"				ResZn:GrgWallAirNetIZXFERs[2]:izHD   	=	{	Local( GrgWallHoleLoZ )  }
	"Set ResZn:GrgWallAirNetIZXFERs[2]:izNVEff"			ResZn:GrgWallAirNetIZXFERs[2]:izNVEff	=	{	1.0  }
	"Set ResZn:GrgWallAirNetIZXFERs[2]:izExp"				ResZn:GrgWallAirNetIZXFERs[2]:izExp  	=	{	0.65  }
	"Set ResZn:GrgWallAirNetIZXFERs[2]:izZN2"				ResZn:GrgWallAirNetIZXFERs[2]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }
END
;************************************************************************* - SAC 11/30/20
RULELIST "SimPrep_CSE_AirNet_ZoneUncondZone_ByOtherZone" 0 0 0 1
;*************************************************************************
	; for garage wall
	"Set ResOtherZn:AdjUncondZnWallArea"							ResOtherZn:AdjUncondZnWallArea			=	{	SumChildren( ResIntWall:ParCndOZnAdjUZnArea)
																													+ SumRevRef( ResIntWall:Outside, ResIntWall:ParUZnAdjCndOZnArea)	}
	"Set ResOtherZn:GrgWallH"										ResOtherZn:GrgWallH						=	{	Global(ResProj:BldgELA_GarageSF) * AdjUncondZnWallArea / 2.		}
	"Set ResOtherZn:GrgWallTopZ"									ResOtherZn:GrgWallTopZ					=	{	min( Local(Top), Local(Top) )						}	;Global(ResGarage:Top)
	"Set ResOtherZn:GrgWallBotZ"									ResOtherZn:GrgWallBotZ					=	{	min( Local(Bottom), Local(Bottom) )					}	;Global(ResGarage:Bottom)
	"Set ResOtherZn:GrgWallHt"										ResOtherZn:GrgWallHt						=	{	Local(GrgWallTopZ) - Local(GrgWallBotZ)						}
	"Set ResOtherZn:GrgWallHoleHiZ"								ResOtherZn:GrgWallHoleHiZ				=	{	Local(GrgWallBotZ) + (0.75 * Local(GrgWallHt))				}
	"Set ResOtherZn:GrgWallHoleLoZ"								ResOtherZn:GrgWallHoleLoZ				=	{	Local(GrgWallBotZ) + (0.25 * Local(GrgWallHt))				}

	"Create ResOtherZn:GrgWallAirNetIZXFERs[1]"				ResOtherZn:GrgWallAirNetIZXFERs[1]		=	{	if ( Local(GrgWallH) > 0. ) 
																															then CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-xGarageH")
																															else UNDEFINED
																															endif  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVType"		ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izZn1"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izZn1		=	{	Local( CSE_ZONE )  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izALo"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izALo		=	{	Local( GrgWallH )  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izHD"				ResOtherZn:GrgWallAirNetIZXFERs[1]:izHD   	=	{	Local( GrgWallHoleHiZ )  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVEff"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVEff	=	{	1.0  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izExp"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izExp  	=	{	0.65  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izZN2"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }
																					
	"Create ResOtherZn:GrgWallAirNetIZXFERs[2]"				ResOtherZn:GrgWallAirNetIZXFERs[2]		=	{	if ( Local(GrgWallH) > 0. ) 
																															then CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-xGarageL")
																															else UNDEFINED
																															endif  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVType"		ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izZn1"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izZn1		=	{	Local( CSE_ZONE )  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izALo"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izALo		=	{	Local( GrgWallH )  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izHD"				ResOtherZn:GrgWallAirNetIZXFERs[2]:izHD   	=	{	Local( GrgWallHoleLoZ )  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVEff"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVEff	=	{	1.0  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izExp"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izExp  	=	{	0.65  }
	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izZN2"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }
END
;************************************************************************* - SAC 11/30/20
RULELIST "SimPrep_CSE_AirNet_ZoneUncondZone_ByWall" 0 0 0 1
;*************************************************************************
   "Create ResIntWall:CndUCndAirNetIZXFERs[1]-H IZXFER"  ResIntWall:CndUCndAirNetIZXFERs[1] =
      {  if (ParentCompAssigned( CSE_ZONE ) > 0 .AND. LocalCompAssigned( Outside:CSE_ZONE ) > 0 .AND.
             (ParCndZnAdjUZnArea > 0 .OR. ParCndOZnAdjUZnArea > 0 .OR. ParUZnAdjCndZnArea > 0 .OR. ParUZnAdjCndOZnArea > 0))
         then  CreateComp( cseIZXFER, substr( Name, 0, 42 ) + "-xCndUCndH")
         else  UNDEFINED  endif  }

   "Set ResIntWall:CndUCndAirNetIZXFERs[1]:izNVType"     ResIntWall:CndUCndAirNetIZXFERs[1]:izNVType  =  {  3  }      ; AIRNETIZ - Single opening to another zone
   "Set ResIntWall:CndUCndAirNetIZXFERs[1]:izZn1"        ResIntWall:CndUCndAirNetIZXFERs[1]:izZn1     =  {  Parent( CSE_ZONE )  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[1]:izZN2"        ResIntWall:CndUCndAirNetIZXFERs[1]:izZN2     =  {  Outside:CSE_ZONE    }
   "Set ResIntWall:CndUCndAirNetIZXFERs[1]:izALo"        ResIntWall:CndUCndAirNetIZXFERs[1]:izALo     =
      {  if (ParCndZnAdjUZnArea > 0 .OR. ParUZnAdjCndZnArea > 0)
         then  ResProj:BldgELA_GarageSF * (ParCndZnAdjUZnArea  + ParUZnAdjCndZnArea ) / 2.
         else  ResProj:BldgELA_GarageSF * (ParCndOZnAdjUZnArea + ParUZnAdjCndOZnArea) * ValidOr( ResProj:NResLeakageRatio, 1 ) / 2.
         endif  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[1]:izHD"         ResIntWall:CndUCndAirNetIZXFERs[1]:izHD      =  {  Parent( Bottom ) + (0.75 * max( 4, (Parent( Top ) - Parent( Bottom ))))  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[1]:izNVEff"      ResIntWall:CndUCndAirNetIZXFERs[1]:izNVEff   =  {  1.0  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[1]:izExp"        ResIntWall:CndUCndAirNetIZXFERs[1]:izExp     =  {  0.65  }

   "Create ResIntWall:CndUCndAirNetIZXFERs[2]-L IZXFER"  ResIntWall:CndUCndAirNetIZXFERs[2] =
      {  if (LocalCompAssigned( CndUCndAirNetIZXFERs[1] ) > 0)
         then  CreateComp( cseIZXFER, substr( Name, 0, 42 ) + "-xCndUCndL")
         else  UNDEFINED  endif  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[2]:izNVType"     ResIntWall:CndUCndAirNetIZXFERs[2]:izNVType  =  {  3  }      ; AIRNETIZ - Single opening to another zone
   "Set ResIntWall:CndUCndAirNetIZXFERs[2]:izZn1"        ResIntWall:CndUCndAirNetIZXFERs[2]:izZn1     =  {  Parent( CSE_ZONE )  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[2]:izZN2"        ResIntWall:CndUCndAirNetIZXFERs[2]:izZN2     =  {  Outside:CSE_ZONE    }
   "Set ResIntWall:CndUCndAirNetIZXFERs[2]:izALo"        ResIntWall:CndUCndAirNetIZXFERs[2]:izALo     =  {  CndUCndAirNetIZXFERs[1]:izALo  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[2]:izHD"         ResIntWall:CndUCndAirNetIZXFERs[2]:izHD      =  {  Parent( Bottom ) + (0.25 * max( 4, (Parent( Top ) - Parent( Bottom ))))  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[2]:izNVEff"      ResIntWall:CndUCndAirNetIZXFERs[2]:izNVEff   =  {  1.0  }
   "Set ResIntWall:CndUCndAirNetIZXFERs[2]:izExp"        ResIntWall:CndUCndAirNetIZXFERs[2]:izExp     =  {  0.65  }
END
;*************************************************************************


; SAC 9/19/19 - OtherZone (MFamProto)
;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_ResOtherZone" 0 0 0 1
;*************************************************************************

   "Set ResOtherZn:ELA_ACeil"				ResOtherZn:ELA_ACeil				= {   ResProj:BldgELA_CeilSF      * ValidOr( ResProj:NResLeakageRatio, 1 ) *  Local( ClgBlwAtticArea )  }
   "Set ResOtherZn:ELA_XCeil"				ResOtherZn:ELA_XCeil				= {   ResProj:BldgELA_CeilSF      * ValidOr( ResProj:NResLeakageRatio, 1 ) * (				0				  + Local( CathCeilingArea ))  }   ; AtticEdgeArea to be inserted for 0 here
   "Set ResOtherZn:ELA_XWall"				ResOtherZn:ELA_XWall				= {   ResProj:BldgELA_WallSF      * ValidOr( ResProj:NResLeakageRatio, 1 ) *  Local( ExtWallArea     )  }
   "Set ResOtherZn:ELA_Floor"				ResOtherZn:ELA_Floor				= {   ResProj:BldgELA_RaisedFlrSF * ValidOr( ResProj:NResLeakageRatio, 1 ) *  Local( ExtFloorArea    )  }

	"Set ResOtherZn:WallHoleSize"			ResOtherZn:WallHoleSize			= {	ELA_XWall * 1.45 / 8  }

	"Create & setup ResOtherZn:AirNetIZXFERs[1-6] iff WallHoleSize > 0"
			ResOtherZn:Action	 = {	if (WallHoleSize <= 0) then  UNCHANGED
									else  EvalRulelist( "SimPrep_CSE_AirNet_ResOtherZone_ExtWall", 1 )  endif  }

 ;-----------------------
 ; WINDOW AirNet
 ;-----------------------
;	"Set ResOtherZn:WinVentHtDiff"		ResOtherZn:WinVentHtDiff 	= {	2.0  }
	; Expression describing hourly window hole area (1=>WnLU/LD, 2=>WnLS)
	; from AirNetAlgorithm2.txt -- WnHole = 0.5*(WnVentArea/8.)*Win_hr*Windowmode // 1/8th in each hole,  ft2.  1/2 of nominal area to account for screens etc.  Hourly and seasonal availability 

				; 2.  Cooling Ventilation Setup:  4 types:  Windows only (all types have windows for some part of the year), Whole house fan, Smart Vent, NightBreeze
				;       Set up seasonal window control
				;  #if Smart Vent or NightBreeze //Windows are on in Winter, but off in summer when mechanical ventilation is on
				; 	   #redefine Windowmode select( @weather.taDbAvg07 >60., 0.00001,default 1.) 
				; 	   #define VentDiffMult  select( @top.tDbOSh < (@znRes[Single].prior.S.tAir-VentDiff), 1,default 0.000001) //Vent off if Tin-Vendiff > Tout  !! 110413  XXX
				; 	#Else  //everything but Econ and NightBreeeze Windows are on year round
				; 	   #reDefine Windowmode 1.       //Always available
				; 	   #Define VentDiff 0          // Differential.  No differential for windows or WWF  110309 BAW

; REMOVED Window (natural vent) airnet from OtherZone (NonRes) objects - SAC 7/13/20
;	"Create & setup ResOtherZn:WinAirNetIZXFERs[1-6] iff WinVentArea > 0"
;			ResOtherZn:Action	 = {	if (WinVentArea < 0.0001) then  UNCHANGED
;									else	EvalRulelist( "SimPrep_CSE_AirNet_ResOtherZone_Windows_1Story", 1 )  endif  }

; ;-----------------------
; ; AirNet for ceiling below attic in Conditioned OtherZone
; ;-----------------------

   "Setup airnet IZXFERs for CondZn/UncondZn vertical (wall) boundaries"   ResOtherZn:Action =
      {  if (ResProj:CSEVentAvailZonal) then  UNCHANGED
         else  EvalRulelist( "SimPrep_CSE_AirNet_ZoneUncondZone_ByOtherZone", 1 )  endif  }
; moved into rulelist(s) called above - SAC 11/30/20
;	; for garage wall
;	"Set ResOtherZn:AdjUncondZnWallArea"							ResOtherZn:AdjUncondZnWallArea			=	{	SumChildren( ResIntWall:ParCndOZnAdjUZnArea)
;																													+ SumRevRef( ResIntWall:Outside, ResIntWall:ParUZnAdjCndOZnArea)	}
;	"Set ResOtherZn:GrgWallH"										ResOtherZn:GrgWallH						=	{	Global(ResProj:BldgELA_GarageSF) * AdjUncondZnWallArea / 2.		}
;	"Set ResOtherZn:GrgWallTopZ"									ResOtherZn:GrgWallTopZ					=	{	min( Local(Top), Local(Top) )						}	;Global(ResGarage:Top)
;	"Set ResOtherZn:GrgWallBotZ"									ResOtherZn:GrgWallBotZ					=	{	min( Local(Bottom), Local(Bottom) )					}	;Global(ResGarage:Bottom)
;	"Set ResOtherZn:GrgWallHt"										ResOtherZn:GrgWallHt						=	{	Local(GrgWallTopZ) - Local(GrgWallBotZ)						}
;	"Set ResOtherZn:GrgWallHoleHiZ"								ResOtherZn:GrgWallHoleHiZ				=	{	Local(GrgWallBotZ) + (0.75 * Local(GrgWallHt))				}
;	"Set ResOtherZn:GrgWallHoleLoZ"								ResOtherZn:GrgWallHoleLoZ				=	{	Local(GrgWallBotZ) + (0.25 * Local(GrgWallHt))				}
;
;	"Create ResOtherZn:GrgWallAirNetIZXFERs[1]"				ResOtherZn:GrgWallAirNetIZXFERs[1]		=	{	if ( Local(GrgWallH) > 0. ) 
;																															then CreateComp( cseIZXFER, Local( Name ) + "-xGarageH")
;																															else UNDEFINED
;																															endif  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVType"		ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izZn1"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izZn1		=	{	Local( CSE_ZONE )  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izALo"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izALo		=	{	Local( GrgWallH )  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izHD"				ResOtherZn:GrgWallAirNetIZXFERs[1]:izHD   	=	{	Local( GrgWallHoleHiZ )  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVEff"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izNVEff	=	{	1.0  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izExp"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izExp  	=	{	0.65  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[1]:izZN2"			ResOtherZn:GrgWallAirNetIZXFERs[1]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }
;																					
;	"Create ResOtherZn:GrgWallAirNetIZXFERs[2]"				ResOtherZn:GrgWallAirNetIZXFERs[2]		=	{	if ( Local(GrgWallH) > 0. ) 
;																															then CreateComp( cseIZXFER, Local( Name ) + "-xGarageL")
;																															else UNDEFINED
;																															endif  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVType"		ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVType	=	{	3  }		; AIRNETIZ - Single opening to another zone
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izZn1"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izZn1		=	{	Local( CSE_ZONE )  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izALo"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izALo		=	{	Local( GrgWallH )  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izHD"				ResOtherZn:GrgWallAirNetIZXFERs[2]:izHD   	=	{	Local( GrgWallHoleLoZ )  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVEff"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izNVEff	=	{	1.0  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izExp"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izExp  	=	{	0.65  }
;	"Set ResOtherZn:GrgWallAirNetIZXFERs[2]:izZN2"			ResOtherZn:GrgWallAirNetIZXFERs[2]:izZN2  	=	{	Global( ResGarage:CSE_ZONE )  }

 ;-----------------------
 ; AirNet for IAQ Ventilation
 ;-----------------------
	;   IAQ ventilation  For MF flows may be summed accross units being modelled together in a single zone with W/CFM and ASEF flow weighted.  130517
	;       Inputs for each zone
	;         IAQVentCFM     	// CFM of IAQ vent   
	;         IAQfanWperCFM  	// W/CFM of IAQ vent   
	;         Type IAQExhaust     	// "IAQExhaust", "IAQSupply", "IAQBalanced" "NoIAQVent"
	;	 ASEF     	// If type is IAQBalanced, the apparent sensible effectiveness, fraction (includes fan heat).  Range 0 - 1, default 0  130517
	;		Write Airnet Objects to CSE Input		
	;    
	;	 If Exhaust 
	;	    IZXFER (Zone)IAQfan izNVTYPE = AirNetExtFan izZN1 = (Zone) izVFmin=-IAQVentCFM izVFmax=-IAQVentCFM izFanVfDs=IAQVentCFM izFanElecPwr=IAQfanWperCFM izFanMtr=IAQventMtr
	;	
	;	 If IAQSupply
	;            IZXFER (Zone)IAQfan izNVTYPE = AirNetExtFan izZN1 = (Zone) izVFmin=IAQVentCFM izVFmax=-IAQVentCFM izFanVfDs=IAQVentCFM izFanElecPwr=IAQfanWperCFM izFanMtr=IAQventMtr
	;	
	;	 If IAQBalanced  // Balanced or Heat recovery ventilator 130517
	;	     IZXFER (Zone)IAQHRV  izNVTYPE = AIRNETHERV izZN1 = (Zone) izFanVFDS = IAQVentCFM  izFanElecPwr=IAQfanWperCFM izFanMtr=IAQventMtr izASEF=ASEF  

	;					where:		0, HVACFan:IAQFanType,  1
	;									2,              1,    "Exhaust"
	;									2,              2,    "Supply"
	;									2,              3,    "Balanced"

   ; added logic throughout below to prevent IAQVent IZXFERs for ResOtherZns served by AirSys systems - SAC 05/14/22
   "Create ResOtherZn:IAQVentAirNetIZXFERs[1] (supply)"   ResOtherZn:IAQVentAirNetIZXFERs[1]	=
      {  if (IfValidAnd( IsCond > 0 ) .AND. LocalCompAssigned( ActiveHVACSystem ) == ComponentType( "AirSys" )) then  UNCHANGED
         else if( (IAQCFM_Supply[1] <= 0 .OR. IAQPwr_Supply[1] <= 0 ) .AND. CentralSupplyCFM <= 0 ) then  UNCHANGED
         else  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-IAQFanS" )  endif endif  }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izNVType"      ResOtherZn:IAQVentAirNetIZXFERs[1]:izNVType     = { if( CentralSupplyCFM > 0 ) then 11 else 6 endif }		; AIRNETEXTFAN  - Fan from exterior to zone
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izZn1"         ResOtherZn:IAQVentAirNetIZXFERs[1]:izZn1        = { CSE_ZONE }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izDOAS"        ResOtherZn:IAQVentAirNetIZXFERs[1]:izDOAS       = { if( CentralSupplyCFM > 0 ) then CentralVentSysRef:cseDOAS else UNDEFINED endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izVFmin"       ResOtherZn:IAQVentAirNetIZXFERs[1]:izVFmin      = { if( CentralSupplyCFM > 0 ) then CentralSupplyCFM else IAQCFM_Supply[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izVFmax"       ResOtherZn:IAQVentAirNetIZXFERs[1]:izVFmax      = { if( CentralSupplyCFM > 0 ) then UNDEFINED else IAQCFM_Supply[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanVfDs"     ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanVfDs    = { if( CentralSupplyCFM > 0 ) then UNDEFINED else IAQCFM_Supply[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanElecPwr"  ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanElecPwr = { if( CentralSupplyCFM > 0 ) then UNDEFINED else IAQPwr_Supply[1] * ValidOr( IAQPwrScaleFactor[1], 1 ) / IAQCFM_Supply[1] endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanMtr"      ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanMtr     = { if( CentralSupplyCFM > 0 ) then UNDEFINED else Proj:CSE_ElecMETER endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanEndUse"   ResOtherZn:IAQVentAirNetIZXFERs[1]:izFanEndUse  = { if( CentralSupplyCFM > 0 ) then UNDEFINED else "FANV" endif }

  "Create ResOtherZn:IAQVentAirNetIZXFERs[2] (exhaust)"  ResOtherZn:IAQVentAirNetIZXFERs[2]	=
      {  if (IfValidAnd( IsCond > 0 ) .AND. LocalCompAssigned( ActiveHVACSystem ) == ComponentType( "AirSys" )) then  UNCHANGED
         else if( (IAQCFM_Exhaust[1] <= 0 .OR. IAQPwr_Exhaust[1] <= 0) .AND. CentralExhaustCFM <= 0 ) then  UNCHANGED
         else  CreateComp( cseIZXFER, substr( Name, 0, 44 ) + "-IAQFanE" )  endif endif  }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izNVType"      ResOtherZn:IAQVentAirNetIZXFERs[2]:izNVType     = { if( CentralExhaustCFM > 0 ) then 11 else 6 endif }		; AIRNETEXTFAN  - Fan from exterior to zone
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izZn1"         ResOtherZn:IAQVentAirNetIZXFERs[2]:izZn1			= { CSE_ZONE }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izDOAS"        ResOtherZn:IAQVentAirNetIZXFERs[2]:izDOAS       = { if( CentralExhaustCFM > 0 ) then CentralVentSysRef:cseDOAS else UNDEFINED endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izVFmin"			ResOtherZn:IAQVentAirNetIZXFERs[2]:izVFmin      = { if( CentralExhaustCFM > 0 ) then -1 * CentralExhaustCFM else IAQCFM_Exhaust[1] * -1 * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izVFmax"			ResOtherZn:IAQVentAirNetIZXFERs[2]:izVFmax      = { if( CentralExhaustCFM > 0 ) then UNDEFINED else IAQCFM_Exhaust[1] * -1 * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanVfDs"     ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanVfDs    = { if( CentralExhaustCFM > 0 ) then UNDEFINED else IAQCFM_Exhaust[1] * ValidOr( IAQCFMScaleFactor[1], 1 ) endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanElecPwr"  ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanElecPwr = { if( CentralExhaustCFM > 0 ) then UNDEFINED else IAQPwr_Exhaust[1] * ValidOr( IAQPwrScaleFactor[1], 1 ) / IAQCFM_Exhaust[1] endif }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanMtr"      ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanMtr     =        ; revised to assign Elec2Mtr if IsGarage (so that result posts to Process Motors enduse) - SAC 04/13/22 (Com tic #3366)
      {  if( CentralExhaustCFM > 0 ) then UNDEFINED
         else if (IfValidAnd( IsGarage > 0 )) then  Proj:CSE_Elec2METER
         else  Proj:CSE_ElecMETER  endif endif  }
  "Set ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanEndUse"   ResOtherZn:IAQVentAirNetIZXFERs[2]:izFanEndUse  = { if( CentralExhaustCFM > 0 ) then UNDEFINED else "FANV" endif}

	"Create ResOtherZn:IAQVentAirNetIZXFERs[3] (balanced)"	ResOtherZn:IAQVentAirNetIZXFERs[3]	=
      {  if (IfValidAnd( IsCond > 0 ) .AND. LocalCompAssigned( ActiveHVACSystem ) == ComponentType( "AirSys" )) then  UNCHANGED
         else if (IAQHRVCFM[1] <= 0 .OR. IAQHRVPwr[1] <= 0) then  UNCHANGED
         else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-IAQHRV" )  endif endif  }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izNVType"			ResOtherZn:IAQVentAirNetIZXFERs[3]:izNVType		=	{	10  }		; AIRNETHERV  - IAQ balanced / heat recovery ventilator
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izZn1"				ResOtherZn:IAQVentAirNetIZXFERs[3]:izZn1			=	{	CSE_ZONE  }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanVfDs"			ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanVfDs 	=	{	IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor, 1 )       }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanElecPwr"		ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanElecPwr	=	{	IAQHRVPwr[1] * ValidOr( IAQPwrScaleFactor, 1 ) / IAQHRVCFM[1]   }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izASEF"				ResOtherZn:IAQVentAirNetIZXFERs[3]:izASEF			=
      {  if (IAQHRVCFMxRcvEff[1] <= 0 .OR. IAQHRVCFMxRcvEff[1] > (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor, 1 ) * 100) .OR.
             (IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[1] >= IAQHRVCFMxSRE[1] ))) then  UNDEFINED
         else  (IAQHRVCFMxRcvEff[1] / (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor, 1 ))) / 100  endif  }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izSRE"				ResOtherZn:IAQVentAirNetIZXFERs[3]:izSRE			=        ; SAC 10/21/19
      {  if (IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[1] >= IAQHRVCFMxSRE[1] ))
         then  (IAQHRVCFMxSRE[1] / (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor, 1 ))) / 100
         else  UNDEFINED  endif  }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izASRE"				ResOtherZn:IAQVentAirNetIZXFERs[3]:izASRE			=
      {  if (IfValidAnd( IAQHRVCFMxSRE[1] > 0 ) .AND. IfValidAnd( IAQHRVCFMxASRE[1] >= IAQHRVCFMxSRE[1] ))
         then  (IAQHRVCFMxASRE[1] / (IAQHRVCFM[1] * ValidOr( IAQCFMScaleFactor, 1 ))) / 100
         else  UNDEFINED  endif  }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanMtr"			ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanMtr  	=	{	Proj:CSE_ElecMETER  }
	"Set ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanEndUse"		ResOtherZn:IAQVentAirNetIZXFERs[3]:izFanEndUse	=	{	"FANV"          }


; ;-----------------------
; ; AirNet for Cooling Ventilation (whole house fan / economizer / night breeze)
; ;-----------------------
;   "Log invalid WHF generation issue"     ResOtherZn:Action  =
;      {  if (ClVentAirFlow[1] > 0 .AND. ClVentPower[1] > 0 .AND. ResProj:IsMultiFamily < 1)
;         then  if (ComponentCount( Attic ) < 1)
;               then  PostWarning( "OtherZone '%s' should be modeled with whole house fan, but cannot be due to no Attic present.", Name )
;               else  if (IfValidAnd( ResProj:CondFloorArea > 1 ))
;                     then  if ((SumAll( ResAttic:FloorAreaOverCond ) / ResProj:CondFloorArea) < 0.1)
;                           then  PostWarning( "OtherZone '%s' should be modeled with whole house fan, but cannot be due to Attic not adjacent to at least 10% of overall conditioned floor area.", Name )
;                           else  UNCHANGED  endif
;                     else  UNCHANGED  endif
;               endif
;         else  UNCHANGED  endif  }
;   "Call subordinate rulelist to setup ClVent IZXFER object(s) to ATTIC"   ResOtherZn:Action  =
;      {  if (ClVentAirFlow[1] < 0.1 .OR. ClVentPower[1] < 0.1) then  UNCHANGED
;         else if (LocalCompAssigned( MaxClVentableAttic ) > 0.5)
;         then  if (IfValidAnd( ResProj:CondFloorArea > 1 ) .AND. LocalCompAssigned( MaxClVentableAttic:CSE_ZONE ) > 0.5)
;               then  if ((SumAll( ResAttic:FloorAreaOverCond ) / ResProj:CondFloorArea) >= 0.1)
;                     then  EvalRulelist( "SimPrep_CSE_AirNet_ResOtherZone_WholeHouseFan_ToAttic", 1 )
;                     else  UNCHANGED  endif
;               else  UNCHANGED  endif
;         else  UNCHANGED  endif endif  }
;   "Call subordinate rulelist to setup ClVent IZXFER object(s) to OUTSIDE"   ResOtherZn:Action  =
;      {  if (ClVentAirFlow[2] < 0.1 .OR. ClVentPower[2] < 0.1) then  UNCHANGED
;         else if (ResProj:IsMultiFamily < 1 .AND. IfValidAnd( ResProj:CondFloorArea > 1 ))
;         then  EvalRulelist( "SimPrep_CSE_AirNet_ResOtherZone_WholeHouseFan_ToOutside", 1 )
;         else  UNCHANGED  endif endif  }
;
;   "Call subordinate rulelist to setup ClVent IZXFER object to model WHF damper to outside (for ClVent to outside)"     ; SAC 1/20/19 (tic #1040)
;      ResOtherZn:Action  = {  if (ClVentAirFlow[2] > 0 .AND. ClVentPower[2] > 0 .AND.
;                            IfValidAnd( ResProj:CondFloorArea > 1 ))
;                        then  EvalRulelist( "SimPrep_CSE_AirNet_ResOtherZone_WholeHouseFan_OutsideDamper", 1 )
;                        else  UNCHANGED  endif  }
END

;;*************************************************************************
;RULELIST "SimPrep_CSE_AirNet_ResOtherZone_WholeHouseFan_ToAttic" 0 0 0 1
;;*************************************************************************
;	; from AirNetAlogorithm9.txt:
;	;	7.  Mechanical Cooling Ventilation   //  The following does not work for multi-zone systems with Econ, NightBreeze.  Revise along with ducts model
;	;		For each Cooling Ventilation System
;	;		Inputs 
;	;	         CoolVentType		//type of MECHANICAL cooling ventilation,  Choice of WHF, Econ, NightBreeze
;	;		 CoolVentCFM		//Rated air flow of the mechanical cooling system
;	;		 CoolVent W/CFM		// 
;	;		 ReturnRegister		// If WHF the conditoned zone where it is located
;	;		 
;	;		 Calculate
;	;			Relief = CoolVentCFM/375  // The minimum size of the attic vents required to let the WHF flow out of the attic
;	;			
;	;		If WHF  		// Whole House Fan
;	;		   Calculate
;	;		   	Relief = CoolVentCFM/375  // The minimum size of the attic vent required for this fan to let the WHF flow out of the attic
;	;		   Write Airnet Objects to CSE Input
;	;		   	       	IZXFER (Zone)WHF izNVTYPE=AirNetIZFan izZN1=(Zone) izVFmin=0. izVFMax=-CoolVentCFM*Win_hr izFanVfDs=CoolVentCFM izZn2=Attic izFanElecPwr=CoolVentWperCFM izFanMtr=CoolVentMtr
;
;	"Create ResOtherZn:ClVentAirNetIZXFERs[1] (WHF)"			ResOtherZn:ClVentAirNetIZXFERs[1]					= {	CreateComp( cseIZXFER, Local( Name ) + "-WHF2Atc" )  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izNVType"			ResOtherZn:ClVentAirNetIZXFERs[1]:izNVType		= {	7 	}	; AIRNETIZFAN  - Fan between two zones
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izZn1"				ResOtherZn:ClVentAirNetIZXFERs[1]:izZn1			= {	CSE_ZONE  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izZn2"				ResOtherZn:ClVentAirNetIZXFERs[1]:izZn2			= {	MaxClVentableAttic:CSE_ZONE  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmin"				ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmin			= {	0         }
;
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmax_x"			ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmax_x 		= {
;         Format( "%.1f * WINDOWVENTAVAIL * FANVENTAVAIL", ((ClVentAirFlow[1] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
;                     T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) * -1) )  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanVfDs"			ResOtherZn:ClVentAirNetIZXFERs[1]:izFanVfDs 		= {
;         ClVentAirFlow[1] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
;                     T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
;
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanElecPwr"		ResOtherZn:ClVentAirNetIZXFERs[1]:izFanElecPwr	= {	ClVentPower[1] / ClVentAirFlow[1]   }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanMtr"			ResOtherZn:ClVentAirNetIZXFERs[1]:izFanMtr  		= {	Proj:CSE_ElecMETER  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanEndUse"		ResOtherZn:ClVentAirNetIZXFERs[1]:izFanEndUse	= {	"FANC"          }
;END
;;*************************************************************************
;RULELIST "SimPrep_CSE_AirNet_ResOtherZone_WholeHouseFan_ToOutside" 0 0 0 1
;;*************************************************************************
;	"Create ResOtherZn:ClVentAirNetIZXFERs[1] (WHF)"			ResOtherZn:ClVentAirNetIZXFERs[1]					= {	CreateComp( cseIZXFER, Local( Name ) + "-WHF2Out" )  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izNVType"			ResOtherZn:ClVentAirNetIZXFERs[1]:izNVType		= {	6  }   ; AIRNETEXTFAN - Fan from exterior to zone
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izZn1"				ResOtherZn:ClVentAirNetIZXFERs[1]:izZn1			= {	CSE_ZONE   }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izZn2"				ResOtherZn:ClVentAirNetIZXFERs[1]:izZn2			= {	UNDEFINED  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmin"				ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmin			= {	0          }
;
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmax_x"			ResOtherZn:ClVentAirNetIZXFERs[1]:izVFmax_x 		= {
;         Format( "%.1f * WINDOWVENTAVAIL * FANVENTAVAIL", ((ClVentAirFlow[2] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
;                     T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )) * -1) )  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanVfDs"			ResOtherZn:ClVentAirNetIZXFERs[1]:izFanVfDs 		= {
;         ClVentAirFlow[2] * ValidOr( ResProj:ClVentVerifMult, 1 ) * ResProj:ClVentAirFlowMult /
;                     T24RClimateZoneCodeBase:WHFcfmdivisor( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )  }
;
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanElecPwr"		ResOtherZn:ClVentAirNetIZXFERs[1]:izFanElecPwr	= {	ClVentPower[2] / ClVentAirFlow[2]   }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanMtr"			ResOtherZn:ClVentAirNetIZXFERs[1]:izFanMtr  		= {	Proj:CSE_ElecMETER  }
;	"Set ResOtherZn:ClVentAirNetIZXFERs[1]:izFanEndUse"		ResOtherZn:ClVentAirNetIZXFERs[1]:izFanEndUse	= {	"FANC"          }
;END
;
;;*************************************************************************
;RULELIST "SimPrep_CSE_AirNet_ResOtherZone_WholeHouseFan_OutsideDamper" 0 0 0 1
;;*************************************************************************
;   "Create ResOtherZn:ClVentAirNetIZXFERs[3] (WHF outside damper)"      ResOtherZn:ClVentAirNetIZXFERs[3]  =
;      {  CreateComp( cseIZXFER, Local( Name ) + "-WHFdamper" )  }
;   "Set ResOtherZn:ClVentAirNetIZXFERs[3]:izNVType"   ResOtherZn:ClVentAirNetIZXFERs[3]:izNVType  = {  4  }       ; AIRNETEXT - Single opening to ambient
;   "Set ResOtherZn:ClVentAirNetIZXFERs[3]:izZn1"      ResOtherZn:ClVentAirNetIZXFERs[3]:izZn1     = {  CSE_ZONE  }
;   "Set ResOtherZn:ClVentAirNetIZXFERs[3]:izALo"      ResOtherZn:ClVentAirNetIZXFERs[3]:izALo     = {
;         0.10  }  ; constant??
;         ; ((ResProj:BldgELA_CeilSF *ClVentableClgArea* 1.45) + 0.11 )* ClVentableArea / ResOtherZn:ClVentableClgArea  }
;   "Set ResOtherZn:ClVentAirNetIZXFERs[3]:izHD"       ResOtherZn:ClVentAirNetIZXFERs[3]:izHD      = {  ResOtherZn:ZoneTopZ  }
;   "Set ResOtherZn:ClVentAirNetIZXFERs[3]:izNVEff"    ResOtherZn:ClVentAirNetIZXFERs[3]:izNVEff   = {  1  }
;   "Set ResOtherZn:ClVentAirNetIZXFERs[3]:izExp"      ResOtherZn:ClVentAirNetIZXFERs[3]:izExp     = {  0.65  }
;END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_ResOtherZone_ExtWall" 0 0 0 1
;*************************************************************************
	"Create ResOtherZn:AirNetIZXFERs[1] - WlLU"		ResOtherZn:AirNetIZXFERs[1]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfLU", "Default_ZoneIZXFER" )  }
	"Create ResOtherZn:AirNetIZXFERs[2] - WlLS"		ResOtherZn:AirNetIZXFERs[2]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfLS", "Default_ZoneIZXFER" )  }
	"Create ResOtherZn:AirNetIZXFERs[3] - WlLD"		ResOtherZn:AirNetIZXFERs[3]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfLD", "Default_ZoneIZXFER" )  }
	"Create ResOtherZn:AirNetIZXFERs[4] - WlHU"		ResOtherZn:AirNetIZXFERs[4]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfHU", "Default_ZoneIZXFER" )  }
	"Create ResOtherZn:AirNetIZXFERs[5] - WlHS"		ResOtherZn:AirNetIZXFERs[5]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfHS", "Default_ZoneIZXFER" )  }
	"Create ResOtherZn:AirNetIZXFERs[6] - WlHD"		ResOtherZn:AirNetIZXFERs[6]	= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-InfHD", "Default_ZoneIZXFER" )  }

	"Set ResOtherZn:AirNetIZXFERs[1]:izZn1 - WlLU"		ResOtherZn:AirNetIZXFERs[1]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:AirNetIZXFERs[2]:izZn1 - WlLS"		ResOtherZn:AirNetIZXFERs[2]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:AirNetIZXFERs[3]:izZn1 - WlLD"		ResOtherZn:AirNetIZXFERs[3]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:AirNetIZXFERs[4]:izZn1 - WlHU"		ResOtherZn:AirNetIZXFERs[4]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:AirNetIZXFERs[5]:izZn1 - WlHS"		ResOtherZn:AirNetIZXFERs[5]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:AirNetIZXFERs[6]:izZn1 - WlHD"		ResOtherZn:AirNetIZXFERs[6]:izZn1	= {	Local( CSE_ZONE )  }

	"Set ResOtherZn:AirNetIZXFERs[1]:izALo - WlLU"		ResOtherZn:AirNetIZXFERs[1]:izALo	= {	Local( WallHoleSize )      }
	"Set ResOtherZn:AirNetIZXFERs[2]:izALo - WlLS"		ResOtherZn:AirNetIZXFERs[2]:izALo	= {	Local( WallHoleSize ) * 2  }
	"Set ResOtherZn:AirNetIZXFERs[3]:izALo - WlLD"		ResOtherZn:AirNetIZXFERs[3]:izALo	= {	Local( WallHoleSize )      }
	"Set ResOtherZn:AirNetIZXFERs[4]:izALo - WlHU"		ResOtherZn:AirNetIZXFERs[4]:izALo	= {	Local( WallHoleSize )      }
	"Set ResOtherZn:AirNetIZXFERs[5]:izALo - WlHS"		ResOtherZn:AirNetIZXFERs[5]:izALo	= {	Local( WallHoleSize ) * 2  }
	"Set ResOtherZn:AirNetIZXFERs[6]:izALo - WlHD"		ResOtherZn:AirNetIZXFERs[6]:izALo	= {	Local( WallHoleSize )      }

	"Set ResOtherZn:AirNetIZXFERs[1]:izHD - WlLU"		ResOtherZn:AirNetIZXFERs[1]:izHD		= {	Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight )) )  }
	"Set ResOtherZn:AirNetIZXFERs[2]:izHD - WlLS"		ResOtherZn:AirNetIZXFERs[2]:izHD		= {	Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight )) )  }
	"Set ResOtherZn:AirNetIZXFERs[3]:izHD - WlLD"		ResOtherZn:AirNetIZXFERs[3]:izHD		= {	Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.25 * Local( ZoneHeight )) )  }
	"Set ResOtherZn:AirNetIZXFERs[4]:izHD - WlHU"		ResOtherZn:AirNetIZXFERs[4]:izHD		= {	Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight )) )  }
	"Set ResOtherZn:AirNetIZXFERs[5]:izHD - WlHS"		ResOtherZn:AirNetIZXFERs[5]:izHD		= {	Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight )) )  }
	"Set ResOtherZn:AirNetIZXFERs[6]:izHD - WlHD"		ResOtherZn:AirNetIZXFERs[6]:izHD		= {	Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight ))   }  ; max( 0.1, Local( ZoneBotZ ) + (0.75 * Local( ZoneHeight )) )  }

	"Set ResOtherZn:AirNetIZXFERs[2]:izCpr - WlLS"		ResOtherZn:AirNetIZXFERs[2]:izCpr	= {	-0.65  }
	"Set ResOtherZn:AirNetIZXFERs[3]:izCpr - WlLD"		ResOtherZn:AirNetIZXFERs[3]:izCpr	= {	-0.3   }
	"Set ResOtherZn:AirNetIZXFERs[5]:izCpr - WlHS"		ResOtherZn:AirNetIZXFERs[5]:izCpr	= {	-0.65  }
	"Set ResOtherZn:AirNetIZXFERs[6]:izCpr - WlHD"		ResOtherZn:AirNetIZXFERs[6]:izCpr	= {	-0.3   }
END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_ResOtherZone_Windows_1Story" 0 0 0 1
;*************************************************************************
	"Set ResOtherZn:WinHoleAreaExp[1]"		ResOtherZn:WinHoleAreaExp[1]	= {	Format( "%.3f * WINDOWVENTAVAIL", (Local( WinVentArea ) / 16) )  }
	"Set ResOtherZn:WinHoleAreaExp[2]"		ResOtherZn:WinHoleAreaExp[2]	= {	Format( "%.3f * WINDOWVENTAVAIL", (Local( WinVentArea ) /  8) )  }

	"Create ResOtherZn:WinAirNetIZXFERs[1] - WnLU"			ResOtherZn:WinAirNetIZXFERs[1]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVLU", "Default_ZoneWinIZXFER" )  }
	"Create ResOtherZn:WinAirNetIZXFERs[2] - WnLS"			ResOtherZn:WinAirNetIZXFERs[2]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVLS", "Default_ZoneWinIZXFER" )  }
	"Create ResOtherZn:WinAirNetIZXFERs[3] - WnLD"			ResOtherZn:WinAirNetIZXFERs[3]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVLD", "Default_ZoneWinIZXFER" )  }
	"Create ResOtherZn:WinAirNetIZXFERs[4] - WnHU"			ResOtherZn:WinAirNetIZXFERs[4]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVHU", "Default_ZoneWinIZXFER" )  }
	"Create ResOtherZn:WinAirNetIZXFERs[5] - WnHS"			ResOtherZn:WinAirNetIZXFERs[5]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVHS", "Default_ZoneWinIZXFER" )  }
	"Create ResOtherZn:WinAirNetIZXFERs[6] - WnHD"			ResOtherZn:WinAirNetIZXFERs[6]			= {	CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-NVHD", "Default_ZoneWinIZXFER" )  }

	"Set ResOtherZn:WinAirNetIZXFERs[1]:izZn1 - WnLU"		ResOtherZn:WinAirNetIZXFERs[1]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:WinAirNetIZXFERs[2]:izZn1 - WnLS"		ResOtherZn:WinAirNetIZXFERs[2]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:WinAirNetIZXFERs[3]:izZn1 - WnLD"		ResOtherZn:WinAirNetIZXFERs[3]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:WinAirNetIZXFERs[4]:izZn1 - WnHU"		ResOtherZn:WinAirNetIZXFERs[4]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:WinAirNetIZXFERs[5]:izZn1 - WnHS"		ResOtherZn:WinAirNetIZXFERs[5]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:WinAirNetIZXFERs[6]:izZn1 - WnHD"		ResOtherZn:WinAirNetIZXFERs[6]:izZn1	= {	Local( CSE_ZONE )  }

	"Set ResOtherZn:WinAirNetIZXFERs[1]:izAHi_x - WnLU"	ResOtherZn:WinAirNetIZXFERs[1]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
	"Set ResOtherZn:WinAirNetIZXFERs[2]:izAHi_x - WnLS"	ResOtherZn:WinAirNetIZXFERs[2]:izAHi_x	= {	Local( WinHoleAreaExp[2] )  }
	"Set ResOtherZn:WinAirNetIZXFERs[3]:izAHi_x - WnLD"	ResOtherZn:WinAirNetIZXFERs[3]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
	"Set ResOtherZn:WinAirNetIZXFERs[4]:izAHi_x - WnHU"	ResOtherZn:WinAirNetIZXFERs[4]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }
	"Set ResOtherZn:WinAirNetIZXFERs[5]:izAHi_x - WnHS"	ResOtherZn:WinAirNetIZXFERs[5]:izAHi_x	= {	Local( WinHoleAreaExp[2] )  }
	"Set ResOtherZn:WinAirNetIZXFERs[6]:izAHi_x - WnHD"	ResOtherZn:WinAirNetIZXFERs[6]:izAHi_x	= {	Local( WinHoleAreaExp[1] )  }

	"Set ResOtherZn:WinAirNetIZXFERs[1]:izHD - WnLU"		ResOtherZn:WinAirNetIZXFERs[1]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 3                                  ; max( 0.1, Local( WinHHTopUse[2] ) - 3 )                   
																														else	Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1]   endif  }    ; max( 0.1, Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1] )
	"Set ResOtherZn:WinAirNetIZXFERs[2]:izHD - WnLS"		ResOtherZn:WinAirNetIZXFERs[2]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 3 
																														else	Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1]   endif  }
	"Set ResOtherZn:WinAirNetIZXFERs[3]:izHD - WnLD"		ResOtherZn:WinAirNetIZXFERs[3]:izHD		= {	if (WinVentHtDiff[1] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 3 
																														else	Local( WinHHTopUse[2] ) - 3 + WinVentHtDiff[1]   endif  }
	"Set ResOtherZn:WinAirNetIZXFERs[4]:izHD - WnHU"		ResOtherZn:WinAirNetIZXFERs[4]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 1 
																														else	Local( WinHHTopUse[2] ) - 1 + WinVentHtDiff[2]   endif  }
	"Set ResOtherZn:WinAirNetIZXFERs[5]:izHD - WnHS"		ResOtherZn:WinAirNetIZXFERs[5]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 1 
																														else	Local( WinHHTopUse[2] ) - 1 + WinVentHtDiff[2]   endif  }
	"Set ResOtherZn:WinAirNetIZXFERs[6]:izHD - WnHD"		ResOtherZn:WinAirNetIZXFERs[6]:izHD		= {	if (WinVentHtDiff[2] < -900 .OR. ResProj:BypassRuleLimits < 0.5)
																														then	Local( WinHHTopUse[2] ) - 1 
																														else	Local( WinHHTopUse[2] ) - 1 + WinVentHtDiff[2]   endif  }

	"Set ResOtherZn:WinAirNetIZXFERs[1]:izCpr - WnLU"		ResOtherZn:WinAirNetIZXFERs[1]:izCpr	= {	 0.6  * NatVentWindPresCoefMult  }     ; SAC 7/13/20
	"Set ResOtherZn:WinAirNetIZXFERs[2]:izCpr - WnLS"		ResOtherZn:WinAirNetIZXFERs[2]:izCpr	= {	-0.65 * NatVentWindPresCoefMult  }
	"Set ResOtherZn:WinAirNetIZXFERs[3]:izCpr - WnLD"		ResOtherZn:WinAirNetIZXFERs[3]:izCpr	= {	-0.3  * NatVentWindPresCoefMult  }
	"Set ResOtherZn:WinAirNetIZXFERs[4]:izCpr - WnHU"		ResOtherZn:WinAirNetIZXFERs[4]:izCpr	= {	 0.6  * NatVentWindPresCoefMult  }
	"Set ResOtherZn:WinAirNetIZXFERs[5]:izCpr - WnHS"		ResOtherZn:WinAirNetIZXFERs[5]:izCpr	= {	-0.65 * NatVentWindPresCoefMult  }
	"Set ResOtherZn:WinAirNetIZXFERs[6]:izCpr - WnHD"		ResOtherZn:WinAirNetIZXFERs[6]:izCpr	= {	-0.3  * NatVentWindPresCoefMult  }
END


;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Other" 0 0 0 1
;*************************************************************************

; SAC 8/29/13 - moved from "SimPrep_CSE_AirNet_Zone" rulelist (since rules here need to be evaluated on ResProj as well as Zone)
 ;-----------------------
 ; AirNet for ceiling below attic in Conditioned Zone
 ;-----------------------
   ; d.  Ceiling
   ;    		Calculate
   ;           		If ceiling below attic
	;			ELA_Aceil(zone) = ELAceilsf * AceilGross(zone)  //knee walls to attic not included in determining the conditioned to attic leakage distribution of
	;		If Whole House fan, Ceiling leak through WWF when off   
	;		     	If Improved WHFAe = .05  //  This is Effective Area Ae, not ELA, so doesn't get the 1.45 conversion multiplier Rev 11
	;		     	else  WHFAe = .11  // This is Effective Area Ae, not ELA, so doesn't get the 1.45 conversion multiplier Rev 11
	;      		If ceiling to outside
   ;             		ELA_Xceil(zone) = ELAceilsf * AEdge(zone) + area of exterior ceilings(zone) 
   ;       
   ;         CeilHole     = (ELA_Aceil(zone) * 1.45) + WHFAe   //Ceil Hole size.  Conversion from ELA to airnet infiltration opening is 1.45* 					Rev 9
   ;  		 CathCeilHole =  ELA_Xceil(zone) * 1.45       		//Cathedral Ceil  Hole size.  Conversion from ELA to airnet infiltration opening is 1.45* 	Rev 9
   ;
   ;             Write Airnet Objects to CSE Input
   ;             
	;		IZXFER (ZoneName)xAttic  izNVTYPE = AirNetIZ  izZN1=(ZoneName) izALo=CeilHole     izHD = ZoneTopZ izNVEff=1. izExp=0.65 izZN2 = Attic 		Rev 9
   ;  	IZXFER (ZoneName)CC  	 izNVTYPE = AirNetExt izZN1=(ZoneName) izALo=CathCeilHole izHD = ZoneTopZ izNVEff=1. izExp=0.65    					Rev 9

  ; SAC 1/14/13 - removed logic adjusting WHFanHole based on "Improved" status - logic was referencing WRONG Std/Improved property.  Improved WHFan not yet provided in data model.
	"Init ResZn:WHFanHole to 0"			ResZn:WHFanHole			= {	0  }
	"Init ResOtherZn:WHFanHole to 0"	ResOtherZn:WHFanHole	= {	0  }     ; SAC 9/19/19 (MFamProto)
	"Set Whole house fan hole (for AirNet) - 1"
			ResProj:UnitClVentZone[1]:WHFanHole = {	if (UnitClVentZone[1]:ClVentAirFlow[1] <= 0 .OR. EnableClVent < 0.5 .OR. UnitClVentOption == 3) then  UNCHANGED
																else if ((UnitClVentOption == 2 .AND. LocalCompAssigned( UnitClVentFan[1] )) .OR. UnitClVentOption == 1) then  0.11  else  UNCHANGED  endif endif  }
	"Set Whole house fan hole (for AirNet) - 2"
			ResProj:UnitClVentZone[2]:WHFanHole = {	if (UnitClVentZone[2]:ClVentAirFlow[1] <= 0 .OR. EnableClVent < 0.5 .OR. UnitClVentOption != 2) then  UNCHANGED
																else if (LocalCompAssigned( UnitClVentFan[2] )) then  0.11  else  UNCHANGED  endif endif  }
	"Set Whole house fan hole (for AirNet) - 3"
			ResProj:UnitClVentZone[3]:WHFanHole = {	if (UnitClVentZone[3]:ClVentAirFlow[1] <= 0 .OR. EnableClVent < 0.5 .OR. UnitClVentOption != 2) then  UNCHANGED
																else if (LocalCompAssigned( UnitClVentFan[3] )) then  0.11  else  UNCHANGED  endif endif  }
	"Set Whole house fan hole (for AirNet) - 4"
			ResProj:UnitClVentZone[4]:WHFanHole = {	if (UnitClVentZone[4]:ClVentAirFlow[1] <= 0 .OR. EnableClVent < 0.5 .OR. UnitClVentOption != 2) then  UNCHANGED
																else if (LocalCompAssigned( UnitClVentFan[4] )) then  0.11  else  UNCHANGED  endif endif  }
	"Set Whole house fan hole (for AirNet) - 5"
			ResProj:UnitClVentZone[5]:WHFanHole = {	if (UnitClVentZone[5]:ClVentAirFlow[1] <= 0 .OR. EnableClVent < 0.5 .OR. UnitClVentOption != 2) then  UNCHANGED
																else if (LocalCompAssigned( UnitClVentFan[5] )) then  0.11  else  UNCHANGED  endif endif  }
	"Set Whole house fan hole (for AirNet) - 6"
			ResProj:UnitClVentZone[6]:WHFanHole = {	if (UnitClVentZone[6]:ClVentAirFlow[1] <= 0 .OR. EnableClVent < 0.5 .OR. UnitClVentOption != 2) then  UNCHANGED
																else if (LocalCompAssigned( UnitClVentFan[6] )) then  0.11  else  UNCHANGED  endif endif  }
; SAC 8/29/13 - replaced below w/ above and removed old zone cool vent system references to address GC issue 149
;	"Set ResZn:WHFanHole - Whole house fan hole (for AirNet)"
;			ResZn:WHFanHole	= {	if (LocalCompAssigned( CoolVentSystem ))
;										then  0.11
;							;			then	if (ResProj:InsulConsQuality == 2) then  0.05		; improved
;							;					else  0.11
;							;					endif
;										else  0  endif  }

	; for Ceilings below attic -
; ; DEBUGGING
; 	"Debug log message - ResZn:Type"							ResZn:Action		= {	PostMessageToLog( "Zone '%s' Type = %g", Name, Type )  }
; 	"Debug log message - ResZn:ELA_ACeil"					ResZn:Action		= {	PostMessageToLog( "Zone '%s' ELA_ACeil = %g", Name, ELA_ACeil )  }
; 	"Debug log message - ResZn:ZoneTopZ"						ResZn:Action		= {	PostMessageToLog( "Zone '%s' ZoneTopZ = %g", Name, ZoneTopZ )  }
; 	"Debug log message - Attic count"						ResProj:Action		= {	PostMessageToLog( "ComponentCount( Attic ) = %g", ComponentCount( Attic ) )  }
; 	"Debug log message - ResAttic:CSE_ZONE assignment"		ResProj:Action		= {	PostMessageToLog( "GlobalCompAssigned( ResAttic:CSE_ZONE ) = %g", GlobalCompAssigned( ResAttic:CSE_ZONE ) )  }
;	"Create ResZn:CeilAirNetIZXFERs[1] - xAttic"				ResZn:CeilAirNetIZXFERs[1]	= {	if (Type == 10 .OR. ELA_ACeil <= 0 .OR. ZoneTopZ <= 0 .OR. ComponentCount( Attic ) < 1 .OR.
;																															 GlobalCompAssigned( ResAttic:CSE_ZONE ) == 0) then  UNDEFINED
;																														else  CreateComp( cseIZXFER, Local( Name ) + "-xAttic" )  endif  }
;	"Set ResZn:CeilAirNetIZXFERs[1]:izZn1 - xAttic"			ResZn:CeilAirNetIZXFERs[1]:izZn1		= {	Local( CSE_ZONE )  }
;	"Set ResZn:CeilAirNetIZXFERs[1]:izNVType - xAttic"		ResZn:CeilAirNetIZXFERs[1]:izNVType	= {	3  }		; AIRNETIZ" - Single opening to another zone
;	"Set ResZn:CeilAirNetIZXFERs[1]:izALo - xAttic"			ResZn:CeilAirNetIZXFERs[1]:izALo	 	= {	if (Global( ResAttic:Type ) == 1)
;																																	then	(ELA_ACeil * 1.45) * 10				; SAC 4/25/14 - crank up zone-attic hole for conditioned attics, since not sealed
;																																	else	(ELA_ACeil * 1.45) + WHFanHole  	; SAC 3/19/13 - excluded WHFanHole from 1.45 multiplication (from AirNetAlgorithm11.txt)
;																																	endif  }
;	"Set ResZn:CeilAirNetIZXFERs[1]:izHD - xAttic"			ResZn:CeilAirNetIZXFERs[1]:izHD   	= {	ZoneTopZ  }
;	"Set ResZn:CeilAirNetIZXFERs[1]:izNVEff - xAttic"		ResZn:CeilAirNetIZXFERs[1]:izNVEff  	= {	1  }
;	"Set ResZn:CeilAirNetIZXFERs[1]:izExp - xAttic"			ResZn:CeilAirNetIZXFERs[1]:izExp   	= {	0.65  }
;	"Set ResZn:CeilAirNetIZXFERs[1]:izZN2 - xAttic"			ResZn:CeilAirNetIZXFERs[1]:izZN2   	= {	Attic:CSE_ZONE  }
; SAC 10/16/14 - replaced above w/ following to accommodate multiple Attics
	"Create CeilingBelowAttic:CeilAirNetIZXFER - xAttic"			CeilingBelowAttic:CeilAirNetIZXFER	= {	if ((ParentComponentType() != "ResZn" .AND. ParentComponentType() != "ResOtherZn") .OR.
	                                                                                                          LocalCompAssigned( AtticZone ) < 1 .OR. LocalCompAssigned( AtticZone:CSE_ZONE ) < 1) then  UNCHANGED
																																			else if (Parent( Type ) == 10 .OR. IfValidAnd( ELA_ACeil > 0 )==0 .OR. ZoneTopZ <= 0 .OR. Area < 0.1) then  UNDEFINED
																																			else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-xAttic" )  endif endif  }
	"Set CeilingBelowAttic:CeilAirNetIZXFER:izZn1 - xAttic"		CeilingBelowAttic:CeilAirNetIZXFER:izZn1		= {	Parent( CSE_ZONE )  }
	"Set CeilingBelowAttic:CeilAirNetIZXFER:izNVType - xAttic"	CeilingBelowAttic:CeilAirNetIZXFER:izNVType	= {	3  }		; AIRNETIZ" - Single opening to another zone

;	"Post debug message"    CeilingBelowAttic:Action = {
;PostMessageToLog( "      setting CeilingBelowAttic:CeilAirNetIZXFER:izALo -- ResProj:BldgELA_CeilSF = %g / Area  = %g / ResZn:WHFanHole = %g / ClVentableArea = %g / ResZn:ClVentableClgArea = %g -- for ceiling '%s'",
;          ResProj:BldgELA_CeilSF, Area, ResZn:WHFanHole, ClVentableArea, ResZn:ClVentableClgArea, Name )  }

	"Set CeilingBelowAttic:CeilAirNetIZXFER:izALo - xAttic"		CeilingBelowAttic:CeilAirNetIZXFER:izALo	 	=     ; added OtherZone NResLeakageRatio adjustment - SAC 11/30/20
			{		if (AtticZone:Type == 1 .OR. ClVentableArea < 0.1)
					then	(ResProj:BldgELA_CeilSF * ClVentableClgArea* 1.45      ) * 10						; SAC 4/25/14 - crank up zone-attic hole for conditioned attics, since not sealed
					else if (ParentComponentType() == "ResZn")
					then	((ResProj:BldgELA_CeilSF *ClVentableClgArea* 1.45      ) + ResZn:WHFanHole )* ClVentableArea / ResZn:ClVentableClgArea  	; SAC 3/19/13 - excluded WHFanHole from 1.45 multiplication (from AirNetAlgorithm11.txt)
					else if (ParentComponentType() == "ResOtherZn")
					then	((ResProj:BldgELA_CeilSF * ClVentableArea  * 1.45 * ValidOr( ResProj:NResLeakageRatio, 1 ))  )   	; SAC 9/19/19 - OtherZone (MFamProto)   ; SAC 11/30/20
					else	(ResProj:BldgELA_CeilSF *ClVentableClgArea * 1.45      )+ WHFanHole 			; SAC 12/17/14 - generic IZXFER w/out any ClVent adjustment ??
					endif endif endif  }
	"Set CeilingBelowAttic:CeilAirNetIZXFER:izHD - xAttic"		CeilingBelowAttic:CeilAirNetIZXFER:izHD   	= {	if (ParentComponentType() == "ResOtherZn") then  ResOtherZn:ZoneTopZ
	                                                                                                               else  ResZn:ZoneTopZ  endif  }
	"Set CeilingBelowAttic:CeilAirNetIZXFER:izNVEff - xAttic"	CeilingBelowAttic:CeilAirNetIZXFER:izNVEff  	= {	1  }
	"Set CeilingBelowAttic:CeilAirNetIZXFER:izExp - xAttic"		CeilingBelowAttic:CeilAirNetIZXFER:izExp   	= {	0.65  }
	"Set CeilingBelowAttic:CeilAirNetIZXFER:izZN2 - xAttic"		CeilingBelowAttic:CeilAirNetIZXFER:izZN2   	= {	AtticZone:CSE_ZONE  }

	; for Cathedral Ceilings -
	"Create ResZn:CeilAirNetIZXFER - CC"				ResZn:CeilAirNetIZXFER				= {	if (Type == 10 .OR. IfValidAnd( ELA_XCeil > 0 )==0 .OR. ZoneTopZ <= 0) then  UNDEFINED
																													else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-CC" )  endif  }
	"Set ResZn:CeilAirNetIZXFER:izZn1 - CC"			ResZn:CeilAirNetIZXFER:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResZn:CeilAirNetIZXFER:izNVType - CC"		ResZn:CeilAirNetIZXFER:izNVType	= {	4  }		; AIRNETEXT - Single opening to ambient
;"Post debug message"    ResZn:CeilAirNetIZXFER:Action = {
;PostMessageToLog( "      setting ResZn:CeilAirNetIZXFER:izALo -- ELA_XCeil= %g-- '%s'",
;          ELA_XCeil, Name )  }
	"Set ResZn:CeilAirNetIZXFER:izALo - CC"			ResZn:CeilAirNetIZXFER:izALo	 	= {	ELA_XCeil * 1.45  }
	"Set ResZn:CeilAirNetIZXFER:izHD - CC"			ResZn:CeilAirNetIZXFER:izHD   		= {	ZoneTopZ  }
	"Set ResZn:CeilAirNetIZXFER:izNVEff - CC"		ResZn:CeilAirNetIZXFER:izNVEff  	= {	1  }
	"Set ResZn:CeilAirNetIZXFER:izExp - CC"			ResZn:CeilAirNetIZXFER:izExp   	= {	0.65  }

	; for Cathedral Ceilings -   SAC 9/19/19 - OtherZone (MFamProto)
	"Create ResOtherZn:CeilAirNetIZXFER - CC"			ResOtherZn:CeilAirNetIZXFER				= {	if (Type == 10 .OR. IfValidAnd( ELA_XCeil > 0 )==0 .OR. ZoneTopZ <= 0) then  UNDEFINED
																															else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-CC" )  endif  }
	"Set ResOtherZn:CeilAirNetIZXFER:izZn1 - CC"		ResOtherZn:CeilAirNetIZXFER:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResOtherZn:CeilAirNetIZXFER:izNVType - CC"	ResOtherZn:CeilAirNetIZXFER:izNVType	= {	4  }		; AIRNETEXT - Single opening to ambient
	"Set ResOtherZn:CeilAirNetIZXFER:izALo - CC"		ResOtherZn:CeilAirNetIZXFER:izALo	 	= {	ELA_XCeil * 1.45  }
	"Set ResOtherZn:CeilAirNetIZXFER:izHD - CC"		ResOtherZn:CeilAirNetIZXFER:izHD   	= {	ZoneTopZ  }
	"Set ResOtherZn:CeilAirNetIZXFER:izNVEff - CC"	ResOtherZn:CeilAirNetIZXFER:izNVEff  = {	1  }
	"Set ResOtherZn:CeilAirNetIZXFER:izExp - CC"		ResOtherZn:CeilAirNetIZXFER:izExp   	= {	0.65  }


; SAC 4/18/13 - revised CoolVent whole house fan air net stuff to generate a single whole house fan per system, rather than per zone
 ;-----------------------
 ; AirNet for Cooling Ventilation (whole house fan / economizer / night breeze)
 ;-----------------------
; second gen mechanism that setup ClVent airnet by system - now replaced by mechanism by zone
;	"Call subordinate rulelist to setup ClVent IZXFER object(s)"
;			ResHVACSys:Action	= {	if (Type != 10 .OR. ResProj:IsMultiFamily > 0.5 .OR. LocalCompAssigned( AirNet_CoolVentZone ) == 0) then  UNCHANGED
;										else if (LocalRef( Fan:Type ) == 2 .AND.		; Whole House Fan
;													LocalRef( Fan:CoolingVent ) > 0)
;										then  EvalRulelist( "SimPrep_CSE_AirNet_System_WholeHouseFan", 1 )
;										else  UNCHANGED  endif endif  }


 ;-----------------------
 ; CEILING AirNet
 ;-----------------------


 ;-----------------------
 ; EXTERIOR FLOOR AirNet
 ;-----------------------
 ;      2.  ELAraisedFloorsf   = ELAtot* (.2* 1-SlabRatio)/( ExFloortotSF-ExFloorSlabSF)
 ;
 ;      e.  Floor over outside
 ;              For each floor over outside calculate       	     	
 ;                     ELAfloor(Name) = ELAraisedFloorsf * AreaExtfloor * 1.45   (floors whose outside condition is Ambiant)
 ;         Write Airnet Object to CSE Input
 ;            IZXFER (Name)  izNVTYPE = AirNetExt izZN1 = (ZoneName) izALo = ELAfloor(Name)  izHD = Floor Height izNVEff = 1 izExp=0.65 izCpr=0.  // located at the Extfloor elevation, no wind effect
 ;       
 ;      e.  Floor over Crawl
 ;              For each floor over outside calculate       	     	
 ;                     ELAfloor(Name) = ELAraisedFloorsf * AreaCrawlfloor * 1.45   (floors whose outside condition is  Crawl)
 ;         Write Airnet Object to CSE Input
 ;            IZXFER (Name)xCrawl  izNVTYPE = AirNetIZ izZN1=(ZoneName) izALo=ELAfloor(Name) izHD = Floor Height izNVEff=1. izExp=0.65 izZN2 = Crawl 

; duplicate (but now out incomplete) of formula used in rule in 'Default_CSE_AirNet_ELA' rulelist - SAC 7/12/20
;   "Set ResProj:BldgELA_RaisedFlrSF"	ResProj:BldgELA_RaisedFlrSF	= {   if (Local( BldgExtFloorArea ) < 0.0001) then  0
;																							else  Local( EffLeakageArea ) * (0.2 * (  1 - Local( SlabRatio ))) /  Local( BldgExtFloorArea )  endif  }

   "Set ResExtFlr:FloorELA_Ext"      ResExtFlr:FloorELA_Ext      =    ; OtherZone adjustment - SAC 11/30/20
      {  if (IfValidAnd( Area > 0.1 )==0) then  -1
         else if (ParentComponentType() == "ResOtherZn")
         then  ResProj:BldgELA_RaisedFlrSF * Area * 1.45 * ValidOr( ResProj:NResLeakageRatio, 1 )
         else  ResProj:BldgELA_RaisedFlrSF * Area * 1.45
         endif endif  }
	"Create ResExtFlr:AirNetIZXFER_Ext"			ResExtFlr:AirNetIZXFER_Ext				= {	if (Local( FloorELA_Ext ) < 0.00001) then  UNCHANGED
																																	else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-Ext" )  endif  }
	"Set ResExtFlr:AirNetIZXFER_Ext:izNVType"	ResExtFlr:AirNetIZXFER_Ext:izNVType	= {	"AIRNETEXT"  }		; Single opening to ambient
	"Set ResExtFlr:AirNetIZXFER_Ext:izZn1"		ResExtFlr:AirNetIZXFER_Ext:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResExtFlr:AirNetIZXFER_Ext:izALo"		ResExtFlr:AirNetIZXFER_Ext:izALo		= {	Local( FloorELA_Ext )  }
	; SAC 11/18/14 - allow negative airnet hole positions
	"Set ResExtFlr:AirNetIZXFER_Ext:izHD"			ResExtFlr:AirNetIZXFER_Ext:izHD			= {	max( FloorZ, Parent( Bottom ) )  }   ; max( FloorZ, max( 0.1, Parent( Bottom ) ) )  }   ; SAC 1/26/13 - added reference to FloorZ
	"Set ResExtFlr:AirNetIZXFER_Ext:izNVEff"		ResExtFlr:AirNetIZXFER_Ext:izNVEff		= {	1.0   }
	"Set ResExtFlr:AirNetIZXFER_Ext:izExp"		ResExtFlr:AirNetIZXFER_Ext:izExp		= {	0.65  }
	"Set ResExtFlr:AirNetIZXFER_Ext:izCpr"		ResExtFlr:AirNetIZXFER_Ext:izCpr		= {	0.0   }

	"Set ResFlrOverCrawlSpc:FloorELA_Crawl"		ResFlrOverCrawlSpc:FloorELA_Crawl		=    ; OtherZone adjustment - SAC 11/30/20
      {  if (IfValidAnd( Area > 0.1 )==0) then  -1
         else if (ParentComponentType() == "ResOtherZn")
         then  ResProj:BldgELA_RaisedFlrSF * Area * 1.45 * ValidOr( ResProj:NResLeakageRatio, 1 )
         else  ResProj:BldgELA_RaisedFlrSF * Area * 1.45
         endif endif  }
	"Create ResFlrOverCrawlSpc:AirNetIZXFER_Crl"			ResFlrOverCrawlSpc:AirNetIZXFER_Crl				= {	if (Local( FloorELA_Crawl ) < 0.00001 .OR. ComponentCount( CrawlSpace ) < 0.5) then  UNCHANGED
																																	else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-Crawl" )  endif  }
	"Set ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izNVType"	ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izNVType	= {	"AIRNETIZ"  }			; Single opening to another zone
	"Set ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izZn1"		ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izALo"		ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izALo		= {	Local( FloorELA_Crawl )  }
	; SAC 11/18/14 - allow negative airnet hole positions
	"Set ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izHD"		ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izHD		= {	max( FloorZ, Parent( Bottom ) )  }   ; max( FloorZ, max( 0.1, Parent( Bottom ) ) )  }   ; SAC 1/26/13 - added reference to FloorZ
	"Set ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izNVEff"	ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izNVEff	= {	1.0   }
	"Set ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izExp"		ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izExp		= {	0.65  }
	"Set ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izZn2"		ResFlrOverCrawlSpc:AirNetIZXFER_Crl:izZn2		= {	Global( ResCrawlSpc:CSE_ZONE )  }


 ;-----------------------
 ; ATTIC AirNet
 ;-----------------------
;	"Set ResZn:AtticBottom"		ResZn:AtticBottom	= {	if (SumChildren( CeilingBelowAttic:Area ) > 1) then  min( 99999, Local( ZoneTopZ ) )
;																		else  99999  endif  }
;	"Set ResAttic:Bottom"			ResAttic:Bottom		= {	MinAll( ResZn:AtticBottom )  }
; SAC 10/16/14 - replaced above w/ below to accommodate multiple Attics
	"Set CeilingBelowAttic:AtticBottom"		CeilingBelowAttic:AtticBottom		= {
															if (LocalCompAssigned( AtticZone ) < 0.5) then  99999
															else if (ParentComponentType() == "ResZn") then  min( 99999, ResZn:ZoneTopZ )
															else if (ParentComponentType() == "ResOtherZn") then  min( 99999, ResOtherZn:ZoneTopZ )
															else if (ParentComponentType() == "ResGarage")
															then	if (IfValidAnd( ResGarage:Volume > 0.1 ) .AND. IfValidAnd( ResGarage:Area > 0.1 ) .AND. IfValidAnd( ResGarage:Bottom > -9999 ))
																	then	ResGarage:Bottom + (ResGarage:Volume / ResGarage:Area)
																	else  99999  endif
															else  99999  endif endif endif endif  }
	"Set ResAttic:Bottom"	ResAttic:Bottom	= {	MinRevRef( CeilingBelowAttic:AtticZone, CeilingBelowAttic:AtticBottom )  }

; SAC 12/28/14 - revised EvalRulelist() calls to include second argument of '1' so that those rules get evaluated ONLY on the active Attic.  W/o this, N times too many attic vents are created PER Attic, where N is the total # of attics
	"Setup Attic AirNet properties via subordinate rulelist"
			ResAttic:Action	 = {	if (Local( FloorArea ) > 0.1 .AND. Local( Bottom ) <= 99990)
										then	switch (Local( Type ))
													case  0 :	EvalRulelist( "SimPrep_CSE_AirNet_Attic_Vented", 1 )			; "Ventilated"
													case  1 :	EvalRulelist( "SimPrep_CSE_AirNet_Attic_Conditioned", 1 )	; "Conditioned"
													default :	UNCHANGED
												endswitch
										else	UNCHANGED  endif  }


 ;-----------------------
 ; Interior Floor over Garage AirNet
 ;-----------------------
 ; - based on Floor of a conditioned zone -
	"Set ResIntFlr:ELA_Floor"		ResIntFlr:ELA_Floor		 =    ; rev for OtherZone surfaces - SAC 11/30/20
      {	ResProj:BldgELA_GarageSF * (ParCndZnAdjUZnArea + ParUZnAdjCndZnArea +
                                  (ValidOr( ResProj:NResLeakageRatio, 1 ) * (ParCndOZnAdjUZnArea + ParUZnAdjCndOZnArea))) * 1.45  }
	"Create CondZone/Garage IZXFER ResIntFlr:AirNetGarIZXFER"
			ResIntFlr:AirNetGarIZXFER		= {	if (ELA_Floor < 0.000001) then  UNCHANGED
																else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "xGarage" )  endif  }
	"Set ResIntFlr:AirNetGarIZXFER:izNVType"	ResIntFlr:AirNetGarIZXFER:izNVType	= {	"AIRNETIZ"  }		; Single opening to another zone
	"Set ResIntFlr:AirNetGarIZXFER:izZn1"		ResIntFlr:AirNetGarIZXFER:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResIntFlr:AirNetGarIZXFER:izALo"		ResIntFlr:AirNetGarIZXFER:izALo		= {	ELA_Floor  }
	; SAC 11/18/14 - allow negative airnet hole positions
	"Set ResIntFlr:AirNetGarIZXFER:izHD"		ResIntFlr:AirNetGarIZXFER:izHD		= {	if (LocalStatus( FloorZ ) > 0.1) then  FloorZ
																															else if (IfValidAnd( Outside:Volume > 0 ) && IfValidAnd( Outside:Area > 0 ))
																															then	Outside:Volume / Outside:Area
																															else  UNDEFINED  endif endif  }
																														;	if (FloorZ > 0.1) then	FloorZ	   ; SAC 1/26/13 - added reference to FloorZ
																														;	else if (LocalRef( Outside:Volume ) > 0 && LocalRef( Outside:Area ) > 0)
																														;	then	max( 0.1, LocalRef( Outside:Volume ) / LocalRef( Outside:Area ) )
																														;	else  UNDEFINED  endif endif  }
	"Set ResIntFlr:AirNetGarIZXFER:izNVEff"	ResIntFlr:AirNetGarIZXFER:izNVEff	= {	1.0   }
	"Set ResIntFlr:AirNetGarIZXFER:izExp"		ResIntFlr:AirNetGarIZXFER:izExp		= {	0.65  }
	"Set ResIntFlr:AirNetGarIZXFER:izZn2"		ResIntFlr:AirNetGarIZXFER:izZn2		= {	LocalRef( Outside:CSE_ZONE )   }     ; SAC 4/9/13 - fixed bug izCpr -> izZn2

 ; - based on Ceiling of a Garage zone -
	"Set ResIntCeiling:ELA_Floor"		ResIntCeiling:ELA_Floor		 =    ; rev for OtherZone surfaces - SAC 11/30/20
      {  ResProj:BldgELA_GarageSF * (ParUZnAdjCndZnArea + (ValidOr( ResProj:NResLeakageRatio, 1 ) * ParUZnAdjCndOZnArea)) * 1.45  }
	"Create CondZone/Garage IZXFER ResIntCeiling:AirNetGarIZXFER"
			ResIntCeiling:AirNetGarIZXFER	= {	if (ELA_Floor < 0.000001) then  UNCHANGED
																else  CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "xGarage" )  endif  }
	"Set ResIntCeiling:AirNetGarIZXFER:izNVType"	ResIntCeiling:AirNetGarIZXFER:izNVType	= {	"AIRNETIZ"  }		; Single opening to another zone
	"Set ResIntCeiling:AirNetGarIZXFER:izZn1"		ResIntCeiling:AirNetGarIZXFER:izZn1		= {	LocalRef( Outside:CSE_ZONE )  }
	"Set ResIntCeiling:AirNetGarIZXFER:izALo"		ResIntCeiling:AirNetGarIZXFER:izALo		= {	ELA_Floor  }
	; SAC 11/18/14 - allow negative airnet hole positions
	"Set ResIntCeiling:AirNetGarIZXFER:izHD"		ResIntCeiling:AirNetGarIZXFER:izHD		= {	if (Parent( Volume ) > 0 && Parent( Area ) > 0)
																																	then	Parent( Volume ) / Parent( Area )		; max( 0.1, Parent( Volume ) / Parent( Area ) )
																																	else  UNDEFINED  endif  }
	"Set ResIntCeiling:AirNetGarIZXFER:izNVEff"	ResIntCeiling:AirNetGarIZXFER:izNVEff	= {	1.0   }
	"Set ResIntCeiling:AirNetGarIZXFER:izExp"		ResIntCeiling:AirNetGarIZXFER:izExp		= {	0.65  }
	"Set ResIntCeiling:AirNetGarIZXFER:izZn2"		ResIntCeiling:AirNetGarIZXFER:izZn2		= {	Parent( CSE_ZONE )   }		; SAC 4/9/13 - fixed bug izCpr -> izZn2


 ;-----------------------
 ; AirNet for Garage zone
 ;-----------------------
 ;  Assume California garage with a water heater and combustion air vents so it is pretty leaky  Guess 1 ft2 of free area (ignore other infiltration)
 ;     IZXFER GarageU   izNVTYPE = AirNetExt   izZN1 = Garage   izALo = Gvent     izHD = GarageBotZ +1   izNVEff = .6   izExp=0.65   izCpr=0.6
 ;     IZXFER GarageS   izNVTYPE = AirNetExt   izZN1 = Garage   izALo = 2*Gvent   izHD = GarageBotZ +1   izNVEff = .6   izExp=0.65   izCpr=-.65
 ;     IZXFER GarageD   izNVTYPE = AirNetExt   izZN1 = Garage   izALo = Gvent     izHD = GarageBotZ +1   izNVEff = .6   izExp=0.65   izCpr=-0.3 
 ;     IZXFER GarageDH  izNVTYPE = AirNetExt   izZN1 = Garage   izALo = Gvent     izHD = GarageBotZ +8   izNVEff = .6   izExp=0.65   izCpr=-0.3   <<-- this one added from phone call w/ Bruce 1/31/13
 ;-----------------------
	"Set ResGarage:GrgVent"			ResGarage:GrgVent		= {	0.20  }

	"Create ResGarage:GrgAirNetIZXFERs[1]"				ResGarage:GrgAirNetIZXFERs[1]		=	{	if (ResProj:HasGarage < 0.5 .OR. Volume < 1) then  UNDEFINED
																												else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-GrgU")  endif  }
	"Set ResGarage:GrgAirNetIZXFERs[1]:izNVType"		ResGarage:GrgAirNetIZXFERs[1]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResGarage:GrgAirNetIZXFERs[1]:izZn1"			ResGarage:GrgAirNetIZXFERs[1]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResGarage:GrgAirNetIZXFERs[1]:izALo"			ResGarage:GrgAirNetIZXFERs[1]:izALo		= {	GrgVent     }
	"Set ResGarage:GrgAirNetIZXFERs[1]:izHD"			ResGarage:GrgAirNetIZXFERs[1]:izHD		= {	Bottom + 1  }
	"Set ResGarage:GrgAirNetIZXFERs[1]:izNVEff"		ResGarage:GrgAirNetIZXFERs[1]:izNVEff  = {	 0.6   }
	"Set ResGarage:GrgAirNetIZXFERs[1]:izExp"			ResGarage:GrgAirNetIZXFERs[1]:izExp		= {	 0.65  }
	"Set ResGarage:GrgAirNetIZXFERs[1]:izCpr"			ResGarage:GrgAirNetIZXFERs[1]:izCpr		= {	 0.6   }

	"Create ResGarage:GrgAirNetIZXFERs[2]"				ResGarage:GrgAirNetIZXFERs[2]		=	{	if (ResProj:HasGarage < 0.5 .OR. Volume < 1) then  UNDEFINED
																												else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-GrgS")  endif  }
	"Set ResGarage:GrgAirNetIZXFERs[2]:izNVType"		ResGarage:GrgAirNetIZXFERs[2]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResGarage:GrgAirNetIZXFERs[2]:izZn1"			ResGarage:GrgAirNetIZXFERs[2]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResGarage:GrgAirNetIZXFERs[2]:izALo"			ResGarage:GrgAirNetIZXFERs[2]:izALo		= {	GrgVent * 2  }
	"Set ResGarage:GrgAirNetIZXFERs[2]:izHD"			ResGarage:GrgAirNetIZXFERs[2]:izHD		= {	Bottom + 1   }
	"Set ResGarage:GrgAirNetIZXFERs[2]:izNVEff"		ResGarage:GrgAirNetIZXFERs[2]:izNVEff  = {	 0.6   }
	"Set ResGarage:GrgAirNetIZXFERs[2]:izExp"			ResGarage:GrgAirNetIZXFERs[2]:izExp		= {	 0.65  }
	"Set ResGarage:GrgAirNetIZXFERs[2]:izCpr"			ResGarage:GrgAirNetIZXFERs[2]:izCpr		= {	-0.65  }

	"Create ResGarage:GrgAirNetIZXFERs[3]"				ResGarage:GrgAirNetIZXFERs[3]		=	{	if (ResProj:HasGarage < 0.5 .OR. Volume < 1) then  UNDEFINED
																												else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-GrgD")  endif  }
	"Set ResGarage:GrgAirNetIZXFERs[3]:izNVType"		ResGarage:GrgAirNetIZXFERs[3]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResGarage:GrgAirNetIZXFERs[3]:izZn1"			ResGarage:GrgAirNetIZXFERs[3]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResGarage:GrgAirNetIZXFERs[3]:izALo"			ResGarage:GrgAirNetIZXFERs[3]:izALo		= {	GrgVent     }
	"Set ResGarage:GrgAirNetIZXFERs[3]:izHD"			ResGarage:GrgAirNetIZXFERs[3]:izHD		= {	Bottom + 1  }
	"Set ResGarage:GrgAirNetIZXFERs[3]:izNVEff"		ResGarage:GrgAirNetIZXFERs[3]:izNVEff  = {	 0.6   }
	"Set ResGarage:GrgAirNetIZXFERs[3]:izExp"			ResGarage:GrgAirNetIZXFERs[3]:izExp		= {	 0.65  }
	"Set ResGarage:GrgAirNetIZXFERs[3]:izCpr"			ResGarage:GrgAirNetIZXFERs[3]:izCpr		= {	-0.3   }

	"Create ResGarage:GrgAirNetIZXFERs[4]"				ResGarage:GrgAirNetIZXFERs[4]		=	{	if (ResProj:HasGarage < 0.5 .OR. Volume < 1) then  UNDEFINED
																												else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-GrgDH")  endif  }
	"Set ResGarage:GrgAirNetIZXFERs[4]:izNVType"		ResGarage:GrgAirNetIZXFERs[4]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResGarage:GrgAirNetIZXFERs[4]:izZn1"			ResGarage:GrgAirNetIZXFERs[4]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResGarage:GrgAirNetIZXFERs[4]:izALo"			ResGarage:GrgAirNetIZXFERs[4]:izALo		= {	GrgVent     }
	"Set ResGarage:GrgAirNetIZXFERs[4]:izHD"			ResGarage:GrgAirNetIZXFERs[4]:izHD		= {	Bottom + 8  }
	"Set ResGarage:GrgAirNetIZXFERs[4]:izNVEff"		ResGarage:GrgAirNetIZXFERs[4]:izNVEff  = {	 0.6   }
	"Set ResGarage:GrgAirNetIZXFERs[4]:izExp"			ResGarage:GrgAirNetIZXFERs[4]:izExp		= {	 0.65  }
	"Set ResGarage:GrgAirNetIZXFERs[4]:izCpr"			ResGarage:GrgAirNetIZXFERs[4]:izCpr		= {	-0.3   }


 ;-----------------------
 ; AirNet for CrawlSpace zone
 ;-----------------------
 ;  from AirNetAlgorithm12.txt  (3/27/13)
 ;  	c.  Crawl space.  Has wall leakage plus optional vents.  3 types of vent.  Leakage = 10 sq.in. per 1,000 sq.ft. of floor area.  1.45 * 10/(144*1000)/ft2 of crawl.  (rev 12)
 ;  	             CrawlWallHeight DEFAULT IS 0.75 FT.  Need new input on Crawlspace screen.
 ;  		          Assume no stack inside crawl so all vents at top of foundation concrete wall, 8" above ground = 0.67  (rev 12)
 ;  		 Calculate  CrwlLeak = Sum of (Floor areas over Crawl) * 0.0001
 ;  		 Write Wall leakage objects:	      
 ;  		      IZXFER CrwlWu  izNVTYPE = AirNetExt izZN1 = (CrawlName) izALo = CrwlLeak/4  izHD = 0.67  izNVEff = 1 izExp=0.65 izCpr=0.6 
 ;  		      IZXFER CrwlWs  izNVTYPE = AirNetExt izZN1 = (CrawlName) izALo = CrwlLeak/2  izHD = 0.67  izNVEff = 1 izExp=0.65 izCpr=-.65
 ;  		      IZXFER CrwlWd  izNVTYPE = AirNetExt izZN1 = (CrawlName) izALo = CrwlLeak/4  izHD = 0.67  izNVEff = 1 izExp=0.65 izCpr=-0.3
 ;  	      	 Vent area    CrwlV  for three crawl types:
 ;  		1.  Conventional vented Crawl. CrwlVent = Sum of (Floor areas over Crawl)/150
 ;  		2.  Reduced vent Crawl.  CrwlVent = Sum of (Floor areas over Crawl)/1500
 ;  		3.  Sealed Crawl    CrwlVent = 0  (May have an exhaust fan)
 ;  		Center of vent above grade -- assume 4" vent at top of conc wall, center is 10" above grade  (rev 12)
 ;  		Write Crawl Vent Objects to CSE Input
 ;  			IZXFER CrwlVU  izNVTYPE = AirNetExt izZN1 = (CrawlName) izALo = CrwlVent/4  izHD = 10/12  izNVEff = .6 izExp=0.65 izCpr=0.6 
 ;  			IZXFER CrwlVS  izNVTYPE = AirNetExt izZN1 = (CrawlName) izALo = CrwlVent/2  izHD = 10/12  izNVEff = .6 izExp=0.65 izCpr=-.65
 ;  			IZXFER CrwlVD  izNVTYPE = AirNetExt izZN1 = (CrawlName) izALo = CrwlVent/4  izHD = 10/12  izNVEff = .6 izExp=0.65 izCpr=-0.3
 ;-----------------------
	"Set ResCrawlSpc:WallLeakageArea"		ResCrawlSpc:WallLeakageArea		= {	Area * 0.0001  }     ; for ver. 11 was:  Area / 14400  }
	"Set ResCrawlSpc:VentArea"				ResCrawlSpc:VentArea				= {	switch (Type)
																										case 0 :	 Area /  150   ; "Normal (vented)"                   
																										case 1 :  Area / 1500   ; "Insulated w/ Reduced Ventilation"  
																										case 2 :  0             ; "Sealed and Mechanically Ventilated"
																										default:  0
																									endswitch  }
	"Set ResCrawlSpc:VentHeight"			ResCrawlSpc:VentHeight			= {	0.67  }		; for ver. 11 was:  0.66 + (AvgWallHeight - 0.66) / 2  }

  ; AirNet for CrawlSpace Walls
	"Create ResCrawlSpc:AirNetCSWallIZXFERs[1]"				ResCrawlSpc:AirNetCSWallIZXFERs[1]		=	{	if (LocalStatus( Area ) < 1 .OR. Area < 0.5) then  UNDEFINED
																																		else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-WU")  endif  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[1]:izNVType"		ResCrawlSpc:AirNetCSWallIZXFERs[1]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[1]:izZn1"			ResCrawlSpc:AirNetCSWallIZXFERs[1]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[1]:izALo"			ResCrawlSpc:AirNetCSWallIZXFERs[1]:izALo		= {	WallLeakageArea / 4  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[1]:izHD"				ResCrawlSpc:AirNetCSWallIZXFERs[1]:izHD			= {	VentHeight  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[1]:izNVEff"			ResCrawlSpc:AirNetCSWallIZXFERs[1]:izNVEff		= {	 1.0   }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[1]:izExp"			ResCrawlSpc:AirNetCSWallIZXFERs[1]:izExp		= {	 0.65  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[1]:izCpr"			ResCrawlSpc:AirNetCSWallIZXFERs[1]:izCpr		= {	 0.6   }

	"Create ResCrawlSpc:AirNetCSWallIZXFERs[2]"				ResCrawlSpc:AirNetCSWallIZXFERs[2]		=	{	if (LocalStatus( Area ) < 1 .OR. Area < 0.5) then  UNDEFINED
																																		else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-WS")  endif  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[2]:izNVType"		ResCrawlSpc:AirNetCSWallIZXFERs[2]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[2]:izZn1"			ResCrawlSpc:AirNetCSWallIZXFERs[2]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[2]:izALo"			ResCrawlSpc:AirNetCSWallIZXFERs[2]:izALo		= {	WallLeakageArea / 2  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[2]:izHD"				ResCrawlSpc:AirNetCSWallIZXFERs[2]:izHD			= {	VentHeight  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[2]:izNVEff"			ResCrawlSpc:AirNetCSWallIZXFERs[2]:izNVEff		= {	 1.0   }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[2]:izExp"			ResCrawlSpc:AirNetCSWallIZXFERs[2]:izExp		= {	 0.65  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[2]:izCpr"			ResCrawlSpc:AirNetCSWallIZXFERs[2]:izCpr		= {	-0.65  }

	"Create ResCrawlSpc:AirNetCSWallIZXFERs[3]"				ResCrawlSpc:AirNetCSWallIZXFERs[3]		=	{	if (LocalStatus( Area ) < 1 .OR. Area < 0.5) then  UNDEFINED
																																		else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-WD")  endif  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[3]:izNVType"		ResCrawlSpc:AirNetCSWallIZXFERs[3]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[3]:izZn1"			ResCrawlSpc:AirNetCSWallIZXFERs[3]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[3]:izALo"			ResCrawlSpc:AirNetCSWallIZXFERs[3]:izALo		= {	WallLeakageArea / 4  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[3]:izHD"				ResCrawlSpc:AirNetCSWallIZXFERs[3]:izHD			= {	VentHeight  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[3]:izNVEff"			ResCrawlSpc:AirNetCSWallIZXFERs[3]:izNVEff		= {	 1.0   }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[3]:izExp"			ResCrawlSpc:AirNetCSWallIZXFERs[3]:izExp		= {	 0.65  }
	"Set ResCrawlSpc:AirNetCSWallIZXFERs[3]:izCpr"			ResCrawlSpc:AirNetCSWallIZXFERs[3]:izCpr		= {	-0.3   }


  ; AirNet for CrawlSpace Venting
  ; SAC 10/17/13 - added checks to prevent IZXFERs from being created when VentArea <= 0
	"Create ResCrawlSpc:AirNetCSVentIZXFERs[1]"				ResCrawlSpc:AirNetCSVentIZXFERs[1]		=	{	if (LocalStatus( Area ) < 1 .OR. Area < 0.5 .OR. VentArea <= 0) then  UNDEFINED
																																		else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-VU")  endif  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[1]:izNVType"		ResCrawlSpc:AirNetCSVentIZXFERs[1]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[1]:izZn1"			ResCrawlSpc:AirNetCSVentIZXFERs[1]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[1]:izALo"			ResCrawlSpc:AirNetCSVentIZXFERs[1]:izALo		= {	VentArea / 4  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[1]:izHD"				ResCrawlSpc:AirNetCSVentIZXFERs[1]:izHD			= {	VentHeight + 0.1667  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[1]:izNVEff"			ResCrawlSpc:AirNetCSVentIZXFERs[1]:izNVEff		= {	 0.6   }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[1]:izExp"			ResCrawlSpc:AirNetCSVentIZXFERs[1]:izExp		= {	 0.65  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[1]:izCpr"			ResCrawlSpc:AirNetCSVentIZXFERs[1]:izCpr		= {	 0.6   }

	"Create ResCrawlSpc:AirNetCSVentIZXFERs[2]"				ResCrawlSpc:AirNetCSVentIZXFERs[2]		=	{	if (LocalStatus( Area ) < 1 .OR. Area < 0.5 .OR. VentArea <= 0) then  UNDEFINED
																																		else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-VS")  endif  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[2]:izNVType"		ResCrawlSpc:AirNetCSVentIZXFERs[2]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[2]:izZn1"			ResCrawlSpc:AirNetCSVentIZXFERs[2]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[2]:izALo"			ResCrawlSpc:AirNetCSVentIZXFERs[2]:izALo		= {	VentArea / 2  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[2]:izHD"				ResCrawlSpc:AirNetCSVentIZXFERs[2]:izHD			= {	VentHeight + 0.1667  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[2]:izNVEff"			ResCrawlSpc:AirNetCSVentIZXFERs[2]:izNVEff		= {	 0.6   }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[2]:izExp"			ResCrawlSpc:AirNetCSVentIZXFERs[2]:izExp		= {	 0.65  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[2]:izCpr"			ResCrawlSpc:AirNetCSVentIZXFERs[2]:izCpr		= {	-0.65  }

	"Create ResCrawlSpc:AirNetCSVentIZXFERs[3]"				ResCrawlSpc:AirNetCSVentIZXFERs[3]		=	{	if (LocalStatus( Area ) < 1 .OR. Area < 0.5 .OR. VentArea <= 0) then  UNDEFINED
																																		else CreateComp( cseIZXFER, substr( Name, 0, 46 ) + "-VD")  endif  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[3]:izNVType"		ResCrawlSpc:AirNetCSVentIZXFERs[3]:izNVType	= {	4  }   ; AIRNETEXT - Single opening to ambient
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[3]:izZn1"			ResCrawlSpc:AirNetCSVentIZXFERs[3]:izZn1		= {	Local( CSE_ZONE )  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[3]:izALo"			ResCrawlSpc:AirNetCSVentIZXFERs[3]:izALo		= {	VentArea / 4  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[3]:izHD"				ResCrawlSpc:AirNetCSVentIZXFERs[3]:izHD			= {	VentHeight + 0.1667  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[3]:izNVEff"			ResCrawlSpc:AirNetCSVentIZXFERs[3]:izNVEff		= {	 0.6   }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[3]:izExp"			ResCrawlSpc:AirNetCSVentIZXFERs[3]:izExp		= {	 0.65  }
	"Set ResCrawlSpc:AirNetCSVentIZXFERs[3]:izCpr"			ResCrawlSpc:AirNetCSVentIZXFERs[3]:izCpr		= {	-0.3   }


 ;-----------------------
 ; AirNet for Inter-Zone (conditioned) Doors & Stairs
 ;-----------------------
 ;  from AirNetAlgorithm12.txt  (3/27/13)
 ;  	5.  Interzone Holes  --  Assume an open door or stair between any 2 conditioned zones with common surfaces, except between units in multi-family
 ;  		If 2 or more conditioned zones 
 ;  			Error if not at least one common surface for every conditioned zone (a surface in zone A whose outside condition is another conditoned zone)
 ;  			Door calculation for each pair of zones with a common wall surface (zoneA<>zoneB, zoneB<>zoneC, zoneA<>zoneC, etc)
 ;  				DoortopZ 	= Min(ZoneTopZ(zone A),(ZoneTopZ(zone B))    	//The top of the shared wall
 ;  	              		DoorBotZ 	= Max(ZoneBotZ(zone A),(ZoneBotZ(zone B))    	//The bottom of the shared wall
 ;  	              		DoorH		= DoortopZ - DoorBotZ				// Height of shared opening
 ;  	              		DH		= 20/						// Area of half of assumed door
 ;  	              		DHhZ		= GwallBotZ + .75 GwallH			// Height of top hole
 ;  	              		DHHlZ		= GwallBotZ + .25 GwallH			// Height of bottom hole
 ;  			For each zone pair write Airnet Objects to CSE Input		
 ;  				IZXFER (ZoneNameA)DHx(ZoneNameB)DH  izNVTYPE = AirNetIZ izZN1=(ZoneNameA) izALo=DH izHD = DHhZ izNVEff=1. izExp=0.5 izZN2 = (ZoneNameB) 
 ;  				IZXFER (ZoneNameA)DLx(ZoneNameB)DL  izNVTYPE = AirNetIZ izZN1=(ZoneNameA) izALo=DH izHD = DHlZ izNVEff=1. izExp=0.5 izZN2 = (ZoneNameB)
 ;  			Stair calculation for each pair of zones with only a floor/ceiling surface (zoneA<>zoneB, zoneB<>zoneC, zoneA<>zoneC, etc)
 ;  				StairZ		= Max(ZoneBotZ(zone A),(ZoneBotZ(zone B))    	//The height of the stair hole is at the upper floor floor
 ;  			For each zone pair write Airnet Objects to CSE Input	Note that izZN1 MUST be the lower of the 2 zones or the model doesn't work	
 ;  				IZXFER (ZoneNameA)Sx(ZoneNameB)S  izNVType = AIRNETHORIZ izZN1=(ZoneName of lowerzone) izZN2 = (ZoneName of upper zone) izL1=3 izL1=10 izHD =StairZ 
 ;-----------------------

  ; AirNet for Door between Conditioned Zones
	; SAC 6/5/13 - modified rule to REMOVE interior door holes if this is a multifamily project and the Zone on the other side is that of a different dwelling unit
	; SAC 9/18/19 - mods to handle OtherZone same as Zone (MFamProto)
	"Set ResIntWall:InterCondWallHt"			ResIntWall:InterCondWallHt		= {	if (LocalCompAssigned( Outside ) == 0) then  0
																								else if (ParentComponentType() == "ResZn" .OR. ParentComponentType() == "ResOtherZn")
																								then	if (LocalCompAssigned( Outside ) == ComponentType( "ResZn" ) .OR. LocalCompAssigned( Outside ) == ComponentType( "ResOtherZn" ))
																										then	min( Parent( Top ), Outside:Top ) - max( Parent( Bottom ), Outside:Bottom )
																										else if (LocalCompAssigned( Outside ) == ComponentType( "ResGarage" ))
																										then	if (IfValidAnd( Outside:Area > 0.1 ) .AND. IfValidAnd( Outside:Volume > 0.1 ) .AND. LocalStatus( Outside:Bottom ) > 0)
																												then	min( Parent( Top ), (Outside:Bottom + (Outside:Volume / Outside:Area)) ) - max( Parent( Bottom ), Outside:Bottom )
																												else	0  endif
																										else if (LocalCompAssigned( Outside ) == ComponentType( "ResAttic" ))
																										then	min( Parent( Top ), (Outside:Bottom + Outside:Height) ) - max( Parent( Bottom ), Outside:Bottom )
																										else	0  endif endif endif
																								else if (ParentComponentType() == "ResGarage")
																								then	if (IfValidAnd( Outside:Area > 0.1 ) .AND. IfValidAnd( Outside:Volume > 0.1 ) .AND. LocalStatus( Outside:Bottom ) > 0)
																										then	if (LocalCompAssigned( Outside ) == ComponentType( "ResZn" ) .OR. LocalCompAssigned( Outside ) == ComponentType( "ResOtherZn" ))
																												then	min( (Parent( Bottom ) + (Parent( Volume ) / Parent( Area ))), Outside:Top ) - max( Parent( Bottom ), Outside:Bottom )
																												else if (LocalCompAssigned( Outside ) == ComponentType( "ResGarage" ))
																												then	if (IfValidAnd( Outside:Area > 0.1 ) .AND. IfValidAnd( Outside:Volume > 0.1 ) .AND. LocalStatus( Outside:Bottom ) > 0)
																														then	min( (Parent( Bottom ) + (Parent( Volume ) / Parent( Area ))), (Outside:Bottom + (Outside:Volume / Outside:Area)) ) - max( Parent( Bottom ), Outside:Bottom )
																														else	0  endif
																												else if (LocalCompAssigned( Outside ) == ComponentType( "ResAttic" ))
																												then	min( (Parent( Bottom ) + (Parent( Volume ) / Parent( Area ))), (Outside:Bottom + Outside:Height) ) - max( Parent( Bottom ), Outside:Bottom )
																												else	0  endif endif endif
																										else	0  endif
																								else	0	endif endif endif  }

  ; SAC 10/7/13 - revised rule to PREVENT creation of Door IZXFER for any party surface (ResIntWall:IsPartySurface)
	"Create ResIntWall:AirNetDoorIZXFER[1]"				ResIntWall:AirNetDoorIZXFER[1]		= {	if (InterCondZnArea < 0.5 .OR. InterCondWallHt < 0.5 .OR. IsPartySurface > 0.5) then  UNDEFINED
																														else if (CompExists( cseIZXFER, Format( "%sDHx%sDH", Parent( CSE_ZONE ), Outside:CSE_ZONE ) )) then  UNDEFINED
																														else if (CompExists( cseIZXFER, Format( "%sDHx%sDH", Outside:CSE_ZONE, Parent( CSE_ZONE ) ) )) then  UNDEFINED
																														else CreateComp( cseIZXFER, substr( Parent( CSE_ZONE ), 0, 28 ) + "DHx" + substr( Outside:CSE_ZONE, 0, 28 ) + "DH")  endif endif endif  }
	"Set ResIntWall:AirNetDoorIZXFER[1]:izNVType"		ResIntWall:AirNetDoorIZXFER[1]:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone
	"Set ResIntWall:AirNetDoorIZXFER[1]:izZn1"			ResIntWall:AirNetDoorIZXFER[1]:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResIntWall:AirNetDoorIZXFER[1]:izALo"			ResIntWall:AirNetDoorIZXFER[1]:izALo		= {	20 / 2  }
	"Set ResIntWall:AirNetDoorIZXFER[1]:izHD"				ResIntWall:AirNetDoorIZXFER[1]:izHD			= {	max( Parent( Bottom ), Outside:Bottom ) + (6.67 * 0.75)  }  ; SAC 10/9/13 - revised to use typical door height - was: (InterCondWallHt * 0.75)  }
	"Set ResIntWall:AirNetDoorIZXFER[1]:izNVEff"			ResIntWall:AirNetDoorIZXFER[1]:izNVEff		= {	 1.0   }
	"Set ResIntWall:AirNetDoorIZXFER[1]:izExp"			ResIntWall:AirNetDoorIZXFER[1]:izExp		= {	 0.5  }
	"Set ResIntWall:AirNetDoorIZXFER[1]:izZn2"			ResIntWall:AirNetDoorIZXFER[1]:izZn2		= {	Outside:CSE_ZONE  }

  ; SAC 10/7/13 - revised rule to PREVENT creation of Door IZXFER for any party surface (ResIntWall:IsPartySurface)
	"Create ResIntWall:AirNetDoorIZXFER[2]"				ResIntWall:AirNetDoorIZXFER[2]		= {	if (InterCondZnArea < 0.5 .OR. InterCondWallHt < 0.5 .OR. IsPartySurface > 0.5) then  UNDEFINED
																														else if (CompExists( cseIZXFER, Format( "%sDLx%sDL", Parent( CSE_ZONE ), Outside:CSE_ZONE ) )) then  UNDEFINED
																														else if (CompExists( cseIZXFER, Format( "%sDLx%sDL", Outside:CSE_ZONE, Parent( CSE_ZONE ) ) )) then  UNDEFINED
																														else CreateComp( cseIZXFER, substr( Parent( CSE_ZONE ), 0, 28 ) + "DLx" + substr( Outside:CSE_ZONE, 0, 28 ) + "DL")  endif endif endif  }
	"Set ResIntWall:AirNetDoorIZXFER[2]:izNVType"		ResIntWall:AirNetDoorIZXFER[2]:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone
	"Set ResIntWall:AirNetDoorIZXFER[2]:izZn1"			ResIntWall:AirNetDoorIZXFER[2]:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResIntWall:AirNetDoorIZXFER[2]:izALo"			ResIntWall:AirNetDoorIZXFER[2]:izALo		= {	20 / 2  }
	"Set ResIntWall:AirNetDoorIZXFER[2]:izHD"				ResIntWall:AirNetDoorIZXFER[2]:izHD			= {	max( Parent( Bottom ), Outside:Bottom ) + (6.67 * 0.25)  }  ; SAC 10/9/13 - revised to use typical door height - was: (InterCondWallHt * 0.25)  }
	"Set ResIntWall:AirNetDoorIZXFER[2]:izNVEff"			ResIntWall:AirNetDoorIZXFER[2]:izNVEff		= {	 1.0   }
	"Set ResIntWall:AirNetDoorIZXFER[2]:izExp"			ResIntWall:AirNetDoorIZXFER[2]:izExp		= {	 0.5  }
	"Set ResIntWall:AirNetDoorIZXFER[2]:izZn2"			ResIntWall:AirNetDoorIZXFER[2]:izZn2		= {	Outside:CSE_ZONE  }

   ; IZXFERs modeling Opening between Zones - SAC 07/30/20
   "Create ResOpening:AirNetIZXFER[1]"          ResOpening:AirNetIZXFER[1]  =
      {  if (LocalCompAssigned( Outside ) < 1 .OR. IfValidAnd( Area > 0 )==0 .OR.
             IfValidAnd( Height > 0 )==0 .OR. IfValidAnd( BottomHt >= 0 )==0) then  UNDEFINED
         else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-OH" )  endif  }
	"Set ResOpening:AirNetIZXFER[1]:izNVType"		ResOpening:AirNetIZXFER[1]:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone
	"Set ResOpening:AirNetIZXFER[1]:izZn1"			ResOpening:AirNetIZXFER[1]:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResOpening:AirNetIZXFER[1]:izALo"			ResOpening:AirNetIZXFER[1]:izALo		= {	Area / 2  }
	"Set ResOpening:AirNetIZXFER[1]:izHD"			ResOpening:AirNetIZXFER[1]:izHD		= {	Parent( Bottom ) + BottomHt + (Height * 0.75)  }
	"Set ResOpening:AirNetIZXFER[1]:izNVEff"		ResOpening:AirNetIZXFER[1]:izNVEff	= {	 1.0   }
	"Set ResOpening:AirNetIZXFER[1]:izExp"			ResOpening:AirNetIZXFER[1]:izExp		= {	 0.5  }
	"Set ResOpening:AirNetIZXFER[1]:izZn2"			ResOpening:AirNetIZXFER[1]:izZn2		= {	Outside:CSE_ZONE  }
   "Create ResOpening:AirNetIZXFER[2]"          ResOpening:AirNetIZXFER[2]  =
      {  if (LocalCompAssigned( Outside ) < 1 .OR. IfValidAnd( Area > 0 )==0 .OR.
             IfValidAnd( Height > 0 )==0 .OR. IfValidAnd( BottomHt >= 0 )==0) then  UNDEFINED
         else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-OL" )  endif  }
	"Set ResOpening:AirNetIZXFER[2]:izNVType"		ResOpening:AirNetIZXFER[2]:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone
	"Set ResOpening:AirNetIZXFER[2]:izZn1"			ResOpening:AirNetIZXFER[2]:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResOpening:AirNetIZXFER[2]:izALo"			ResOpening:AirNetIZXFER[2]:izALo		= {	Area / 2  }
	"Set ResOpening:AirNetIZXFER[2]:izHD"			ResOpening:AirNetIZXFER[2]:izHD		= {	Parent( Bottom ) + BottomHt + (Height * 0.25)  }
	"Set ResOpening:AirNetIZXFER[2]:izNVEff"		ResOpening:AirNetIZXFER[2]:izNVEff	= {	 1.0   }
	"Set ResOpening:AirNetIZXFER[2]:izExp"			ResOpening:AirNetIZXFER[2]:izExp		= {	 0.5  }
	"Set ResOpening:AirNetIZXFER[2]:izZn2"			ResOpening:AirNetIZXFER[2]:izZn2		= {	Outside:CSE_ZONE  }

  ; AirNet for Stairway between Conditioned Zones (via floor or ceiling)
	"Create ResIntCeiling:AirNetStairIZXFER"			ResIntCeiling:AirNetStairIZXFER		= {	if (InterCondZnArea < 0.5 .OR.
																													;						(ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( OutsideDiffUnit > 0.5 ))) then  UNDEFINED
																																			(IsPartySurface > 0.5 .AND. OtherSideModeled > 0.5 .AND. LocalCompAssigned( Outside ))) then  UNDEFINED
																																	else CreateComp( cseIZXFER, substr( Parent( CSE_ZONE ), 0, 28 ) + "SCx" + substr( Outside:CSE_ZONE, 0, 28 ) + "SC")  endif  }
	"Set ResIntCeiling:AirNetStairIZXFER:izNVType"	ResIntCeiling:AirNetStairIZXFER:izNVType	= {	5  }   ; AIRNETHORIZ - Horizontal (large) opening between two zones
	"Set ResIntCeiling:AirNetStairIZXFER:izZn1"		ResIntCeiling:AirNetStairIZXFER:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResIntCeiling:AirNetStairIZXFER:izZn2"		ResIntCeiling:AirNetStairIZXFER:izZn2		= {	Outside:CSE_ZONE  }
	"Set ResIntCeiling:AirNetStairIZXFER:izL1"			ResIntCeiling:AirNetStairIZXFER:izL1			= {	3   }
	"Set ResIntCeiling:AirNetStairIZXFER:izL2"			ResIntCeiling:AirNetStairIZXFER:izL2			= {	10  }
	"Set ResIntCeiling:AirNetStairIZXFER:izHD"			ResIntCeiling:AirNetStairIZXFER:izHD			= {	max( Parent( Bottom ), Outside:Bottom )  }

; SAC 6/5/13 - modified rule to REMOVE stairwell hole if this is a multifamily project and the Zone on the other side is that of a different dwelling unit
	"Create ResIntFlr:AirNetStairIZXFER"				ResIntFlr:AirNetStairIZXFER			= {	if (InterCondZnArea < 0.5 .OR.
																													;						(ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( OutsideDiffUnit > 0.5 ))) then  UNDEFINED
																																			(IsPartySurface > 0.5 .AND. OtherSideModeled > 0.5 .AND. LocalCompAssigned( Outside ))) then  UNDEFINED
																																	else CreateComp( cseIZXFER, substr( Outside:CSE_ZONE, 0, 28 ) + "Sx" + substr( Parent( CSE_ZONE ), 0, 28 ) + "S")  endif  }
	"Set ResIntFlr:AirNetStairIZXFER:izNVType"		ResIntFlr:AirNetStairIZXFER:izNVType		= {	5  }   ; AIRNETHORIZ - Horizontal (large) opening between two zones
	"Set ResIntFlr:AirNetStairIZXFER:izZn1"			ResIntFlr:AirNetStairIZXFER:izZn1			= {	Outside:CSE_ZONE    }
	"Set ResIntFlr:AirNetStairIZXFER:izZn2"			ResIntFlr:AirNetStairIZXFER:izZn2			= {	Parent( CSE_ZONE )  }
	"Set ResIntFlr:AirNetStairIZXFER:izL1"			ResIntFlr:AirNetStairIZXFER:izL1			= {	3   }
	"Set ResIntFlr:AirNetStairIZXFER:izL2"			ResIntFlr:AirNetStairIZXFER:izL2			= {	10  }
	"Set ResIntFlr:AirNetStairIZXFER:izHD"			ResIntFlr:AirNetStairIZXFER:izHD			= {	max( Parent( Bottom ), Outside:Bottom )  }


 ;-----------------------
 ; AirNet for Inter-Zone (conditioned) Party Walls - separating dwelling units
 ;-----------------------
 ;  from Google Code issue #114   (6/6/13)
 ;  	Add an interzone airnet hole between any 2 zones where one or more party surfaces exist.
 ;    The hole size is the area of the party surface(s) in ft2 * 0.0005.
 ;    The Z of the hole should be the midheight of the Party surface(s).
 ;    The area of party surfaces between zones can be summed and one hole created or a a hole can be created for each surface individually.
 ;    Here is an example of the hole for a party floor:
 ;        IZXFER   "Conditioned-znPSxConditioned-2-znPS"     ; switched 'S' to 'PS' to distinguish from Stairwell holes above
 ;           izNVType = "AIRNETIZ"
 ;           izZn1 = "Conditioned-zn"
 ;           izZn2 = "Conditioned-2-zn"
 ;           izALo = 1.3715
 ;           izHD = 9.7
 ;           izNVEff = 1
 ;           izExp = 0.65
 ;
 ;  correction sent from Bruce Wilcox via e-mail 10/8/13  (and posted back to Google Code issue #114)
 ;    after discussing this with Chip we are sure that 2 holes are needed in order to get the correct behavior.  So just like the airnet
 ;    leakage objects in exterior walls:  2 holes each 1/2 the area at 1/4 and 3/4 the absolute height of the wall.
 ;    MODS THEREFORE TO:  IZXFER names "..PSx..PS" -> "..PSHx..PSH" & "..PSLx..PSL"  /  each area (izALo / 2)  /  Hi/Low location mods to izHD (*0.5 -> *0.75/*0.25)
 ;-----------------------
 ; IntWall inter-party surface hole:
  ; SAC 10/7/13 - revised rule to ENSURE creation of PartySurface IZXFERs based on new party surface property (ResIntWall:IsPartySurface)
   "Create ResIntWall:AirNetPrtySrfIZXFER[1]"            ResIntWall:AirNetPrtySrfIZXFER[1]      =        ; mods to include holes only when both sides Conditioned - SAC 11/30/20
      {  if (Area < 0.1 .OR. InterCondWallHt < 0.1) then  UNCHANGED
      ;   else if (ResProj:IsMultiFamily > 0.5 .AND. OutsideDiffUnit > 0.5)
         else if ( (ParentComponentType() == "ResZn" .OR. ParentComponentType() == "ResOtherZn") .AND.
                   (LocalCompAssigned( Outside ) == ComponentType( "ResZn" ) .OR.
                    LocalCompAssigned( Outside ) == ComponentType( "ResOtherZn" )))
         then  if (IsPartySurface > 0.5 .AND. OtherSideModeled > 0.5 .AND.
                   Parent( Type ) < 10 .AND. Outside:Type < 10)
               then  CreateComp( cseIZXFER, substr( Name, 0, 28 ) + "PSHx" + substr( Outside:Name, 0, 28 ) + "PSH")
               else  UNDEFINED  endif
         else  UNDEFINED  endif endif  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[1]:izNVType"		ResIntWall:AirNetPrtySrfIZXFER[1]:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone
	"Set ResIntWall:AirNetPrtySrfIZXFER[1]:izZn1"			ResIntWall:AirNetPrtySrfIZXFER[1]:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[1]:izZn2"			ResIntWall:AirNetPrtySrfIZXFER[1]:izZn2		= {	Outside:CSE_ZONE  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[1]:izALo"			ResIntWall:AirNetPrtySrfIZXFER[1]:izALo		=     ; SAC 7/13/20
      {  if (ResProj:CSEVentAvailZonal)
         then  if (ParentComponentType() == "ResZn" .AND. LocalCompAssigned( Outside ) == ComponentType( "ResZn" ))
               then  Area * ValidOr( ResProj:IntSurfHoleSzRatio[1], 0.0005 ) / 2
               else  Area * ValidOr( ResProj:IntSurfHoleSzRatio[2], 0.0005 ) / 2
               endif
         else  Area * 0.00025    endif  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[1]:izHD"				ResIntWall:AirNetPrtySrfIZXFER[1]:izHD			= {	max( Parent( Bottom ), Outside:Bottom ) + (InterCondWallHt * 0.75)  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[1]:izNVEff"			ResIntWall:AirNetPrtySrfIZXFER[1]:izNVEff		= {	 1.0   }
	"Set ResIntWall:AirNetPrtySrfIZXFER[1]:izExp"			ResIntWall:AirNetPrtySrfIZXFER[1]:izExp		= {	 0.65  }

   "Create ResIntWall:AirNetPrtySrfIZXFER[2]"            ResIntWall:AirNetPrtySrfIZXFER[2]      =        ; mods to include holes only when both sides Conditioned - SAC 11/30/20
      {  if (Area < 0.1 .OR. InterCondWallHt < 0.1) then  UNCHANGED
      ;   else if (ResProj:IsMultiFamily > 0.5 .AND. OutsideDiffUnit > 0.5)
         else if ( (ParentComponentType() == "ResZn" .OR. ParentComponentType() == "ResOtherZn") .AND.
                   (LocalCompAssigned( Outside ) == ComponentType( "ResZn" ) .OR.
                    LocalCompAssigned( Outside ) == ComponentType( "ResOtherZn" )))
         then  if (IsPartySurface > 0.5 .AND. OtherSideModeled > 0.5 .AND.
                   Parent( Type ) < 10 .AND. Outside:Type < 10)
               then  CreateComp( cseIZXFER, substr( Name, 0, 28 ) + "PSLx" + substr( Outside:Name, 0, 28 ) + "PSL")
               else  UNDEFINED  endif
         else  UNDEFINED  endif endif  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[2]:izNVType"		ResIntWall:AirNetPrtySrfIZXFER[2]:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone
	"Set ResIntWall:AirNetPrtySrfIZXFER[2]:izZn1"			ResIntWall:AirNetPrtySrfIZXFER[2]:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[2]:izZn2"			ResIntWall:AirNetPrtySrfIZXFER[2]:izZn2		= {	Outside:CSE_ZONE  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[2]:izALo"			ResIntWall:AirNetPrtySrfIZXFER[2]:izALo		=     ; SAC 7/13/20
      {  if (ResProj:CSEVentAvailZonal)
         then  if (ParentComponentType() == "ResZn" .AND. LocalCompAssigned( Outside ) == ComponentType( "ResZn" ))
               then  Area * ValidOr( ResProj:IntSurfHoleSzRatio[1], 0.0005 ) / 2
               else  Area * ValidOr( ResProj:IntSurfHoleSzRatio[2], 0.0005 ) / 2
               endif
         else  Area * 0.00025    endif  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[2]:izHD"				ResIntWall:AirNetPrtySrfIZXFER[2]:izHD			= {	max( Parent( Bottom ), Outside:Bottom ) + (InterCondWallHt * 0.25)  }
	"Set ResIntWall:AirNetPrtySrfIZXFER[2]:izNVEff"			ResIntWall:AirNetPrtySrfIZXFER[2]:izNVEff		= {	 1.0   }
	"Set ResIntWall:AirNetPrtySrfIZXFER[2]:izExp"			ResIntWall:AirNetPrtySrfIZXFER[2]:izExp		= {	 0.65  }
 ;
 ; InteriorFloor inter-party surface hole:
   "Create ResIntFlr:AirNetPrtySrfIZXFER"         ResIntFlr:AirNetPrtySrfIZXFER      =     ; mods to include holes only when both sides Conditioned - SAC 11/30/20
      {  if (Area < 0.1) then  UNCHANGED
      ;   else if (ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( OutsideDiffUnit > 0.5 ))
         else if ( (ParentComponentType() == "ResZn" .OR. ParentComponentType() == "ResOtherZn") .AND.
                   (LocalCompAssigned( Outside ) == ComponentType( "ResZn" ) .OR.
                    LocalCompAssigned( Outside ) == ComponentType( "ResOtherZn" )))
         then  if (IsPartySurface > 0.5 .AND. OtherSideModeled > 0.5 .AND.
                   Parent( Type ) < 10 .AND. Outside:Type < 10)
               then  CreateComp( cseIZXFER, substr( Outside:Name, 0, 28 ) + "PSx" + substr( Name, 0, 28 ) + "PS")
               else  UNCHANGED  endif
         else  UNCHANGED  endif endif  }
	"Set ResIntFlr:AirNetPrtySrfIZXFER:izNVType"	ResIntFlr:AirNetPrtySrfIZXFER:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone     -?->  5  }   ; AIRNETHORIZ - Horizontal (large) opening between two zones
	"Set ResIntFlr:AirNetPrtySrfIZXFER:izZn1"		ResIntFlr:AirNetPrtySrfIZXFER:izZn1		= {	Outside:CSE_ZONE    }
	"Set ResIntFlr:AirNetPrtySrfIZXFER:izZn2"		ResIntFlr:AirNetPrtySrfIZXFER:izZn2		= {	Parent( CSE_ZONE )  }
	"Set ResIntFlr:AirNetPrtySrfIZXFER:izALo"		ResIntFlr:AirNetPrtySrfIZXFER:izALo		=     ; SAC 7/13/20
      {  if (ResProj:CSEVentAvailZonal)
         then  if (ParentComponentType() == "ResZn" .AND. LocalCompAssigned( Outside ) == ComponentType( "ResZn" ))
               then  Area * ValidOr( ResProj:IntSurfHoleSzRatio[1], 0.0005 )
               else  Area * ValidOr( ResProj:IntSurfHoleSzRatio[2], 0.0005 )
               endif
         else  Area * 0.0005    endif  }
	"Set ResIntFlr:AirNetPrtySrfIZXFER:izHD"			ResIntFlr:AirNetPrtySrfIZXFER:izHD			= {	Parent( Bottom )  }
	"Set ResIntFlr:AirNetPrtySrfIZXFER:izNVEff"		ResIntFlr:AirNetPrtySrfIZXFER:izNVEff		= {	1.0   }
	"Set ResIntFlr:AirNetPrtySrfIZXFER:izExp"		ResIntFlr:AirNetPrtySrfIZXFER:izExp		= {	0.65  }
  ; SAC 8/25/14 - added InteriorCeiling IZXFER (based on int flr)
   "Create ResIntCeiling:AirNetPrtySrfIZXFER"         ResIntCeiling:AirNetPrtySrfIZXFER      =    ; mods to include holes only when both sides Conditioned - SAC 11/30/20
      {  if (Area < 0.1) then  UNCHANGED
      ;   else if (ResProj:IsMultiFamily > 0.5 .AND. IfValidAnd( OutsideDiffUnit > 0.5 ))
         else if ( (ParentComponentType() == "ResZn" .OR. ParentComponentType() == "ResOtherZn") .AND.
                   (LocalCompAssigned( Outside ) == ComponentType( "ResZn" ) .OR.
                    LocalCompAssigned( Outside ) == ComponentType( "ResOtherZn" )))
         then  if (IsPartySurface > 0.5 .AND. OtherSideModeled > 0.5 .AND.
                   Parent( Type ) < 10 .AND. Outside:Type < 10)
               then  CreateComp( cseIZXFER, substr( Outside:Name, 0, 28 ) + "PSCx" + substr( Name, 0, 28 ) + "PSC")
               else  UNCHANGED  endif
         else  UNCHANGED  endif endif  }
	"Set ResIntCeiling:AirNetPrtySrfIZXFER:izNVType"	ResIntCeiling:AirNetPrtySrfIZXFER:izNVType	= {	3  }   ; AIRNETIZ - Single opening to another zone     -?->  5  }   ; AIRNETHORIZ - Horizontal (large) opening between two zones
	"Set ResIntCeiling:AirNetPrtySrfIZXFER:izZn1"		ResIntCeiling:AirNetPrtySrfIZXFER:izZn1		= {	Parent( CSE_ZONE )  }
	"Set ResIntCeiling:AirNetPrtySrfIZXFER:izZn2"		ResIntCeiling:AirNetPrtySrfIZXFER:izZn2		= {	Outside:CSE_ZONE    }
	"Set ResIntCeiling:AirNetPrtySrfIZXFER:izALo"		ResIntCeiling:AirNetPrtySrfIZXFER:izALo		=     ; SAC 7/13/20
      {  if (ResProj:CSEVentAvailZonal)
         then  if (ParentComponentType() == "ResZn" .AND. LocalCompAssigned( Outside ) == ComponentType( "ResZn" ))
               then  Area * ValidOr( ResProj:IntSurfHoleSzRatio[1], 0.0005 )
               else  Area * ValidOr( ResProj:IntSurfHoleSzRatio[2], 0.0005 )
               endif
         else  Area * 0.0005    endif  }
	"Set ResIntCeiling:AirNetPrtySrfIZXFER:izHD"		ResIntCeiling:AirNetPrtySrfIZXFER:izHD		= {	Outside:Bottom  }		; Parent( Bottom )  }
	"Set ResIntCeiling:AirNetPrtySrfIZXFER:izNVEff"	ResIntCeiling:AirNetPrtySrfIZXFER:izNVEff	= {	1.0   }
	"Set ResIntCeiling:AirNetPrtySrfIZXFER:izExp"		ResIntCeiling:AirNetPrtySrfIZXFER:izExp		= {	0.65  }

END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Attic_Vented" 1 0 0 0
;*************************************************************************
; SAC 10/17/14 - added logic to scale cool vent CFM by ratio of (cool-ventable) attic volumes
; KN 04/14/2015 Replaced code below to look up attic relief in codebase 
;	"Set ResAttic:AirNet_AtticRelief"	Attic:AirNet_AtticRelief	= {
;														if (ClVentableVolume < 0.1) then  0
;														else if (ResProj:UnitClVentOption == 3)		; CFI Cool Vent
;														then	(ClVentableVolume / SumAll( ResAttic:ClVentableVolume )) * SumAll( ResHVACSys:AirNet_CoolVent   ) / 375
;														else	(ClVentableVolume / SumAll( ResAttic:ClVentableVolume )) * ValidOr( ResProj:UnitClVentCFMTot, 0 ) / 375		endif endif  }
  ; SAC 12/31/15 - added reference to new ResProj:UnitClVenTAreaMult property used to apply reduced attic vent free area (tic #596)
	"Set ResAttic:AirNet_AtticRelief"	ResAttic:AirNet_AtticRelief	= {
														if (ClVentableVolume < 0.1) then  0
														else if (ResProj:UnitClVentOption == 3)		; CFI Cool Vent
														then	(ClVentableVolume / SumAll( ResAttic:ClVentableVolume )) * SumAll( ResHVACSys:AirNet_CoolVent   ) * ResProj:UnitClVenTAreaMult / T24RClimateZoneCodeBase:WHFatticrelief( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )
														else	(ClVentableVolume / SumAll( ResAttic:ClVentableVolume )) * ValidOr( ResProj:UnitClVentCFMTot, 0 ) * ResProj:UnitClVenTAreaMult / T24RClimateZoneCodeBase:WHFatticrelief( "ClimateZone", Proj:CliZnNum, "CodeBase", Proj:StdDesignBase, "BldgType", Proj:BldgTypeTblStr )		endif endif  }

	"Set ResAttic:AirNet_PitchType"		ResAttic:AirNet_PitchType	= {		  if (Local( RoofPitch ) <= 0.00) then  0
																						else if (Local( RoofPitch ) <= 0.18) then  1
																						else if (Local( RoofPitch ) <= 0.27) then  2
																						else if (Local( RoofPitch ) <= 0.47) then  3
																						else if (Local( RoofPitch ) <= 0.70) then  4
																																		 else  5  endif endif endif endif endif  }

	"Set ResAttic:AirNet_AventTot"		ResAttic:AirNet_AventTot	= {	FloorArea * AVentFraction  }	; AceilGross * AVent
	"Set ResAttic:AirNet_SoffitVent"		ResAttic:AirNet_SoffitVent	= {	0.5 * 0.25 * (1.0 - FractionHigh) * max( AirNet_AventTot, AirNet_AtticRelief )  }
	"Set ResAttic:AirNet_DeckVent"		ResAttic:AirNet_DeckVent	= {	0.5 * 0.25 *        FractionHigh  * max( AirNet_AventTot, AirNet_AtticRelief )  }

	"Create ResAttic:AirNetIZXFERs[1] - SU"		ResAttic:AirNetIZXFERs[1]	= {	if (AirNet_SoffitVent <= 0) then  UNCHANGED
																									else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-SU", "Default_AtticIZXFER" )  endif  }
	"Create ResAttic:AirNetIZXFERs[2] - SS"		ResAttic:AirNetIZXFERs[2]	= {	if (AirNet_SoffitVent <= 0) then  UNCHANGED
																									else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-SS", "Default_AtticIZXFER" )  endif  }
	"Create ResAttic:AirNetIZXFERs[3] - SD"		ResAttic:AirNetIZXFERs[3]	= {	if (AirNet_SoffitVent <= 0) then  UNCHANGED
																									else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-SD", "Default_AtticIZXFER" )  endif  }
	"Create ResAttic:AirNetIZXFERs[4] - DU"		ResAttic:AirNetIZXFERs[4]	= {	if (AirNet_DeckVent <= 0) then  UNCHANGED
																									else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-DU", "Default_AtticIZXFER" )  endif  }
	"Create ResAttic:AirNetIZXFERs[5] - DS"		ResAttic:AirNetIZXFERs[5]	= {	if (AirNet_DeckVent <= 0) then  UNCHANGED
																									else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-DS", "Default_AtticIZXFER" )  endif  }
	"Create ResAttic:AirNetIZXFERs[6] - DD"		ResAttic:AirNetIZXFERs[6]	= {	if (AirNet_DeckVent <= 0) then  UNCHANGED
																									else  CreateComp( cseIZXFER, substr( Name, 0, 48 ) + "-DD", "Default_AtticIZXFER" )  endif  }

	"Set ResAttic:AirNetIZXFERs[1]:izZn1 - SU"		ResAttic:AirNetIZXFERs[1]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResAttic:AirNetIZXFERs[2]:izZn1 - SS"		ResAttic:AirNetIZXFERs[2]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResAttic:AirNetIZXFERs[3]:izZn1 - SD"		ResAttic:AirNetIZXFERs[3]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResAttic:AirNetIZXFERs[4]:izZn1 - DU"		ResAttic:AirNetIZXFERs[4]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResAttic:AirNetIZXFERs[5]:izZn1 - DS"		ResAttic:AirNetIZXFERs[5]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResAttic:AirNetIZXFERs[6]:izZn1 - DD"		ResAttic:AirNetIZXFERs[6]:izZn1	= {	Local( CSE_ZONE )  }

	"Set ResAttic:AirNetIZXFERs[1]:izALo - SU"		ResAttic:AirNetIZXFERs[1]:izALo	= {	Local( AirNet_SoffitVent )      }
	"Set ResAttic:AirNetIZXFERs[2]:izALo - SS"		ResAttic:AirNetIZXFERs[2]:izALo	= {	Local( AirNet_SoffitVent ) * 2  }
	"Set ResAttic:AirNetIZXFERs[3]:izALo - SD"		ResAttic:AirNetIZXFERs[3]:izALo	= {	Local( AirNet_SoffitVent )      }
	"Set ResAttic:AirNetIZXFERs[4]:izALo - DU"		ResAttic:AirNetIZXFERs[4]:izALo	= {	Local( AirNet_DeckVent   )      }
	"Set ResAttic:AirNetIZXFERs[5]:izALo - DS"		ResAttic:AirNetIZXFERs[5]:izALo	= {	Local( AirNet_DeckVent   ) * 2  }
	"Set ResAttic:AirNetIZXFERs[6]:izALo - DD"		ResAttic:AirNetIZXFERs[6]:izALo	= {	Local( AirNet_DeckVent   )      }

	"Set ResAttic:AirNetIZXFERs[1]:izHD - SU"			ResAttic:AirNetIZXFERs[1]:izHD	= {	max( 0.1, Local( Bottom ) )  }
	"Set ResAttic:AirNetIZXFERs[2]:izHD - SS"			ResAttic:AirNetIZXFERs[2]:izHD	= {	max( 0.1, Local( Bottom ) )  }
	"Set ResAttic:AirNetIZXFERs[3]:izHD - SD"			ResAttic:AirNetIZXFERs[3]:izHD	= {	max( 0.1, Local( Bottom ) )  }
	"Set ResAttic:AirNetIZXFERs[4]:izHD - DU"			ResAttic:AirNetIZXFERs[4]:izHD	= {	max( 0.1, Local( Bottom ) + (Local( Height ) * 0.67) )  }
	"Set ResAttic:AirNetIZXFERs[5]:izHD - DS"			ResAttic:AirNetIZXFERs[5]:izHD	= {	max( 0.1, Local( Bottom ) + (Local( Height ) * 0.67) )  }
	"Set ResAttic:AirNetIZXFERs[6]:izHD - DD"			ResAttic:AirNetIZXFERs[6]:izHD	= {	max( 0.1, Local( Bottom ) + (Local( Height ) * 0.67) )  }

	"Set ResAttic:AirNetIZXFERs[4]:izExp - DU"		ResAttic:AirNetIZXFERs[4]:izExp	= {	0.5  }
	"Set ResAttic:AirNetIZXFERs[5]:izExp - DS"		ResAttic:AirNetIZXFERs[5]:izExp	= {	0.5  }
	"Set ResAttic:AirNetIZXFERs[6]:izExp - DD"		ResAttic:AirNetIZXFERs[6]:izExp	= {	0.5  }

	"Set ResAttic:AirNetIZXFERs[2]:izCpr - SS"		ResAttic:AirNetIZXFERs[2]:izCpr	= {	-0.65  }
	"Set ResAttic:AirNetIZXFERs[3]:izCpr - SD"		ResAttic:AirNetIZXFERs[3]:izCpr	= {	-0.30  }
	"Set ResAttic:AirNetIZXFERs[4]:izCpr - DU"		ResAttic:AirNetIZXFERs[4]:izCpr	= {	switch( Local( AirNet_PitchType ) )
																													case 0 : -0.5		case 1 : -0.8		case 2 : -0.5
																													case 3 : -0.3		case 4 :  0.1		case 5 :  0.3
																													default : 0.0		endswitch  }
	"Set ResAttic:AirNetIZXFERs[5]:izCpr - DS"		ResAttic:AirNetIZXFERs[5]:izCpr	= {	-0.5  }
	"Set ResAttic:AirNetIZXFERs[6]:izCpr - DD"		ResAttic:AirNetIZXFERs[6]:izCpr	= {	switch( Local( AirNet_PitchType ) )
																													case  1 : -0.3
																													default : -0.5		endswitch  }
END

;*************************************************************************
RULELIST "SimPrep_CSE_AirNet_Attic_Conditioned" 1 0 0 0
;*************************************************************************
	"Create ResAttic:AirNetIZXFERs[1] - U"				ResAttic:AirNetIZXFERs[1]			= {	CreateComp( cseIZXFER, substr( Name, 0, 48 ) +  "-U", "Default_AtticIZXFER" )  }
	"Create ResAttic:AirNetIZXFERs[2] - S"				ResAttic:AirNetIZXFERs[2]			= {	CreateComp( cseIZXFER, substr( Name, 0, 48 ) +  "-S", "Default_AtticIZXFER" )  }
	"Create ResAttic:AirNetIZXFERs[3] - D"				ResAttic:AirNetIZXFERs[3]			= {	CreateComp( cseIZXFER, substr( Name, 0, 48 ) +  "-D", "Default_AtticIZXFER" )  }

	"Set ResAttic:AirNetIZXFERs[1]:izZn1 - U"			ResAttic:AirNetIZXFERs[1]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResAttic:AirNetIZXFERs[2]:izZn1 - S"			ResAttic:AirNetIZXFERs[2]:izZn1	= {	Local( CSE_ZONE )  }
	"Set ResAttic:AirNetIZXFERs[3]:izZn1 - D"			ResAttic:AirNetIZXFERs[3]:izZn1	= {	Local( CSE_ZONE )  }

	"Set ResAttic:AirNetIZXFERs[1]:izALo - U"			ResAttic:AirNetIZXFERs[1]:izALo	= {	ResProj:BldgELA_CeilSF * FloorArea * 1.45 * 0.25  }
	"Set ResAttic:AirNetIZXFERs[2]:izALo - S"			ResAttic:AirNetIZXFERs[2]:izALo	= {	ResProj:BldgELA_CeilSF * FloorArea * 1.45 * 0.5   }
	"Set ResAttic:AirNetIZXFERs[3]:izALo - D"			ResAttic:AirNetIZXFERs[3]:izALo	= {	ResProj:BldgELA_CeilSF * FloorArea * 1.45 * 0.25  }

	"Set ResAttic:AirNetIZXFERs[1]:izHD - U"			ResAttic:AirNetIZXFERs[1]:izHD	= {	max( 0.1, Local( Bottom ) )  }
	"Set ResAttic:AirNetIZXFERs[2]:izHD - S"			ResAttic:AirNetIZXFERs[2]:izHD	= {	max( 0.1, Local( Bottom ) )  }
	"Set ResAttic:AirNetIZXFERs[3]:izHD - D"			ResAttic:AirNetIZXFERs[3]:izHD	= {	max( 0.1, Local( Bottom ) )  }

	"Set ResAttic:AirNetIZXFERs[1]:izNVEff - U"		ResAttic:AirNetIZXFERs[1]:izNVEff ={	1  }
	"Set ResAttic:AirNetIZXFERs[2]:izNVEff - S"		ResAttic:AirNetIZXFERs[2]:izNVEff ={	1  }
	"Set ResAttic:AirNetIZXFERs[3]:izNVEff - D"		ResAttic:AirNetIZXFERs[3]:izNVEff ={	1  }

	"Set ResAttic:AirNetIZXFERs[2]:izCpr - S"			ResAttic:AirNetIZXFERs[2]:izCpr	= {	-0.65  }
	"Set ResAttic:AirNetIZXFERs[3]:izCpr - D"			ResAttic:AirNetIZXFERs[3]:izCpr	= {	-0.30  }
END


;*************************************************************************
RULELIST "Set_ZoneIAQ_SFam"  0 0 0 0
;*************************************************************************
	"Init ResZn:IAQCFM_Exhaust[1]"		ResZn:IAQCFM_Exhaust[1]	= {	0  }
	"Init ResZn:IAQPwr_Exhaust[1]"		ResZn:IAQPwr_Exhaust[1]	= {	0  }
	"Init ResZn:IAQCFM_Supply[1]"		ResZn:IAQCFM_Supply[1]	= {	0  }
	"Init ResZn:IAQPwr_Supply[1]"		ResZn:IAQPwr_Supply[1]	= {	0  }
   "Init ResZn:IAQHRVCFM[1]"  			ResZn:IAQHRVCFM[1]			= {	0  }		; SAC 5/20/13
   "Init ResZn:IAQHRVPwr[1]"  			ResZn:IAQHRVPwr[1]			= {	0  }
   "Init ResZn:IAQBalCFM[1]"  			ResZn:IAQBalCFM[1]			= {	0  }		; SAC 7/25/20
   "Init ResZn:IAQBalPwr[1]"  			ResZn:IAQBalPwr[1]			= {	0  }
   "Init ResZn:IAQHRVCFMxRcvEff[1]"  ResZn:IAQHRVCFMxRcvEff[1] ={	0  }
   "Init ResZn:IAQHRVCFMxSRE[1]"  ResZn:IAQHRVCFMxSRE[1] ={	0  }
   "Init ResZn:IAQHRVCFMxASRE[1]"  ResZn:IAQHRVCFMxASRE[1] ={	0  }

	"Init ResZn:IAQCFM_Exhaust[2]"		ResZn:IAQCFM_Exhaust[2]	= {	0  }
	"Init ResZn:IAQPwr_Exhaust[2]"		ResZn:IAQPwr_Exhaust[2]	= {	0  }
	"Init ResZn:IAQCFM_Supply[2]"		ResZn:IAQCFM_Supply[2]	= {	0  }
	"Init ResZn:IAQPwr_Supply[2]"		ResZn:IAQPwr_Supply[2]	= {	0  }
   "Init ResZn:IAQHRVCFM[2]"  			ResZn:IAQHRVCFM[2]			= {	0  }		; SAC 5/20/13
   "Init ResZn:IAQHRVPwr[2]"  			ResZn:IAQHRVPwr[2]			= {	0  }
   "Init ResZn:IAQBalCFM[2]"  			ResZn:IAQBalCFM[2]			= {	0  }		; SAC 7/25/20
   "Init ResZn:IAQBalPwr[2]"  			ResZn:IAQBalPwr[2]			= {	0  }
   "Init ResZn:IAQHRVCFMxRcvEff[2]"  ResZn:IAQHRVCFMxRcvEff[2] ={	0  }
   "Init ResZn:IAQHRVCFMxSRE[2]"  ResZn:IAQHRVCFMxSRE[2] ={	0  }
   "Init ResZn:IAQHRVCFMxASRE[2]"  ResZn:IAQHRVCFMxASRE[2] ={	0  }

	"Setup remaining IAQ if not disabled"	ResProj:Action	= {	if (IAQDisabled < 0.5) then  EvalRulelist( "Set_ZoneIAQ_SFam_Details" )  else  UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "Set_ZoneIAQ_SFam_Details"  0 0 0 0
   "Set ResProj:ForceStdIAQFanPwr"  ResProj:ForceStdIAQFanPwr =   ; SAC 09/01/20   ; added logic to reference ResProj:StdDesignIAQFanPwr[1] - SAC 04/02/21   ; ApplyStdDesignIAQFromTable - SAC 04/03/21
      {  if (ResProj:ApplyStdDesignIAQFromTable .AND. ResProj:StdDesignFuel >= 11 .AND.
             IfValidAnd( ResProj:StdDesignIAQFanPwr[1] > 0 ))
         then  ResProj:StdDesignIAQFanPwr[1]
         else if (IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 ) .AND.
                  IfValidAnd( StdDesignIAQWperCFM > 0 ) .AND. LocalStatus( StdDesignIAQWperCFM ) > 5 .AND.
                  (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf" .OR. (RunAbbrev == "dr" .AND. IfValidAnd( ApplyStdIAQMaxPwrToDRtg > 0 ))))
         then  StdDesignIAQWperCFM
         else  UNDEFINED  endif endif  }
   "Set ResProj:UseMaxIAQFanPwr"    ResProj:UseMaxIAQFanPwr =     ; SAC 08/28/20
      {  if (IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( StdDesignIAQWperCFM > 0 ) .AND.
             (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf" .OR. (RunAbbrev == "dr" .AND. IfValidAnd( ApplyStdIAQMaxPwrToDRtg > 0 ))))
         then  StdDesignIAQWperCFM  else  9999  endif  }
  ; Fan #1
   ; SAC 8/12/16 - revised rules to reference new ResProj:DefaultSimIAQCFM, in place of ResProj:UnitMinIAQCFM[1], to use proper simulated value for addition alone analyses (tic #729) 
   ; added reference to new UnitIAQFan*[*]:FanHeatRecovMult & FanPowerMult - SAC 7/20/20 (tic #1174)
   ; revised to reference StdDesignIAQType, StdDesignIAQCFM & StdIAQCFMScaleFactor when BypassRuleLimits activated - SAC 08/27/20
   "Set ResProj:UnitIAQZone1[1]:IAQCFM_Exhaust[1]"    ResProj:UnitIAQZone1[1]:IAQCFM_Exhaust[1]   =      ; added AllowStdDesignFuel logic - SAC 04/02/21   ; ApplyStdDesignIAQFromTable - SAC 04/03/21
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] = 1 ))
               then  if (IfValidAnd( StdDesignIAQCFM[1] > 0 ))
                     then  StdDesignIAQCFM[1]
                     else  ValidOr( StdIAQCFMScaleFactor[1], 1 ) * ValidOr( MinUnbalIAQCFM[1], 0 )
                     endif
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 1) then  DefaultSimIAQCFM[1]
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5)
         then   if (UnitIAQFan1[1]:IAQFanType == 1) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1]  else  UNCHANGED  endif
         else   UNCHANGED  endif endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQPwr_Exhaust[1]"    ResProj:UnitIAQZone1[1]:IAQPwr_Exhaust[1]   =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] = 1 ))
               then  UnitIAQZone1[1]:IAQCFM_Exhaust[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, min( DefaultIAQFanPwr, ValidOr( StdDesignIAQWperCFM, 9999 ) ) ) )
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 1) then  DefaultSimIAQCFM[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, ResProj:DefaultIAQFanPwr ) )
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5)
         then   if (UnitIAQFan1[1]:IAQFanType == 1) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan1[1]:WperCFMIAQ ) ) * UnitIAQFan1[1]:FanPowerMult  else  UNCHANGED  endif
         else   UNCHANGED  endif endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQCFM_Supply[1]"     ResProj:UnitIAQZone1[1]:IAQCFM_Supply[1]   =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] = 2 ))
               then  if (IfValidAnd( StdDesignIAQCFM[1] > 0 ))
                     then  StdDesignIAQCFM[1]
                     else  ValidOr( StdIAQCFMScaleFactor[1], 1 ) * ValidOr( MinUnbalIAQCFM[1], 0 )
                     endif
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5)
         then   if (UnitIAQFan1[1]:IAQFanType == 2) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1]  else  UNCHANGED  endif
         else   UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQPwr_Supply[1]"     ResProj:UnitIAQZone1[1]:IAQPwr_Supply[1]   =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] = 2 ))
               then  UnitIAQZone1[1]:IAQCFM_Supply[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, min( DefaultIAQFanPwr, ValidOr( StdDesignIAQWperCFM, 9999 ) ) ) )
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5)
         then   if (UnitIAQFan1[1]:IAQFanType == 2) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan1[1]:WperCFMIAQ ) ) * UnitIAQFan1[1]:FanPowerMult  else  UNCHANGED  endif
         else   UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQHRVCFM[1]"           ResProj:UnitIAQZone1[1]:IAQHRVCFM[1]      =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] >= 3 ))
               then  if (IfValidAnd( StdDesignIAQCFM[1] > 0 ))
                     then  StdDesignIAQCFM[1]
                     else  ValidOr( StdIAQCFMScaleFactor[1], 1 ) * ValidOr( MinBalancedIAQCFM[1], 0 )
                     endif
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5)
         then   if (UnitIAQFan1[1]:IAQFanType == 3) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1]  else  UNCHANGED  endif
         else   UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQHRVPwr[1]"           ResProj:UnitIAQZone1[1]:IAQHRVPwr[1]      =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] >= 3 ))
               then  UnitIAQZone1[1]:IAQHRVCFM[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, min( 0.6, ValidOr( StdDesignIAQWperCFM, 9999 ) ) ) )
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5)
         then   if (UnitIAQFan1[1]:IAQFanType == 3) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan1[1]:WperCFMIAQ ) ) * UnitIAQFan1[1]:FanPowerMult  else  UNCHANGED  endif
         else   UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQBalCFM[1]"           ResProj:UnitIAQZone1[1]:IAQBalCFM[1]      =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] >= 3 ))
               then  if (IfValidAnd( StdDesignIAQCFM[1] > 0 ))
                     then  StdDesignIAQCFM[1]
                     else  ValidOr( StdIAQCFMScaleFactor[1], 1 ) * ValidOr( MinBalancedIAQCFM[1], 0 )
                     endif
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan1[1]:IAQFanType = 3 ) .AND.
             ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan1[1]:IAQRecovEffect = 0 )) .OR.
               (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan1[1]:IncludesRecov  = 0 )) ))
         then  UnitIAQZone1[1]:IAQBalCFM[1]  + (UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1])
         else  UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQBalPwr[1]"           ResProj:UnitIAQZone1[1]:IAQBalPwr[1]      =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] >= 3 ))
               then  UnitIAQZone1[1]:IAQBalCFM[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, min( 0.6, ValidOr( StdDesignIAQWperCFM, 9999 ) ) ) )
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan1[1]:IAQFanType = 3 ) .AND.
             ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan1[1]:IAQRecovEffect = 0 )) .OR.
               (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan1[1]:IncludesRecov  = 0 )) ))
         then   UnitIAQZone1[1]:IAQBalPwr[1]  + (UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan1[1]:WperCFMIAQ ) ) * UnitIAQFan1[1]:FanPowerMult)
         else  UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQHRVCFMxRcvEff[1]"  ResProj:UnitIAQZone1[1]:IAQHRVCFMxRcvEff[1]   =
      {  if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
         then   if (UnitIAQFan1[1]:IAQFanType == 3) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * UnitIAQFan1[1]:IAQRecovEffect  else  UNCHANGED  endif
         else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQHRVCFMxSRE[1]"  ResProj:UnitIAQZone1[1]:IAQHRVCFMxSRE[1]   =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] = 4 ) .AND. IfValidAnd( StdIAQHtRec_SRE[1] > 0 ) .AND. IfValidAnd( StdIAQHtRec_ASRE[1] > 0 ))
               then  UnitIAQZone1[1]:IAQHRVCFM[1] * StdIAQHtRec_SRE[1]
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan1[1]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan1[1]:IncludesRecov > 0 )))
         then   if (UnitIAQFan1[1]:IAQFanType == 3) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * UnitIAQFan1[1]:SensRecovEff * UnitIAQFan1[1]:FanHeatRecovMult  else  UNCHANGED  endif
         else   UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[1]:IAQHRVCFMxASRE[1]"  ResProj:UnitIAQZone1[1]:IAQHRVCFMxASRE[1]   =
      {  if (UnitIAQOption[1] == 1 .AND. ((IfValidAnd( BypassRuleLimits > 0 ) .AND. IfValidAnd( AnalysisVersion >= 190200 )) .OR. ResProj:ApplyStdDesignIAQFromTable) .AND.
             IfValidAnd( StdDesignIAQType[1] > 0 ) .AND. (RunAbbrev == "s" .OR. RunAbbrev == "zb" .OR. RunAbbrev == "smf"))
         then  if (IfValidAnd( StdDesignIAQType[1] = 4 ) .AND. IfValidAnd( StdIAQHtRec_SRE[1] > 0 ) .AND. IfValidAnd( StdIAQHtRec_ASRE[1] > 0 ))
               then  UnitIAQZone1[1]:IAQHRVCFM[1] * StdIAQHtRec_ASRE[1]
               else  UNCHANGED
               endif
         else if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan1[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan1[1]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan1[1]:IncludesRecov > 0 )))
         then   if (UnitIAQFan1[1]:IAQFanType == 3) then  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * UnitIAQFan1[1]:AdjSensRecovEff * UnitIAQFan1[1]:FanHeatRecovMult  else  UNCHANGED  endif
         else   UNCHANGED  endif endif  }
  ; Fan #2
   "Set ResProj:UnitIAQZone2[1]:IAQCFM_Exhaust[1]"    ResProj:UnitIAQZone2[1]:IAQCFM_Exhaust[1]   = {   if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5)
                                                                                          then   if (UnitIAQFan2[1]:IAQFanType == 1) then  UnitIAQZone2[1]:IAQCFM_Exhaust[1] + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1])  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQPwr_Exhaust[1]"    ResProj:UnitIAQZone2[1]:IAQPwr_Exhaust[1]   = {   if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5)
                                                                                          then   if (UnitIAQFan2[1]:IAQFanType == 1) then  UnitIAQZone2[1]:IAQPwr_Exhaust[1] + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan2[1]:WperCFMIAQ ) ) * UnitIAQFan2[1]:FanPowerMult)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQCFM_Supply[1]"     ResProj:UnitIAQZone2[1]:IAQCFM_Supply[1]   = {   if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5)
                                                                                          then   if (UnitIAQFan2[1]:IAQFanType == 2) then  UnitIAQZone2[1]:IAQCFM_Supply[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1])  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQPwr_Supply[1]"     ResProj:UnitIAQZone2[1]:IAQPwr_Supply[1]   = {   if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5)
                                                                                          then   if (UnitIAQFan2[1]:IAQFanType == 2) then  UnitIAQZone2[1]:IAQPwr_Supply[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan2[1]:WperCFMIAQ ) ) * UnitIAQFan2[1]:FanPowerMult)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQHRVCFM[1]"  			ResProj:UnitIAQZone2[1]:IAQHRVCFM[1]		= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5)
																														then	if (UnitIAQFan2[1]:IAQFanType == 3) then  UnitIAQZone2[1]:IAQHRVCFM[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQHRVPwr[1]"  			ResProj:UnitIAQZone2[1]:IAQHRVPwr[1]		= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5)
																														then	if (UnitIAQFan2[1]:IAQFanType == 3) then  UnitIAQZone2[1]:IAQHRVPwr[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan2[1]:WperCFMIAQ ) ) * UnitIAQFan2[1]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQBalCFM[1]"  			ResProj:UnitIAQZone2[1]:IAQBalCFM[1]		= {	if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan2[1]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan2[1]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan2[1]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone2[1]:IAQBalCFM[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1])  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQBalPwr[1]"  			ResProj:UnitIAQZone2[1]:IAQBalPwr[1]		= {	if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan2[1]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan2[1]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan2[1]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone2[1]:IAQBalPwr[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan2[1]:WperCFMIAQ ) ) * UnitIAQFan2[1]:FanPowerMult)  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQHRVCFMxRcvEff[1]"  ResProj:UnitIAQZone2[1]:IAQHRVCFMxRcvEff[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
																														then	if (UnitIAQFan2[1]:IAQFanType == 3) then  UnitIAQZone2[1]:IAQHRVCFMxRcvEff[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * UnitIAQFan2[1]:IAQRecovEffect)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQHRVCFMxSRE[1]"  ResProj:UnitIAQZone2[1]:IAQHRVCFMxSRE[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan2[1]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan2[1]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan2[1]:IAQFanType == 3) then  UnitIAQZone2[1]:IAQHRVCFMxSRE[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * UnitIAQFan2[1]:SensRecovEff * UnitIAQFan2[1]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[1]:IAQHRVCFMxASRE[1]"  ResProj:UnitIAQZone2[1]:IAQHRVCFMxASRE[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan2[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan2[1]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan2[1]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan2[1]:IAQFanType == 3) then  UnitIAQZone2[1]:IAQHRVCFMxASRE[1]  + (UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * UnitIAQFan2[1]:AdjSensRecovEff * UnitIAQFan2[1]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
  ; Fan #3
   "Set ResProj:UnitIAQZone3[1]:IAQCFM_Exhaust[1]" 	ResProj:UnitIAQZone3[1]:IAQCFM_Exhaust[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5)
																														then	if (UnitIAQFan3[1]:IAQFanType == 1) then  UnitIAQZone3[1]:IAQCFM_Exhaust[1] + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQPwr_Exhaust[1]" 	ResProj:UnitIAQZone3[1]:IAQPwr_Exhaust[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5)
																														then	if (UnitIAQFan3[1]:IAQFanType == 1) then  UnitIAQZone3[1]:IAQPwr_Exhaust[1] + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan3[1]:WperCFMIAQ ) ) * UnitIAQFan3[1]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQCFM_Supply[1]"  	ResProj:UnitIAQZone3[1]:IAQCFM_Supply[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5)
																														then	if (UnitIAQFan3[1]:IAQFanType == 2) then  UnitIAQZone3[1]:IAQCFM_Supply[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQPwr_Supply[1]"  	ResProj:UnitIAQZone3[1]:IAQPwr_Supply[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5)
																														then	if (UnitIAQFan3[1]:IAQFanType == 2) then  UnitIAQZone3[1]:IAQPwr_Supply[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan3[1]:WperCFMIAQ ) ) * UnitIAQFan3[1]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQHRVCFM[1]"  			ResProj:UnitIAQZone3[1]:IAQHRVCFM[1]		= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5)
																														then	if (UnitIAQFan3[1]:IAQFanType == 3) then  UnitIAQZone3[1]:IAQHRVCFM[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQHRVPwr[1]"  			ResProj:UnitIAQZone3[1]:IAQHRVPwr[1]		= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5)
																														then	if (UnitIAQFan3[1]:IAQFanType == 3) then  UnitIAQZone3[1]:IAQHRVPwr[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan3[1]:WperCFMIAQ ) ) * UnitIAQFan3[1]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQBalCFM[1]"  			ResProj:UnitIAQZone3[1]:IAQBalCFM[1]		= {	if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan3[1]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan3[1]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan3[1]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone3[1]:IAQBalCFM[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1])  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQBalPwr[1]"  			ResProj:UnitIAQZone3[1]:IAQBalPwr[1]		= {	if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan3[1]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan3[1]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan3[1]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone3[1]:IAQBalPwr[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan3[1]:WperCFMIAQ ) ) * UnitIAQFan3[1]:FanPowerMult)  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQHRVCFMxRcvEff[1]"  ResProj:UnitIAQZone3[1]:IAQHRVCFMxRcvEff[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
																														then	if (UnitIAQFan3[1]:IAQFanType == 3) then  UnitIAQZone3[1]:IAQHRVCFMxRcvEff[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * UnitIAQFan3[1]:IAQRecovEffect)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQHRVCFMxSRE[1]"  ResProj:UnitIAQZone3[1]:IAQHRVCFMxSRE[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan3[1]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan3[1]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan3[1]:IAQFanType == 3) then  UnitIAQZone3[1]:IAQHRVCFMxSRE[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * UnitIAQFan3[1]:SensRecovEff * UnitIAQFan3[1]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[1]:IAQHRVCFMxASRE[1]"  ResProj:UnitIAQZone3[1]:IAQHRVCFMxASRE[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan3[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan3[1]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan3[1]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan3[1]:IAQFanType == 3) then  UnitIAQZone3[1]:IAQHRVCFMxASRE[1]  + (UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * UnitIAQFan3[1]:AdjSensRecovEff * UnitIAQFan3[1]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
  ; Fan #4
   "Set ResProj:UnitIAQZone4[1]:IAQCFM_Exhaust[1]" 	ResProj:UnitIAQZone4[1]:IAQCFM_Exhaust[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5)
																														then	if (UnitIAQFan4[1]:IAQFanType == 1) then  UnitIAQZone4[1]:IAQCFM_Exhaust[1] + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQPwr_Exhaust[1]" 	ResProj:UnitIAQZone4[1]:IAQPwr_Exhaust[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5)
																														then	if (UnitIAQFan4[1]:IAQFanType == 1) then  UnitIAQZone4[1]:IAQPwr_Exhaust[1] + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan4[1]:WperCFMIAQ ) ) * UnitIAQFan4[1]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQCFM_Supply[1]"  	ResProj:UnitIAQZone4[1]:IAQCFM_Supply[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5)
																														then	if (UnitIAQFan4[1]:IAQFanType == 2) then  UnitIAQZone4[1]:IAQCFM_Supply[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQPwr_Supply[1]"  	ResProj:UnitIAQZone4[1]:IAQPwr_Supply[1]	= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5)
																														then	if (UnitIAQFan4[1]:IAQFanType == 2) then  UnitIAQZone4[1]:IAQPwr_Supply[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan4[1]:WperCFMIAQ ) ) * UnitIAQFan4[1]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQHRVCFM[1]"  			ResProj:UnitIAQZone4[1]:IAQHRVCFM[1]		= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5)
																														then	if (UnitIAQFan4[1]:IAQFanType == 3) then  UnitIAQZone4[1]:IAQHRVCFM[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQHRVPwr[1]"  			ResProj:UnitIAQZone4[1]:IAQHRVPwr[1]		= {	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5)
																														then	if (UnitIAQFan4[1]:IAQFanType == 3) then  UnitIAQZone4[1]:IAQHRVPwr[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan4[1]:WperCFMIAQ ) ) * UnitIAQFan4[1]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQBalCFM[1]"  			ResProj:UnitIAQZone4[1]:IAQBalCFM[1]		= {	if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan4[1]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan4[1]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan4[1]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone4[1]:IAQBalCFM[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1])  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQBalPwr[1]"  			ResProj:UnitIAQZone4[1]:IAQBalPwr[1]		= {	if (UnitIAQOption[1] == 2 .AND. IfValidAnd( UnitIAQFan4[1]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan4[1]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan4[1]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone4[1]:IAQBalPwr[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * ValidOr( ForceStdIAQFanPwr, min( UseMaxIAQFanPwr, UnitIAQFan4[1]:WperCFMIAQ ) ) * UnitIAQFan4[1]:FanPowerMult)  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQHRVCFMxRcvEff[1]"  ResProj:UnitIAQZone4[1]:IAQHRVCFMxRcvEff[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
																														then	if (UnitIAQFan4[1]:IAQFanType == 3) then  UnitIAQZone4[1]:IAQHRVCFMxRcvEff[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * UnitIAQFan4[1]:IAQRecovEffect)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQHRVCFMxSRE[1]"  ResProj:UnitIAQZone4[1]:IAQHRVCFMxSRE[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan4[1]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan4[1]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan4[1]:IAQFanType == 3) then  UnitIAQZone4[1]:IAQHRVCFMxSRE[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * UnitIAQFan4[1]:SensRecovEff * UnitIAQFan4[1]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[1]:IAQHRVCFMxASRE[1]"  ResProj:UnitIAQZone4[1]:IAQHRVCFMxASRE[1]	={	if (UnitIAQOption[1] == 2 .AND. LocalCompAssigned( UnitIAQFan4[1] ) > 0.5 .AND. IfValidAnd( UnitIAQFan4[1]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan4[1]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan4[1]:IAQFanType == 3) then  UnitIAQZone4[1]:IAQHRVCFMxASRE[1]  + (UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * UnitIAQFan4[1]:AdjSensRecovEff * UnitIAQFan4[1]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }

   ;----------------------------------------------------------------------------
   ; SAC 4/22/19 - add in ADU IAQ (tic #1010)
  ; Fan #1
   ; SAC 8/12/16 - revised rules to reference new ResProj:DefaultSimIAQCFM, in place of ResProj:UnitMinIAQCFM[1], to use proper simulated value for addition alone analyses (tic #729) 
   "Set ResProj:UnitIAQZone1[2]:IAQCFM_Exhaust[2]"    ResProj:UnitIAQZone1[2]:IAQCFM_Exhaust[2]   = {   if (UnitIAQOption[2] == 1) then  DefaultSimIAQCFM[2]
                                                                                          else if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5)
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 1) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2])  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQPwr_Exhaust[2]"    ResProj:UnitIAQZone1[2]:IAQPwr_Exhaust[2]   = {   if (UnitIAQOption[2] == 1) then  (DefaultSimIAQCFM[2] * ResProj:DefaultIAQFanPwr)
                                                                                          else if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5)
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 1) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * UnitIAQFan1[2]:WperCFMIAQ * UnitIAQFan1[2]:FanPowerMult)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQCFM_Supply[2]"     ResProj:UnitIAQZone1[2]:IAQCFM_Supply[2]   = {   if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5)
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 2) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2])  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQPwr_Supply[2]"     ResProj:UnitIAQZone1[2]:IAQPwr_Supply[2]   = {   if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5)
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 2) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * UnitIAQFan1[2]:WperCFMIAQ * UnitIAQFan1[2]:FanPowerMult)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQHRVCFM[2]"           ResProj:UnitIAQZone1[2]:IAQHRVCFM[2]      = {   if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5)
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 3) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2])  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQHRVPwr[2]"           ResProj:UnitIAQZone1[2]:IAQHRVPwr[2]      = {   if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5)
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 3) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * UnitIAQFan1[2]:WperCFMIAQ * UnitIAQFan1[2]:FanPowerMult)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQBalCFM[2]"           ResProj:UnitIAQZone1[2]:IAQBalCFM[2]      = {   if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan1[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan1[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan1[2]:IncludesRecov  = 0 )) ))
                                                                                          then   UnitIAQZone1[2]:IAQBalCFM[2]  + (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2])  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQBalPwr[2]"           ResProj:UnitIAQZone1[2]:IAQBalPwr[2]      = {   if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan1[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan1[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan1[2]:IncludesRecov  = 0 )) ))
                                                                                          then   UnitIAQZone1[2]:IAQBalPwr[2]  + (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * UnitIAQFan1[2]:WperCFMIAQ * UnitIAQFan1[2]:FanPowerMult)  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQHRVCFMxRcvEff[2]"  ResProj:UnitIAQZone1[2]:IAQHRVCFMxRcvEff[2]   ={   if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 3) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * UnitIAQFan1[2]:IAQRecovEffect)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQHRVCFMxSRE[2]"  ResProj:UnitIAQZone1[2]:IAQHRVCFMxSRE[2]   ={   if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan1[2]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan1[2]:IncludesRecov > 0 )))
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 3) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * UnitIAQFan1[2]:SensRecovEff * UnitIAQFan1[2]:FanHeatRecovMult)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone1[2]:IAQHRVCFMxASRE[2]"  ResProj:UnitIAQZone1[2]:IAQHRVCFMxASRE[2]   ={   if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan1[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan1[2]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan1[2]:IncludesRecov > 0 )))
                                                                                          then   if (UnitIAQFan1[2]:IAQFanType == 3) then  (UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * UnitIAQFan1[2]:AdjSensRecovEff * UnitIAQFan1[2]:FanHeatRecovMult)  else  UNCHANGED  endif
                                                                                          else   UNCHANGED  endif  }
  ; Fan #2
   "Set ResProj:UnitIAQZone2[2]:IAQCFM_Exhaust[2]" 	ResProj:UnitIAQZone2[2]:IAQCFM_Exhaust[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5)
																														then	if (UnitIAQFan2[2]:IAQFanType == 1) then  UnitIAQZone2[2]:IAQCFM_Exhaust[2] + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQPwr_Exhaust[2]" 	ResProj:UnitIAQZone2[2]:IAQPwr_Exhaust[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5)
																														then	if (UnitIAQFan2[2]:IAQFanType == 1) then  UnitIAQZone2[2]:IAQPwr_Exhaust[2] + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * UnitIAQFan2[2]:WperCFMIAQ * UnitIAQFan2[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQCFM_Supply[2]"  	ResProj:UnitIAQZone2[2]:IAQCFM_Supply[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5)
																														then	if (UnitIAQFan2[2]:IAQFanType == 2) then  UnitIAQZone2[2]:IAQCFM_Supply[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQPwr_Supply[2]"  	ResProj:UnitIAQZone2[2]:IAQPwr_Supply[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5)
																														then	if (UnitIAQFan2[2]:IAQFanType == 2) then  UnitIAQZone2[2]:IAQPwr_Supply[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * UnitIAQFan2[2]:WperCFMIAQ * UnitIAQFan2[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQHRVCFM[2]"  			ResProj:UnitIAQZone2[2]:IAQHRVCFM[2]		= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5)
																														then	if (UnitIAQFan2[2]:IAQFanType == 3) then  UnitIAQZone2[2]:IAQHRVCFM[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQHRVPwr[2]"  			ResProj:UnitIAQZone2[2]:IAQHRVPwr[2]		= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5)
																														then	if (UnitIAQFan2[2]:IAQFanType == 3) then  UnitIAQZone2[2]:IAQHRVPwr[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * UnitIAQFan2[2]:WperCFMIAQ * UnitIAQFan2[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQBalCFM[2]"  			ResProj:UnitIAQZone2[2]:IAQBalCFM[2]		= {	if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan2[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan2[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan2[2]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone2[2]:IAQBalCFM[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2])  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQBalPwr[2]"  			ResProj:UnitIAQZone2[2]:IAQBalPwr[2]		= {	if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan2[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan2[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan2[2]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone2[2]:IAQBalPwr[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * UnitIAQFan2[2]:WperCFMIAQ * UnitIAQFan2[2]:FanPowerMult)  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQHRVCFMxRcvEff[2]"  ResProj:UnitIAQZone2[2]:IAQHRVCFMxRcvEff[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
																														then	if (UnitIAQFan2[2]:IAQFanType == 3) then  UnitIAQZone2[2]:IAQHRVCFMxRcvEff[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * UnitIAQFan2[2]:IAQRecovEffect)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQHRVCFMxSRE[2]"  ResProj:UnitIAQZone2[2]:IAQHRVCFMxSRE[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan2[2]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan2[2]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan2[2]:IAQFanType == 3) then  UnitIAQZone2[2]:IAQHRVCFMxSRE[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * UnitIAQFan2[2]:SensRecovEff * UnitIAQFan2[2]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone2[2]:IAQHRVCFMxASRE[2]"  ResProj:UnitIAQZone2[2]:IAQHRVCFMxASRE[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan2[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan2[2]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan2[2]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan2[2]:IAQFanType == 3) then  UnitIAQZone2[2]:IAQHRVCFMxASRE[2]  + (UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * UnitIAQFan2[2]:AdjSensRecovEff * UnitIAQFan2[2]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
  ; Fan #3
   "Set ResProj:UnitIAQZone3[2]:IAQCFM_Exhaust[2]" 	ResProj:UnitIAQZone3[2]:IAQCFM_Exhaust[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5)
																														then	if (UnitIAQFan3[2]:IAQFanType == 1) then  UnitIAQZone3[2]:IAQCFM_Exhaust[2] + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQPwr_Exhaust[2]" 	ResProj:UnitIAQZone3[2]:IAQPwr_Exhaust[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5)
																														then	if (UnitIAQFan3[2]:IAQFanType == 1) then  UnitIAQZone3[2]:IAQPwr_Exhaust[2] + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * UnitIAQFan3[2]:WperCFMIAQ * UnitIAQFan3[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQCFM_Supply[2]"  	ResProj:UnitIAQZone3[2]:IAQCFM_Supply[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5)
																														then	if (UnitIAQFan3[2]:IAQFanType == 2) then  UnitIAQZone3[2]:IAQCFM_Supply[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQPwr_Supply[2]"  	ResProj:UnitIAQZone3[2]:IAQPwr_Supply[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5)
																														then	if (UnitIAQFan3[2]:IAQFanType == 2) then  UnitIAQZone3[2]:IAQPwr_Supply[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * UnitIAQFan3[2]:WperCFMIAQ * UnitIAQFan3[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQHRVCFM[2]"  			ResProj:UnitIAQZone3[2]:IAQHRVCFM[2]		= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5)
																														then	if (UnitIAQFan3[2]:IAQFanType == 3) then  UnitIAQZone3[2]:IAQHRVCFM[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQHRVPwr[2]"  			ResProj:UnitIAQZone3[2]:IAQHRVPwr[2]		= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5)
																														then	if (UnitIAQFan3[2]:IAQFanType == 3) then  UnitIAQZone3[2]:IAQHRVPwr[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * UnitIAQFan3[2]:WperCFMIAQ * UnitIAQFan3[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQBalCFM[2]"  			ResProj:UnitIAQZone3[2]:IAQBalCFM[2]		= {	if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan3[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan3[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan3[2]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone3[2]:IAQBalCFM[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2])  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQBalPwr[2]"  			ResProj:UnitIAQZone3[2]:IAQBalPwr[2]		= {	if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan3[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan3[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan3[2]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone3[2]:IAQBalPwr[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * UnitIAQFan3[2]:WperCFMIAQ * UnitIAQFan3[2]:FanPowerMult)  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQHRVCFMxRcvEff[2]"  ResProj:UnitIAQZone3[2]:IAQHRVCFMxRcvEff[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
																														then	if (UnitIAQFan3[2]:IAQFanType == 3) then  UnitIAQZone3[2]:IAQHRVCFMxRcvEff[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * UnitIAQFan3[2]:IAQRecovEffect)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQHRVCFMxSRE[2]"  ResProj:UnitIAQZone3[2]:IAQHRVCFMxSRE[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan3[2]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan3[2]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan3[2]:IAQFanType == 3) then  UnitIAQZone3[2]:IAQHRVCFMxSRE[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * UnitIAQFan3[2]:SensRecovEff * UnitIAQFan3[2]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone3[2]:IAQHRVCFMxASRE[2]"  ResProj:UnitIAQZone3[2]:IAQHRVCFMxASRE[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan3[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan3[2]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan3[2]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan3[2]:IAQFanType == 3) then  UnitIAQZone3[2]:IAQHRVCFMxASRE[2]  + (UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * UnitIAQFan3[2]:AdjSensRecovEff * UnitIAQFan3[2]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
  ; Fan #4
   "Set ResProj:UnitIAQZone4[2]:IAQCFM_Exhaust[2]" 	ResProj:UnitIAQZone4[2]:IAQCFM_Exhaust[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5)
																														then	if (UnitIAQFan4[2]:IAQFanType == 1) then  UnitIAQZone4[2]:IAQCFM_Exhaust[2] + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQPwr_Exhaust[2]" 	ResProj:UnitIAQZone4[2]:IAQPwr_Exhaust[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5)
																														then	if (UnitIAQFan4[2]:IAQFanType == 1) then  UnitIAQZone4[2]:IAQPwr_Exhaust[2] + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * UnitIAQFan4[2]:WperCFMIAQ * UnitIAQFan4[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQCFM_Supply[2]"  	ResProj:UnitIAQZone4[2]:IAQCFM_Supply[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5)
																														then	if (UnitIAQFan4[2]:IAQFanType == 2) then  UnitIAQZone4[2]:IAQCFM_Supply[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQPwr_Supply[2]"  	ResProj:UnitIAQZone4[2]:IAQPwr_Supply[2]	= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5)
																														then	if (UnitIAQFan4[2]:IAQFanType == 2) then  UnitIAQZone4[2]:IAQPwr_Supply[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * UnitIAQFan4[2]:WperCFMIAQ * UnitIAQFan4[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQHRVCFM[2]"  			ResProj:UnitIAQZone4[2]:IAQHRVCFM[2]		= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5)
																														then	if (UnitIAQFan4[2]:IAQFanType == 3) then  UnitIAQZone4[2]:IAQHRVCFM[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2])  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQHRVPwr[2]"  			ResProj:UnitIAQZone4[2]:IAQHRVPwr[2]		= {	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5)
																														then	if (UnitIAQFan4[2]:IAQFanType == 3) then  UnitIAQZone4[2]:IAQHRVPwr[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * UnitIAQFan4[2]:WperCFMIAQ * UnitIAQFan4[2]:FanPowerMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQBalCFM[2]"  			ResProj:UnitIAQZone4[2]:IAQBalCFM[2]		= {	if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan4[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan4[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan4[2]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone4[2]:IAQBalCFM[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2])  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQBalPwr[2]"  			ResProj:UnitIAQZone4[2]:IAQBalPwr[2]		= {	if (UnitIAQOption[2] == 2 .AND. IfValidAnd( UnitIAQFan4[2]:IAQFanType = 3 ) .AND.
                                                                                                      ( (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .AND. IfValidAnd( UnitIAQFan4[2]:IAQRecovEffect = 0 )) .OR.
                                                                                                        (IfValidAnd( Proj:AnalysisVersion >= 190200 )    .AND. IfValidAnd( UnitIAQFan4[2]:IncludesRecov  = 0 )) ))
																														then	UnitIAQZone4[2]:IAQBalPwr[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * UnitIAQFan4[2]:WperCFMIAQ * UnitIAQFan4[2]:FanPowerMult)  else  UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQHRVCFMxRcvEff[2]"  ResProj:UnitIAQZone4[2]:IAQHRVCFMxRcvEff[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5 .AND. IfValidAnd( Proj:AnalysisVersion >= 190200 )==0)
																														then	if (UnitIAQFan4[2]:IAQFanType == 3) then  UnitIAQZone4[2]:IAQHRVCFMxRcvEff[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * UnitIAQFan4[2]:IAQRecovEffect)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQHRVCFMxSRE[2]"  ResProj:UnitIAQZone4[2]:IAQHRVCFMxSRE[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan4[2]:SensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan4[2]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan4[2]:IAQFanType == 3) then  UnitIAQZone4[2]:IAQHRVCFMxSRE[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * UnitIAQFan4[2]:SensRecovEff * UnitIAQFan4[2]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
   "Set ResProj:UnitIAQZone4[2]:IAQHRVCFMxASRE[2]"  ResProj:UnitIAQZone4[2]:IAQHRVCFMxASRE[2]	={	if (UnitIAQOption[2] == 2 .AND. LocalCompAssigned( UnitIAQFan4[2] ) > 0.5 .AND. IfValidAnd( UnitIAQFan4[2]:AdjSensRecovEff > 0 ) .AND. (IfValidAnd( Proj:AnalysisVersion >= 190200 )==0 .OR. IfValidAnd( UnitIAQFan4[2]:IncludesRecov > 0 )))
																														then	if (UnitIAQFan4[2]:IAQFanType == 3) then  UnitIAQZone4[2]:IAQHRVCFMxASRE[2]  + (UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * UnitIAQFan4[2]:AdjSensRecovEff * UnitIAQFan4[2]:FanHeatRecovMult)  else  UNCHANGED  endif
																														else	UNCHANGED  endif  }
END

;*************************************************************************
RULELIST "Set_ZoneIAQ_MFam"  0 0 0 0
;*************************************************************************
	"Init ResZn:IAQCFM_Exhaust[1]"		ResZn:IAQCFM_Exhaust[1]	= {	0  }
	"Init ResZn:IAQPwr_Exhaust[1]"		ResZn:IAQPwr_Exhaust[1]	= {	0  }
	"Init ResZn:IAQCFM_Supply[1]"		ResZn:IAQCFM_Supply[1]	= {	0  }
	"Init ResZn:IAQPwr_Supply[1]"		ResZn:IAQPwr_Supply[1]	= {	0  }
   "Init ResZn:IAQHRVCFM[1]"  			ResZn:IAQHRVCFM[1]			= {	0  }		; SAC 5/20/13
   "Init ResZn:IAQHRVPwr[1]"  			ResZn:IAQHRVPwr[1]			= {	0  }
   "Init ResZn:IAQBalCFM[1]"  			ResZn:IAQBalCFM[1]			= {	0  }		; SAC 7/25/20
   "Init ResZn:IAQBalPwr[1]"  			ResZn:IAQBalPwr[1]			= {	0  }
   "Init ResZn:IAQHRVCFMxRcvEff[1]"  ResZn:IAQHRVCFMxRcvEff[1] ={	0  }
   "Init ResZn:IAQHRVCFMxSRE[1]"   ResZn:IAQHRVCFMxSRE[1] ={	0  }
   "Init ResZn:IAQHRVCFMxASRE[1]"  ResZn:IAQHRVCFMxASRE[1] ={	0  }

	"Init ResZn:IAQCFM_Exhaust[2]"		ResZn:IAQCFM_Exhaust[2]	= {	0  }
	"Init ResZn:IAQPwr_Exhaust[2]"		ResZn:IAQPwr_Exhaust[2]	= {	0  }
	"Init ResZn:IAQCFM_Supply[2]"		ResZn:IAQCFM_Supply[2]	= {	0  }
	"Init ResZn:IAQPwr_Supply[2]"		ResZn:IAQPwr_Supply[2]	= {	0  }
   "Init ResZn:IAQHRVCFM[2]"  			ResZn:IAQHRVCFM[2]			= {	0  }		; SAC 5/20/13
   "Init ResZn:IAQHRVPwr[2]"  			ResZn:IAQHRVPwr[2]			= {	0  }
   "Init ResZn:IAQBalCFM[2]"  			ResZn:IAQBalCFM[2]			= {	0  }		; SAC 7/25/20
   "Init ResZn:IAQBalPwr[2]"  			ResZn:IAQBalPwr[2]			= {	0  }
   "Init ResZn:IAQHRVCFMxRcvEff[2]"  ResZn:IAQHRVCFMxRcvEff[2] ={	0  }
   "Init ResZn:IAQHRVCFMxSRE[2]"   ResZn:IAQHRVCFMxSRE[2] ={	0  }
   "Init ResZn:IAQHRVCFMxASRE[2]"  ResZn:IAQHRVCFMxASRE[2] ={	0  }

; SAC 6/24/14 - revisions to enable new DwellUnit objects
   "Set ResZn:IAQCFM_Exhaust[1]" 		ResZn:IAQCFM_Exhaust[1]		= {	SumChildren( DwellUnit:IAQCFM_Exhaust )  }   ; SAC 11/12/17 - replace TotalIAQCFM with IAQCFM_Exhaust (tic #915)
	"Set ResZn:IAQPwr_Exhaust[1]" 		ResZn:IAQPwr_Exhaust[1]		= {	SumChildren( DwellUnit:IAQPwr_Exhaust )  }
	"Set ResZn:IAQCFM_Supply[1]"  		ResZn:IAQCFM_Supply[1]		= {	SumChildren( DwellUnit:IAQCFM_Supply )  }
	"Set ResZn:IAQPwr_Supply[1]"  		ResZn:IAQPwr_Supply[1]		= {	SumChildren( DwellUnit:IAQPwr_Supply )  }
	"Set ResZn:IAQHRVCFM[1]"  			ResZn:IAQHRVCFM[1]				= {	SumChildren( DwellUnit:IAQHRVCFM )  }     ; SAC 11/11/17 - added for Balanced IAQ option (heat recovery ventilators) (tic #915)
	"Set ResZn:IAQHRVPwr[1]"  			ResZn:IAQHRVPwr[1]				= {	SumChildren( DwellUnit:IAQHRVPwr )  }
	"Set ResZn:IAQBalCFM[1]"  			ResZn:IAQBalCFM[1]				= {	SumChildren( DwellUnit:IAQBalCFM )  }     ; SAC 7/25/20 (tic #1174)
	"Set ResZn:IAQBalPwr[1]"  			ResZn:IAQBalPwr[1]				= {	SumChildren( DwellUnit:IAQBalPwr )  }
	"Set ResZn:IAQHRVCFMxRcvEff[1]"	ResZn:IAQHRVCFMxRcvEff[1]	= {	SumChildren( DwellUnit:IAQHRVCFMxRcvEff )  }
	"Set ResZn:IAQHRVCFMxSRE[1]"	ResZn:IAQHRVCFMxSRE[1]	= {	SumChildren( DwellUnit:IAQHRVCFMxSRE )  }
	"Set ResZn:IAQHRVCFMxASRE[1]"	ResZn:IAQHRVCFMxASRE[1]	= {	SumChildren( DwellUnit:IAQHRVCFMxASRE )  }
   "Set ResZn:StdDesignIAQCFM"       ResZn:StdDesignIAQCFM       = {   SumChildren( DwellUnit:StdDesignIAQCFM )  }  ; SAC 12/15/19
   "Set ResZn:MaxStdDesignIAQPower"  ResZn:MaxStdDesignIAQPower  = {   SumChildren( DwellUnit:MaxStdDesignIAQPower )  } 

;	"Init ResOtherZn:IAQCFM_Exhaust"		ResOtherZn:IAQCFM_Exhaust	= {	0  }     ; SAC 9/20/19 - OtherZone (MFamProto)
;	"Init ResOtherZn:IAQPwr_Exhaust"		ResOtherZn:IAQPwr_Exhaust	= {	0  }
;	"Init ResOtherZn:IAQCFM_Supply"		ResOtherZn:IAQCFM_Supply		= {	0  }
;	"Init ResOtherZn:IAQPwr_Supply"		ResOtherZn:IAQPwr_Supply		= {	0  }
;   "Init ResOtherZn:IAQHRVCFM"  			ResOtherZn:IAQHRVCFM			= {	0  }
;   "Init ResOtherZn:IAQHRVPwr"  			ResOtherZn:IAQHRVPwr			= {	0  }
;   "Init ResOtherZn:IAQHRVCFMxRcvEff"   ResOtherZn:IAQHRVCFMxRcvEff ={	0  }
;   "Init ResOtherZn:IAQHRVCFMxSRE"   ResOtherZn:IAQHRVCFMxSRE ={	0  }
;   "Init ResOtherZn:IAQHRVCFMxASRE"   ResOtherZn:IAQHRVCFMxASRE ={	0  }
END
;*************************************************************************

;*************************************************************************
RULELIST "Default_ZoneIZXFER" 1 0 0 0
;*************************************************************************
	"Set cseIZXFER:izNVType"	cseIZXFER:izNVType	= {	4  }		; "AIRNETEXT"
	"Set cseIZXFER:izNVEff"		cseIZXFER:izNVEff 	= {	1  }
	"Set cseIZXFER:izExp"		cseIZXFER:izExp   	= {	0.65  }
	"Set cseIZXFER:izCpr"		cseIZXFER:izCpr   	= {	0.6  }
END

;*************************************************************************
RULELIST "Default_AtticIZXFER" 1 0 0 0
;*************************************************************************
	"Set cseIZXFER:izNVType"	cseIZXFER:izNVType	= {	4     }		; "AIRNETEXT"
	"Set cseIZXFER:izNVEff"		cseIZXFER:izNVEff 	= {	0.6   }
	"Set cseIZXFER:izExp"		cseIZXFER:izExp   	= {	0.65  }
	"Set cseIZXFER:izCpr"		cseIZXFER:izCpr   	= {	0.6   }
END

;*************************************************************************
RULELIST "Default_ZoneWinIZXFER" 1 0 0 0
;*************************************************************************
	"Set cseIZXFER:izNVType"	cseIZXFER:izNVType	= {	4  }		; "AIRNETEXT"
	"Set cseIZXFER:izALo"		cseIZXFER:izALo   	= {	0 }
	"Set cseIZXFER:izNVEff"		cseIZXFER:izNVEff   	= {	0.5  }
	"Set cseIZXFER:izCpr"		cseIZXFER:izCpr   	= {	0.6  }
	"Set cseIZXFER:izAFCat"		cseIZXFER:izAFCat   	= {	"VentEx"  }    ; SAC 09/17/20 (tic #1247)

;           "izNVType",          BEMP_Sym,  1, "",                 0, "",         0, "",             1801, "Choice determining interzone ventilation"    
;           "izZn1",             BEMP_Obj,  1, "",                 0, "cseZONE",  0, "",             7010, "Name of primary zone (flow rates > 0 are into the primary zone)" 
;           "izZn2",             BEMP_Obj,  1, "",                 0, "cseZONE",  0, "",             7010, "Name of secondary zone" 
;           "izALo",             BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Area of low or only vent (typically VentOff)"    
;           "izAHi",             BEMP_Flt,  1, "ft2",              0, "",         0, "",             3008, "Additional vent area (high vent or VentOn)"    
;           "izL1",              BEMP_Flt,  1, "ft",               0, "",         0, "",             3008, "Length or width of AIRNETHORIZ opening"    
;           "izL2",              BEMP_Flt,  1, "ft",               0, "",         0, "",             3008, "Width or length of AIRNETHORIZ opening"    
;           "izHD",              BEMP_Flt,  1, "ft",               0, "",         0, "",             3008, "Vent center-to-center height difference (for TWOWAY) or vent height above nominal 0 level (for AirNet types)"
;           "izNVEff",           BEMP_Flt,  1, "",                 0, "",         0, "",             3008, "Vent discharge coefficient coefficient"
;           "izFanVfDs",         BEMP_Flt,  1, "cfm",              0, "",         0, "",             3008, "Fan design or rated flow at rated pressure"
;           "izCpr",             BEMP_Flt,  1, "",                 0, "",         0, "",             3008, "Wind pressure coefficient (for AIRNETEXT)"
;           "izExp",             BEMP_Flt,  1, "",                 0, "",         0, "",             3008, "Opening exponent"
END
;*************************************************************************

; SAC 2/5/20 - setup HRV IAQ IZXFERs for individual fans (SFam-MainHome) (tic #1174)
;*************************************************************************
RULELIST "Setup_HRVIAQ_IZXFERs_SFamZone" 1 0 0 0
;*************************************************************************
; in the process of calling this rulelist, the Zone being operated on will be stored to ResProj:HRVIAQ_IZXFER_ZoneRef...
   "Dereference all ResIAQFan:HRV_IZXFERRef"    ResIAQFan:HRV_IZXFERRef  = {  UNDEFINED  }

   ; added reference to new UnitIAQFan*[*]:FanHeatRecovMult & FanPowerMult - SAC 7/20/20 (tic #1174)
   ; IAQ HRV Fan #1
   "Create HRV IAQ IZXFER for main home Fan #1"    ResProj:UnitIAQFan1[1]:HRV_IZXFERRef  =
      {  if (UnitIAQFan1[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt1[1] > 0 ) .AND.
             IfValidAnd( UnitIAQZone1[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan1[1]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan1[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan1[1]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone1[1], 0, 28 ) + "-1-" + substr( UnitIAQFan1[1]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;"dbg" ResProj:Action = { PostMessageToLog( "   setting ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanVfDs based on:  IAQCFM %g / UnitIAQFanCnt1 %g / IAQCFMFracHRVCompat %g / IAQFanCFMMult %g", UnitIAQFan1[1]:IAQCFM, UnitIAQFanCnt1[1], ValidOr( IAQCFMFracHRVCompat[1], 1 ), ValidOr( IAQFanCFMMult[1], 1 ) ) }
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * ValidOr( IAQCFMFracHRVCompat[1], 1 ) * ValidOr( IAQFanCFMMult[1], 1 )  }   ; SAC 08/29/20
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan1[1]:WperCFMIAQ * UnitIAQFan1[1]:FanPowerMult  }
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan1[1]:SensRecovEff    * UnitIAQFan1[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan1[1]:AdjSensRecovEff * UnitIAQFan1[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; IAQ HRV Fan #2
   "Create HRV IAQ IZXFER for main home Fan #2"    ResProj:UnitIAQFan2[1]:HRV_IZXFERRef  =
      {  if (UnitIAQFan2[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt2[1] > 0 ) .AND.
             IfValidAnd( UnitIAQZone2[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan2[1]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan2[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan2[1]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone2[1], 0, 28 ) + "-2-" + substr( UnitIAQFan2[1]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * ValidOr( IAQCFMFracHRVCompat[1], 1 ) * ValidOr( IAQFanCFMMult[1], 1 )  }   ; SAC 08/29/20
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan2[1]:WperCFMIAQ * UnitIAQFan2[1]:FanPowerMult  }
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan2[1]:SensRecovEff    * UnitIAQFan2[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan2[1]:AdjSensRecovEff * UnitIAQFan2[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; IAQ HRV Fan #3
   "Create HRV IAQ IZXFER for main home Fan #3"    ResProj:UnitIAQFan3[1]:HRV_IZXFERRef  =
      {  if (UnitIAQFan3[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt3[1] > 0 ) .AND.
             IfValidAnd( UnitIAQZone3[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan3[1]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan3[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan3[1]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone3[1], 0, 28 ) + "-3-" + substr( UnitIAQFan3[1]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * ValidOr( IAQCFMFracHRVCompat[1], 1 ) * ValidOr( IAQFanCFMMult[1], 1 )  }   ; SAC 08/29/20
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan3[1]:WperCFMIAQ * UnitIAQFan3[1]:FanPowerMult  }
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan3[1]:SensRecovEff    * UnitIAQFan3[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan3[1]:AdjSensRecovEff * UnitIAQFan3[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; IAQ HRV Fan #4
   "Create HRV IAQ IZXFER for main home Fan #4"    ResProj:UnitIAQFan4[1]:HRV_IZXFERRef  =
      {  if (UnitIAQFan4[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt4[1] > 0 ) .AND.
             IfValidAnd( UnitIAQZone4[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan4[1]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan4[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan4[1]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone4[1], 0, 28 ) + "-4-" + substr( UnitIAQFan4[1]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * ValidOr( IAQCFMFracHRVCompat[1], 1 ) * ValidOr( IAQFanCFMMult[1], 1 )  }   ; SAC 08/29/20
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan4[1]:WperCFMIAQ * UnitIAQFan4[1]:FanPowerMult  }
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan4[1]:SensRecovEff    * UnitIAQFan4[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan4[1]:AdjSensRecovEff * UnitIAQFan4[1]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

; removed rule creating above max HRV IAQ fans (as non-HRV) - SAC 7/21/20 (tic #1174) 
;   "second round of IZXFER creation if too much IAQ CFM to allow all HRV"     ResProj:Action  = 
;      {  if (IfValidAnd( IAQCFMFracHRVCompat[1] < 1 ))
;         then  EvalRulelist( "Setup_nonHRVIAQ_IZXFERs_SFamZone" )
;         else  UNCHANGED  endif  }

   "blast ResProj:HRVIAQ_IZXFER_ZoneRef assignment"   ResProj:HRVIAQ_IZXFER_ZoneRef  = {  UNDEFINED  }
END
; removed rulelist creating above max HRV IAQ fans (as non-HRV) - SAC 7/21/20 (tic #1174) 
;;************************************************************************* SAC 2/5/20 (tic #1174)
;RULELIST "Setup_nonHRVIAQ_IZXFERs_SFamZone" 1 0 0 0
;;*************************************************************************
;   "Dereference all ResIAQFan:HRV_IZXFERRef"    ResIAQFan:HRV_IZXFERRef  = {  UNDEFINED  }
;
;   ; IAQ non-HRV Fan #1
;   "Create non-HRV IAQ IZXFER for main home Fan #1"    ResProj:UnitIAQFan1[1]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan1[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt1[1] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone1[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan1[1]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan1[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan1[1]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone1[1] + "-1-" + UnitIAQFan1[1]:Name + "-IAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan1[1]:IAQCFM * UnitIAQFanCnt1[1] * (1-IAQCFMFracHRVCompat[1])  }
;   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan1[1]:WperCFMIAQ * UnitIAQFan1[1]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan1[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;   ; IAQ non-HRV Fan #2
;   "Create non-HRV IAQ IZXFER for main home Fan #2"    ResProj:UnitIAQFan2[1]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan2[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt2[1] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone2[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan2[1]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan2[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan2[1]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone2[1] + "-2-" + UnitIAQFan2[1]:Name + "-IAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan2[1]:IAQCFM * UnitIAQFanCnt2[1] * (1-IAQCFMFracHRVCompat[1])  }
;   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan2[1]:WperCFMIAQ * UnitIAQFan2[1]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan2[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;   ; IAQ non-HRV Fan #3
;   "Create non-HRV IAQ IZXFER for main home Fan #3"    ResProj:UnitIAQFan3[1]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan3[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt3[1] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone3[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan3[1]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan3[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan3[1]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone3[1] + "-3-" + UnitIAQFan3[1]:Name + "-IAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan3[1]:IAQCFM * UnitIAQFanCnt3[1] * (1-IAQCFMFracHRVCompat[1])  }
;   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan3[1]:WperCFMIAQ * UnitIAQFan3[1]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan3[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;   ; IAQ non-HRV Fan #4
;   "Create non-HRV IAQ IZXFER for main home Fan #4"    ResProj:UnitIAQFan4[1]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan4[1]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt4[1] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone4[1] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan4[1]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan4[1]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan4[1]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone4[1] + "-4-" + UnitIAQFan4[1]:Name + "-IAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan4[1]:IAQCFM * UnitIAQFanCnt4[1] * (1-IAQCFMFracHRVCompat[1])  }
;   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan4[1]:WperCFMIAQ * UnitIAQFan4[1]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan4[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;END
;;*************************************************************************

; SAC 2/6/20 - setup HRV IAQ IZXFERs for individual fans (SFam-MainHome) (tic #1174)
;*************************************************************************
RULELIST "Setup_HRVIAQ_IZXFERs_SFamADUZone" 1 0 0 0
;*************************************************************************
; in the process of calling this rulelist, the Zone being operated on will be stored to ResProj:HRVIAQ_IZXFER_ZoneRef...
   "Dereference all ResIAQFan:HRV_IZXFERRef"    ResIAQFan:HRV_IZXFERRef  = {  UNDEFINED  }

   ; ADU IAQ HRV Fan #1
   "Create HRV IAQ IZXFER for SFam ADU Fan #1"    ResProj:UnitIAQFan1[2]:HRV_IZXFERRef  =
      {  if (UnitIAQFan1[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt1[2] > 0 ) .AND.
             IfValidAnd( UnitIAQZone1[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan1[2]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan1[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan1[2]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone1[2], 0, 28 ) + "-1-" + substr( UnitIAQFan1[2]:Name, 0, 28 ) + "-ADUIAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * ValidOr( IAQCFMFracHRVCompat[2], 1 )  }
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan1[2]:WperCFMIAQ * UnitIAQFan1[2]:FanPowerMult  }
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan1[2]:SensRecovEff    * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan1[2]:AdjSensRecovEff * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; ADU IAQ HRV Fan #2
   "Create HRV IAQ IZXFER for SFam ADU Fan #2"    ResProj:UnitIAQFan2[2]:HRV_IZXFERRef  =
      {  if (UnitIAQFan2[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt2[2] > 0 ) .AND.
             IfValidAnd( UnitIAQZone2[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan2[2]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan2[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan2[2]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone2[2], 0, 28 ) + "-2-" + substr( UnitIAQFan2[2]:Name, 0, 28 ) + "-ADUIAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * ValidOr( IAQCFMFracHRVCompat[2], 1 )  }
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan2[2]:WperCFMIAQ * UnitIAQFan2[2]:FanPowerMult  }
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan2[2]:SensRecovEff    * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan2[2]:AdjSensRecovEff * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; ADU IAQ HRV Fan #3
   "Create HRV IAQ IZXFER for SFam ADU Fan #3"    ResProj:UnitIAQFan3[2]:HRV_IZXFERRef  =
      {  if (UnitIAQFan3[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt3[2] > 0 ) .AND.
             IfValidAnd( UnitIAQZone3[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan3[2]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan3[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan3[2]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone3[2], 0, 28 ) + "-3-" + substr( UnitIAQFan3[2]:Name, 0, 28 ) + "-ADUIAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * ValidOr( IAQCFMFracHRVCompat[2], 1 )  }
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan3[2]:WperCFMIAQ * UnitIAQFan3[2]:FanPowerMult  }
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan3[2]:SensRecovEff    * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan3[2]:AdjSensRecovEff * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; ADU IAQ HRV Fan #4
   "Create HRV IAQ IZXFER for SFam ADU Fan #4"    ResProj:UnitIAQFan4[2]:HRV_IZXFERRef  =
      {  if (UnitIAQFan4[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt4[2] > 0 ) .AND.
             IfValidAnd( UnitIAQZone4[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan4[2]:IncludesRecov > 0 .AND.
             IfValidAnd( UnitIAQFan4[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan4[2]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( UnitIAQZone4[2], 0, 28 ) + "-4-" + substr( UnitIAQFan4[2]:Name, 0, 28 ) + "-ADUIAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * ValidOr( IAQCFMFracHRVCompat[2], 1 )  }
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan4[2]:WperCFMIAQ * UnitIAQFan4[2]:FanPowerMult  }
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izSRE"         ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izSRE        = {  UnitIAQFan4[2]:SensRecovEff    * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izASRE"        ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izASRE       = {  UnitIAQFan4[2]:AdjSensRecovEff * UnitIAQFan1[2]:FanHeatRecovMult / 100  }
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

; removed rule creating above max HRV IAQ fans (as non-HRV) - SAC 7/21/20 (tic #1174) 
;   "second round of IZXFER creation if too much IAQ CFM to allow all ADU HRV"     ResProj:Action  = 
;      {  if (IfValidAnd( IAQCFMFracHRVCompat[2] < 1 ))
;         then  EvalRulelist( "Setup_nonHRVIAQ_IZXFERs_SFamADUZone" )
;         else  UNCHANGED  endif  }

   "blast ResProj:HRVIAQ_IZXFER_ZoneRef assignment"   ResProj:HRVIAQ_IZXFER_ZoneRef  = {  UNDEFINED  }
END
; removed rulelist creating above max HRV IAQ fans (as non-HRV) - SAC 7/21/20 (tic #1174) 
;;************************************************************************* SAC 2/6/20 (tic #1174)
;RULELIST "Setup_nonHRVIAQ_IZXFERs_SFamADUZone" 1 0 0 0
;;*************************************************************************
;   "Dereference all ResIAQFan:HRV_IZXFERRef"    ResIAQFan:HRV_IZXFERRef  = {  UNDEFINED  }
;
;   ; ADU IAQ non-HRV Fan #1
;   "Create non-HRV IAQ IZXFER for SFam ADU Fan #1"    ResProj:UnitIAQFan1[2]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan1[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt1[2] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone1[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan1[2]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan1[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan1[2]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone1[2] + "-1-" + UnitIAQFan1[2]:Name + "-ADUIAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan1[2]:IAQCFM * UnitIAQFanCnt1[2] * (1-IAQCFMFracHRVCompat[2])  }
;   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan1[2]:WperCFMIAQ * UnitIAQFan1[2]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan1[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;   ; ADU IAQ non-HRV Fan #2
;   "Create non-HRV IAQ IZXFER for SFam ADU Fan #2"    ResProj:UnitIAQFan2[2]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan2[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt2[2] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone2[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan2[2]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan2[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan2[2]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone2[2] + "-2-" + UnitIAQFan2[2]:Name + "-ADUIAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan2[2]:IAQCFM * UnitIAQFanCnt2[2] * (1-IAQCFMFracHRVCompat[2])  }
;   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan2[2]:WperCFMIAQ * UnitIAQFan2[2]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan2[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;   ; ADU IAQ non-HRV Fan #3
;   "Create non-HRV IAQ IZXFER for SFam ADU Fan #3"    ResProj:UnitIAQFan3[2]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan3[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt3[2] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone3[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan3[2]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan3[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan3[2]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone3[2] + "-3-" + UnitIAQFan3[2]:Name + "-ADUIAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan3[2]:IAQCFM * UnitIAQFanCnt3[2] * (1-IAQCFMFracHRVCompat[2])  }
;   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan3[2]:WperCFMIAQ * UnitIAQFan3[2]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan3[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;   ; ADU IAQ non-HRV Fan #4
;   "Create non-HRV IAQ IZXFER for SFam ADU Fan #4"    ResProj:UnitIAQFan4[2]:HRV_IZXFERRef  =
;      {  if (UnitIAQFan4[2]:IAQFanType == 3 .AND. IfValidAnd( UnitIAQFanCnt4[2] > 0 ) .AND.
;             IfValidAnd( UnitIAQZone4[2] = HRVIAQ_IZXFER_ZoneRef) .AND. UnitIAQFan4[2]:IncludesRecov > 0 .AND.
;             IfValidAnd( UnitIAQFan4[2]:SensRecovEff > 0 ) .AND. IfValidAnd( UnitIAQFan4[2]:AdjSensRecovEff > 0 ))
;         then  CreateComp( cseIZXFER, UnitIAQZone4[2] + "-4-" + UnitIAQFan4[2]:Name + "-ADUIAQ" )
;         else  UNDEFINED  endif  }
;   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izNVType"      ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
;   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izZn1"         ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izZn1        = {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
;   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanVfDs"     ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanVfDs    = {  UnitIAQFan4[2]:IAQCFM * UnitIAQFanCnt4[2] * (1-IAQCFMFracHRVCompat[2])  }
;   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanElecPwr"  ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanElecPwr = {  UnitIAQFan4[2]:WperCFMIAQ * UnitIAQFan4[2]:FanPowerMult  }
;                     ; exclude specification of izSRE & izASRE
;   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanMtr"      ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanMtr     = {  Proj:CSE_ElecMETER  }
;   "Set ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanEndUse"   ResProj:UnitIAQFan4[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
;
;END
;;*************************************************************************


; SAC 2/6/20 - setup HRV IAQ IZXFERs for individual fans (MFam-DwellUnit) (tic #1174)
;*************************************************************************
RULELIST "Setup_HRVIAQ_IZXFERs_MFamDwellUnit" 1 0 0 0
;*************************************************************************
; in the process of calling this rulelist, the DwellUnit being operated on will be stored to ResProj:HRVIAQ_IZXFER_DwellUnitRef...
   "Dereference all ResIAQFan:HRV_IZXFERRef"    ResIAQFan:HRV_IZXFERRef  = {  UNDEFINED  }

   "Set ResProj:HRVIAQ_IZXFER_ZoneRef assignment"     ResProj:HRVIAQ_IZXFER_ZoneRef  = {  HRVIAQ_IZXFER_DwellUnitRef:Parent  }

   ; DU IAQ HRV Fan #1
   "Create HRV IAQ IZXFER for DwellUnit Fan #1"    ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[1] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-1-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanVfDs    =       ; SAC 08/29/20
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[1] *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCFMMult, 1 ) *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 ) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:FanPowerMult  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izSRE" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izSRE        =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:SensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izASRE"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izASRE       =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:AdjSensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; DU IAQ HRV Fan #2
   "Create HRV IAQ IZXFER for DwellUnit Fan #2"    ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[2] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-2-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanVfDs    =       ; SAC 08/29/20
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[2] *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCFMMult, 1 ) *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 ) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:FanPowerMult  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izSRE" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izSRE        =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:SensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izASRE"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izASRE       =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:AdjSensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; DU IAQ HRV Fan #3
   "Create HRV IAQ IZXFER for DwellUnit Fan #3"    ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[3] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-3-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanVfDs    =       ; SAC 08/29/20
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[3] *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCFMMult, 1 ) *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 ) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:FanPowerMult  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izSRE" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izSRE        =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:SensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izASRE"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izASRE       =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:AdjSensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; DU IAQ HRV Fan #4
   "Create HRV IAQ IZXFER for DwellUnit Fan #4"    ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[4] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-4-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:Name, 0, 28 ) + "-IAQHRV" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanVfDs    =       ; SAC 08/29/20
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[4] *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCFMMult, 1 ) *
             ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 ) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:FanPowerMult  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izSRE" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izSRE        =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:SensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izASRE"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izASRE       =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:AdjSensRecovEff *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:FanHeatRecovMult / 100  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   "second round of IZXFER creation if too much IAQ CFM to allow all DwellUnit HRV"    ResProj:Action  = 
      {  if (IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat < 1 ))
         then  EvalRulelist( "Setup_nonHRVIAQ_IZXFERs_MFamDwellUnit" )
         else  UNCHANGED  endif  }

   "blast ResProj:HRVIAQ_IZXFER_ZoneRef assignment"         ResProj:HRVIAQ_IZXFER_ZoneRef       = {  UNDEFINED  }
   "blast ResProj:HRVIAQ_IZXFER_DwellUnitRef assignment"    ResProj:HRVIAQ_IZXFER_DwellUnitRef  = {  UNDEFINED  }
END
;************************************************************************* SAC 2/6/20 (tic #1174)
RULELIST "Setup_nonHRVIAQ_IZXFERs_MFamDwellUnit" 1 0 0 0
;*************************************************************************
   "Dereference all ResIAQFan:HRV_IZXFERRef"    ResIAQFan:HRV_IZXFERRef  = {  UNDEFINED  }

   ; DU IAQ non-HRV Fan #1
   "Create non-HRV IAQ IZXFER for DwellUnit Fan #1"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[1] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-1-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:Name, 0, 28 ) + "-IAQ" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanVfDs    =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[1] *
          (1-ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 )) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:FanPowerMult  }
                     ; exclude specification of izSRE & izASRE
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[1]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; DU IAQ non-HRV Fan #2
   "Create non-HRV IAQ IZXFER for DwellUnit Fan #2"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[2] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-2-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:Name, 0, 28 ) + "-IAQ" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanVfDs    =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[2] *
          (1-ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 )) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:FanPowerMult  }
                     ; exclude specification of izSRE & izASRE
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[2]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; DU IAQ non-HRV Fan #3
   "Create non-HRV IAQ IZXFER for DwellUnit Fan #3"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[3] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-3-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:Name, 0, 28 ) + "-IAQ" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanVfDs    =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[3] *
          (1-ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 )) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:FanPowerMult  }
                     ; exclude specification of izSRE & izASRE
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[3]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }

   ; DU IAQ non-HRV Fan #4
   "Create non-HRV IAQ IZXFER for DwellUnit Fan #4"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef  =
      {  if (HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:IAQFanType == 3 .AND.
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:IncludesRecov > 0 .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[4] > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:SensRecovEff > 0 ) .AND.
             IfValidAnd( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:AdjSensRecovEff > 0 ))
         then  CreateComp( cseIZXFER, substr( HRVIAQ_IZXFER_DwellUnitRef:Name, 0, 28 ) + "-4-" +
                                      substr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:Name, 0, 28 ) + "-IAQ" )
         else  UNDEFINED  endif  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izNVType"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izNVType     = {  10  }      ; AIRNETHERV  - IAQ balanced / heat recovery ventilator
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izZn1" 
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izZn1        =
          {  HRVIAQ_IZXFER_ZoneRef:CSE_ZONE  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanVfDs"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanVfDs    =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:IAQCFM *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanCnt[4] *
          (1-ValidOr( HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQCFMFracHRVCompat, 1 )) * HRVIAQ_IZXFER_DwellUnitRef:Count  }
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanElecPwr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanElecPwr =
          {  HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:WperCFMIAQ *
             HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:FanPowerMult  }
                     ; exclude specification of izSRE & izASRE
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanMtr"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanMtr     = {  HRVIAQ_IZXFER_ZoneRef:CSE_ElecMETER  }   ; was: Proj:CSE_ElecMETER / fixes bug where HRV energy not tracked by CUAC unit type meters - SAC 12/06/22
   "Set ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanEndUse"
        ResProj:HRVIAQ_IZXFER_DwellUnitRef:DwellUnitTypeRef:IAQFanRef[4]:HRV_IZXFERRef:izFanEndUse  = {  "FANV"  }
END
;*************************************************************************



;*************************************************************************
;*************************************************************************

ENDFILE
