// Project - NRCCPRF XML (sections A-F)
//
// -------------------------------------------------------------------------
//  Copyright (c) 2012-2020, California Energy Commission
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------


// rule to create & setup NRCCPRF XML reporting objects - SAC 11/23/20
RULE Proj:Action
  ANNUAL_PROPOSED
    EvalRulelist( "NRCCPRF_Proposed" )
ENDRULE


// nrccSection_Info
RULE nrccSection_Info:Info01_ProjectName
  ANNUAL_PROPOSED
    Proj:Name
ENDRULE
// nrccSection_Info
RULE nrccSection_Info:Info02_RunDescription
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:RunTitle != ""))
    then Proj:RunTitle
    else " "
    endif
ENDRULE
// nrccSection_Info
RULE nrccSection_Info:Info03_ProjectStreetAddress
  ANNUAL_PROPOSED
    Proj:StAddress
ENDRULE
// nrccSection_Info
RULE nrccSection_Info:Info04_ProjectCity
  ANNUAL_PROPOSED
    Proj:City
ENDRULE
RULE nrccSection_Info:Info05_T24StandardsCodeYear
  ANNUAL_PROPOSED
    Proj:StdsVersion
ENDRULE
RULE nrccSection_Info:Info06_ProjectZipcode
  ANNUAL_PROPOSED
    Proj:ZipCode
ENDRULE
RULE nrccSection_Info:Info07_ComplianceSoftwareVersion
  ANNUAL_PROPOSED
    Proj:SoftwareVersion
ENDRULE
;RULE nrccSection_Info:Info07b_ComplianceSoftwareVersionDetail
;  ANNUAL_PROPOSED
;    Proj:ResProj:SoftwareVersionDetail
;ENDRULE
RULE nrccSection_Info:Info08_ClimateZone
  ANNUAL_PROPOSED
    Proj:CliZnNum
ENDRULE
RULE nrccSection_Info:Info09_Azimuth
  ANNUAL_PROPOSED
    atof( Format( "%.2f", Bldg:BldgAz ) )
ENDRULE
RULE nrccSection_Info:Info10_TopLevelOccupancy
  ANNUAL_PROPOSED
    switch (Bldg:BldgType)
        case "Relocatable Public School Building" : "RelocableSchoolBuildingAllZones"
        case "Hotel-Motel"                        : "HotelMotel"
        case "High-Rise Residential"              : "HighRiseResidential"
        case "Nonresidential"                     : "Nonresidential"
        case "Mixed Occupancy"                    : "MixedOccupancy"
        default :  UNDEFINED
    endswitch
ENDRULE
RULE nrccSection_Info:Info11_WeatherFile
  ANNUAL_PROPOSED
    Proj:AnnualWeatherFileNoPath
ENDRULE
RULE nrccSection_Info:Info12_ProjectScopeNR
  ANNUAL_PROPOSED
    if ( EnumString(Proj:CompType) != "NA" )
    then EnumString(Proj:CompType)
    else UNDEFINED
    endif
ENDRULE
RULE nrccSection_Info:Info13_DwellingUnitsCount
  ANNUAL_PROPOSED
    if (IfValidAnd(Proj:IsHighRiseMFam > 0))  ; NRCC
    then Bldg:HighRiseResLivingUnitCnt
    else if (IfValidAnd(Proj:IsLowRiseMFam > 0))  ; LMCC
         then Bldg:LowRiseResLivingUnitCnt
         else 0
         endif
    endif
ENDRULE
RULE nrccSection_Info:Info14_TotalConditionedFloorArea
  ANNUAL_PROPOSED
    atof( Format( "%.2f", Bldg:TotCondFlrArea ) )
ENDRULE
RULE nrccSection_Info:Info15_HotelMotelGuestRoomCount
  ANNUAL_PROPOSED
    Bldg:HotelMotelGuestRmCnt
ENDRULE
RULE nrccSection_Info:Info16_TotalUnconditionedFloorArea
  ANNUAL_PROPOSED
    atof( Format( "%.2f", Bldg:TotFlrArea - Bldg:TotCondFlrArea ) )
ENDRULE
RULE nrccSection_Info:Info17_SiteFuelType
  ANNUAL_PROPOSED
    EnumString(Proj:GasType)
ENDRULE
RULE nrccSection_Info:Info18_NonResBuildingTotalConditionedFloorArea
  ANNUAL_PROPOSED
    atof( Format( "%.2f", Bldg:NonResFlrArea ) )
ENDRULE
RULE nrccSection_Info:Info19_AboveGradeStoryCount
  ANNUAL_PROPOSED
    Bldg:AboveGrdStoryCnt
ENDRULE
RULE nrccSection_Info:Info20_ResidentialBuildingTotalConditionedFloorArea
  ANNUAL_PROPOSED
    atof( Format( "%.2f", Bldg:ResFlrArea ) )
ENDRULE
RULE nrccSection_Info:Info21_BuildingTotalVolume
  ANNUAL_PROPOSED
    atof( Format( "%.2f", Bldg:TotCondVol ) )
ENDRULE

// nrccSection_Info end


// nrccSection_Proj
RULE nrccSection_Proj:Proj01_PerfENV
  ANNUAL_PROPOSED
    if (Proj:CompPathEnv == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj01mf_PerfENV
  ANNUAL_PROPOSED
    if (Proj:ResCompPathEnv == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj02_PerfMCH
  ANNUAL_PROPOSED
    if (Proj:CompPathMech == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj02mf_PerfMCH
  ANNUAL_PROPOSED
    if (Proj:ResCompPathMech == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj03_PerfDHW
  ANNUAL_PROPOSED
    if (Proj:CompPathDHW == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj03mf_PerfDHW
  ANNUAL_PROPOSED
    if (Proj:ResCompPathDHW == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj04_PerfCondLTI
  ANNUAL_PROPOSED
    if (Proj:CompPathLtg == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj04mf_PerfCondLTI
  ANNUAL_PROPOSED
    if (Proj:ResCompPathLtg == "Performance")
    then "true"
    else "false"
    endif
ENDRULE

RULE nrccSection_Proj:Proj05_PerfSolarWH
  ANNUAL_PROPOSED
    if (Proj:SolThrmlComp == "Performance")
    then "true"
    else "false"
    endif
ENDRULE

RULE nrccSection_Proj:Proj06_PerfKitchenPRC
  ANNUAL_PROPOSED
    if (Proj:CompPathKit == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
;RULE nrccSection_Proj:Proj07_PerfComputerPRC
;  ANNUAL_PROPOSED
;    if (Proj:CompPathComputerRm == "Performance")
;    then "true"
;    else "false"
;    endif
;ENDRULE
RULE nrccSection_Proj:Proj08_PerfLabPRC
  ANNUAL_PROPOSED
    if (Proj:CompPathLab == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj09_PerfPV
  ANNUAL_PROPOSED
    if (Proj:PVComp == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
RULE nrccSection_Proj:Proj10_PerfBattery
  ANNUAL_PROPOSED
    if (Proj:BattComp == "Performance")
    then "true"
    else "false"
    endif
ENDRULE
// nrccSection_Proj end





; nrccSection_C22Result1 

RULE nrccSection_C22Result1:C22Result1_PerformanceComplianceResult
  NRCCPRF
    if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "PASS" ))
    then  "PerfComplies"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL" ))
    then  "PerfFails"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL-UMLH" ))
    then  "PerfFailsUMLH"
    else if (findnocase( ValidOr( Proj:EUseSummaryRef[1]:PassFail, "undef" ), "UMLH" ) > 0)
    then  "PerfFailsUMLH"
    else  UNDEFINED
    endif endif endif endif
ENDRULE

; Standard Design
RULE nrccSection_C22Result1:C22Result1_StandardDesignEfficiency
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_StandardDesignTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_StandardDesignSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[12] )
    else  UNDEFINED  endif
ENDRULE

; Proposed Design
RULE nrccSection_C22Result1:C22Result1_ProposedDesignEfficiency
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_ProposedDesignTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_ProposedDesignSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[11] )
    else  UNDEFINED  endif
ENDRULE

; Compliance Margins
RULE nrccSection_C22Result1:C22Result1_ComplianceMarginEfficiency
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_ComplianceMarginTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_ComplianceMarginSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[13] )
    else  UNDEFINED  endif
ENDRULE

; Pass/Fail
RULE nrccSection_C22Result1:C22Result1_PassFailEfficiency
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:MetricPassFail[1] ) > 0)
    then  Proj:EUseSummaryRef[1]:MetricPassFail[1]
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_PassFailTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:MetricPassFail[2] ) > 0)
    then  Proj:EUseSummaryRef[1]:MetricPassFail[2]
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result1:C22Result1_PassFailSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:MetricPassFail[3] ) > 0)
    then  Proj:EUseSummaryRef[1]:MetricPassFail[3]
    else  UNDEFINED  endif
ENDRULE

; nrccSection_C22Result2 

RULE nrccSection_C22Result2:C22Result2_PerformanceComplianceResult
  NRCCPRF
    if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "PASS" ))
    then  "PerfComplies"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL" ))
    then  "PerfFails"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL-UMLH" ))
    then  "PerfFailsUMLH"
    else if (findnocase( ValidOr( Proj:EUseSummaryRef[1]:PassFail, "undef" ), "UMLH" ) > 0)
    then  "PerfFailsUMLH"
    else  UNDEFINED
    endif endif endif endif
ENDRULE

; HEATING - Heat
RULE nrccSection_C22Result2:C22Result2Heat1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Heat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Heat1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Heat2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Heat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Heat2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Heat3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Heat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Heat3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; COOLING - Cool
RULE nrccSection_C22Result2:C22Result2Cool1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Cool1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Cool1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Cool2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Cool2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Cool2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Cool3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Cool3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Cool3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; INDOOR FANS - Fan
RULE nrccSection_C22Result2:C22Result2Fan1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Fan1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Fan1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Fan2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Fan2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Fan2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Fan3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Fan3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Fan3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Heat Rejection - HR
RULE nrccSection_C22Result2:C22Result2HR1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2HR1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2HR1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2HR2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2HR2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2HR2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2HR3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2HR3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2HR3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; PUMPS & MISC - Pump
RULE nrccSection_C22Result2:C22Result2Pump1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Pump1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Pump1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Pump2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Pump2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Pump2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Pump3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Pump3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Pump3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; DHW - DHW
RULE nrccSection_C22Result2:C22Result2DHW1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2DHW1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2DHW1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2DHW2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2DHW2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2DHW2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2DHW3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2DHW3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2DHW3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; INDOOR LIGHTING - Ltg
RULE nrccSection_C22Result2:C22Result2Ltg1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Ltg1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Ltg1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Ltg2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Ltg2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Ltg2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Ltg3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Ltg3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Ltg3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; FLEXIBILITY - Flex
;RULE nrccSection_C22Result2:C22Result2Flex1_EnergyUseStandardDesign
;  NRCCPRF
;    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[7] ) > 0)
;    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[7] )
;    else  UNDEFINED  endif
;ENDRULE
;    if (LocalStatus( C22Result2Flex1_EnergyUseStandardDesign ) > 0)
;    then  UNDEFINED  else  "N/A"  endif
RULE nrccSection_C22Result2:C22Result2Flex1_NotApplicableMessage
  NRCCPRF
    "NoData"
ENDRULE

RULE nrccSection_C22Result2:C22Result2Flex2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Flex2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Flex2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result2:C22Result2Flex3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Flex3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Flex3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

;Efficiency Compliance (Enduse16)
RULE nrccSection_C22Result2:C22Result2EffCompTotal1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[7] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2EffCompTotal2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[4] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2EffCompTotal3a_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[8] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2EffCompTotal3b_EnergyUseImprovementEffCompTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavEffTDVLbl ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:PctSavEffTDVLbl )
    else  0.0  endif
ENDRULE


; Photovoltaics
RULE nrccSection_C22Result2:C22Result2PV1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2PV1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2PV1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2PV2_EnergyUseProposedPhotovoltaic
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2PV2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2PV2_EnergyUseProposedPhotovoltaic ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2PV3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2PV3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2PV3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Batteries
RULE nrccSection_C22Result2:C22Result2Bat1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Bat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Bat1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Bat2_EnergyUseProposedBattery
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Bat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Bat2_EnergyUseProposedBattery ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Bat3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2Bat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result2Bat3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

;Total Compliance (Enduse8)
RULE nrccSection_C22Result2:C22Result2TotalComp1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[7] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2TotalComp2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[4] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2TotalComp3a_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[8] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result2:C22Result2TotalComp3b_EnergyUseImprovementTotalComp
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavCmpTDVLbl ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:PctSavCmpTDVLbl )
    else  0.0  endif
ENDRULE

; nrccSection_C22Result3 

; Receptacle
RULE nrccSection_C22Result3:C22Result3Recpt1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Recpt1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3Recpt1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Recpt2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Recpt2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3Recpt2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Recpt3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Recpt3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3Recpt3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process
RULE nrccSection_C22Result3:C22Result3Proc1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Proc1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3Proc1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Proc2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Proc2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3Proc2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Proc3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3Proc3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3Proc3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Other Ltg
RULE nrccSection_C22Result3:C22Result3LtgOther1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3LtgOther1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3LtgOther1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3LtgOther2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3LtgOther2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3LtgOther2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3LtgOther3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3LtgOther3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3LtgOther3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process Motors
RULE nrccSection_C22Result3:C22Result3ProcMotor1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3ProcMotor1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3ProcMotor1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3ProcMotor2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3ProcMotor2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3ProcMotor2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3ProcMotor3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3ProcMotor3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result3ProcMotor3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE


; TOTAL COMPLIANCE PLUS MISCELLANEOUS COMPONENTS
;                TOTAL</Enduse15>
RULE nrccSection_C22Result3:C22Result3TotalCompPlus1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3TotalCompPlus2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3TotalCompPlus3a_EnergyUseMargin
  NRCCPRF
    if (LocalStatus( C22Result3TotalCompPlus1_EnergyUseStandardDesign ) > 0 .AND. LocalStatus( C22Result3TotalCompPlus2_EnergyUseProposedDesign ) > 0)
    then  C22Result3TotalCompPlus1_EnergyUseStandardDesign - C22Result3TotalCompPlus2_EnergyUseProposedDesign
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result3:C22Result3TotalCompPlus3b_EnergyUseImprovementTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavingsTDV ) > 0)
    then  atof( Format( "%.1f", Proj:EUseSummaryRef[1]:PctSavingsTDV ) )
    else  UNDEFINED  endif
ENDRULE


; nrccSection_C22Result4 

RULE nrccSection_C22Result4:C22Result4_00_PerformanceComplianceResult
  NRCCPRF
    if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "PASS" ))
    then  "PerfComplies"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL" ))
    then  "PerfFails"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL-UMLH" ))
    then  "PerfFailsUMLH"
    else if (findnocase( ValidOr( Proj:EUseSummaryRef[1]:PassFail, "undef" ), "UMLH" ) > 0)
    then  "PerfFailsUMLH"
    else  UNDEFINED
    endif endif endif endif
ENDRULE

; HEATING - Heat
RULE nrccSection_C22Result4:C22Result4Heat1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Heat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Heat1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Heat2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Heat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Heat2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Heat3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Heat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Heat3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; COOLING - Cool
RULE nrccSection_C22Result4:C22Result4Cool1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Cool1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Cool1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Cool2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Cool2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Cool2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Cool3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Cool3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Cool3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; INDOOR FANS - Fan
RULE nrccSection_C22Result4:C22Result4Fan1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Fan1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Fan1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Fan2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Fan2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Fan2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Fan3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Fan3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Fan3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Heat Rejection - HR
RULE nrccSection_C22Result4:C22Result4HR1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4HR1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4HR1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4HR2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4HR2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4HR2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4HR3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4HR3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4HR3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; PUMPS & MISC - Pump
RULE nrccSection_C22Result4:C22Result4Pump1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Pump1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Pump1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Pump2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Pump2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Pump2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Pump3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Pump3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Pump3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; DHW - DHW
RULE nrccSection_C22Result4:C22Result4DHW1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4DHW1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4DHW1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4DHW2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4DHW2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4DHW2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4DHW3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4DHW3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4DHW3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; INDOOR LIGHTING - Ltg
RULE nrccSection_C22Result4:C22Result4Ltg1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Ltg1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Ltg1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Ltg2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Ltg2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Ltg2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Ltg3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Ltg3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Ltg3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; FLEXIBILITY - Flex
;RULE nrccSection_C22Result4:C22Result4Flex1_EnergyUseStandardSource
;  NRCCPRF
;    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[12] ) > 0)
;    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[12] )
;    else  UNDEFINED  endif
;ENDRULE
;    if (LocalStatus( C22Result4Flex1_EnergyUseStandardSource ) > 0)
;    then  UNDEFINED  else  "N/A"  endif
RULE nrccSection_C22Result4:C22Result4Flex1_NotApplicableMessage
  NRCCPRF
    "NoData"
ENDRULE

RULE nrccSection_C22Result4:C22Result4Flex2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Flex2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Flex2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result4:C22Result4Flex3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Flex3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Flex3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

;Efficiency Compliance (Enduse16)
RULE nrccSection_C22Result4:C22Result4EffCompTotal1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[12] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4EffCompTotal2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[11] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4EffCompTotal3a_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse16[13] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4EffCompTotal3b_EnergyUseImprovementEffCompTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavingsEffSrc ) > 0)
    then  atof( Format( "%.1f", Proj:EUseSummaryRef[1]:PctSavingsEffSrc ) )
    else  0.0  endif
ENDRULE


; Photovoltaics
RULE nrccSection_C22Result4:C22Result4PV1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[12] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[12] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4PV1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4PV1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4PV2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[11] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[11] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4PV2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4PV2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4PV3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[13] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[13] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4PV3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4PV3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Batteries
RULE nrccSection_C22Result4:C22Result4Bat1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[12] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[12] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Bat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Bat1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Bat2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[11] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[11] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Bat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Bat2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Bat3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[13] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[13] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4Bat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result4Bat3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

;Total Compliance (Enduse8)
RULE nrccSection_C22Result4:C22Result4TotalComp1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[12] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[12] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4TotalComp2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[11] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[11] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4TotalComp3a_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[13] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[13] )
    else  0.0  endif
ENDRULE
RULE nrccSection_C22Result4:C22Result4TotalComp3b_EnergyUseImprovementTotalComp
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavingsCmpSrc ) > 0)
    then  atof( Format( "%.1f", Proj:EUseSummaryRef[1]:PctSavingsCmpSrc ) )
    else  0.0  endif
ENDRULE

; nrccSection_C22Result5 

; Receptacle
RULE nrccSection_C22Result5:C22Result5Recpt1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[12] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[12] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Recpt1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5Recpt1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Recpt2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[11] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[11] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Recpt2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5Recpt2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Recpt3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[13] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[13] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Recpt3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5Recpt3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process
RULE nrccSection_C22Result5:C22Result5Proc1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[12] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[12] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Proc1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5Proc1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Proc2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[11] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[11] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Proc2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5Proc2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Proc3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[13] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[13] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5Proc3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5Proc3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Other Ltg
RULE nrccSection_C22Result5:C22Result5LtgOther1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[12] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[12] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5LtgOther1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5LtgOther1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5LtgOther2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[11] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[11] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5LtgOther2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5LtgOther2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5LtgOther3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[13] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[13] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5LtgOther3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5LtgOther3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process Motors
RULE nrccSection_C22Result5:C22Result5ProcMotor1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[12] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[12] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5ProcMotor1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5ProcMotor1_EnergyUseStandardSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5ProcMotor2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[11] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[11] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5ProcMotor2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5ProcMotor2_EnergyUseProposedSource ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5ProcMotor3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[13] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[13] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[13] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5ProcMotor3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result5ProcMotor3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE


; TOTAL COMPLIANCE PLUS MISCELLANEOUS COMPONENTS
;                TOTAL</Enduse15>
RULE nrccSection_C22Result5:C22Result5TotalCompPlus1_EnergyUseStandardSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[12] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[12] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[12] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5TotalCompPlus2_EnergyUseProposedSource
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[11] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[11] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[11] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5TotalCompPlus3a_EnergyUseMargin
  NRCCPRF
    if (LocalStatus( C22Result5TotalCompPlus1_EnergyUseStandardSource ) > 0 .AND. LocalStatus( C22Result5TotalCompPlus2_EnergyUseProposedSource ) > 0)
    then  C22Result5TotalCompPlus1_EnergyUseStandardSource - C22Result5TotalCompPlus2_EnergyUseProposedSource
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result5:C22Result5TotalCompPlus3b_EnergyUseImprovementTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavingsSrc ) > 0)
    then  atof( Format( "%.1f", Proj:EUseSummaryRef[1]:PctSavingsSrc ) )
    else  UNDEFINED  endif
ENDRULE


; nrccSection_C22Result6Tier 

RULE nrccSection_C22Result6Tier:C22Result6Tier1_CALGreenTier1
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:CALGreenResult ) > 0)
    then if (Proj:EUseSummaryRef[1]:CALGreenResult == 1) then "true" else "false" endif
    else  "false"  endif
ENDRULE
RULE nrccSection_C22Result6Tier:C22Result6Tier2_CALGreenTier2
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:CALGreenResult ) > 0)
    then if (Proj:EUseSummaryRef[1]:CALGreenResult == 2) then "true" else "false" endif
    else  "false"  endif
ENDRULE


; nrccSection_C22Result7 

; Space Heating
RULE nrccSection_C22Result7:C22Result7Heat1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Heat1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Heat2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Heat1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Heat2_EnergySumProposed ) > 0)
    then  C22Result7Heat1_EnergySumStandard - C22Result7Heat2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Heat3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Heat4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Heat4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Heat5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Heat4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Heat5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Heat4_EnergySumStandardMBtu - C22Result7Heat5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Heat6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Heat6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Space Cooling
RULE nrccSection_C22Result7:C22Result7Cool1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Cool1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Cool2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Cool1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Cool2_EnergySumProposed ) > 0)
    then  C22Result7Cool1_EnergySumStandard - C22Result7Cool2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Cool3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Cool4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Cool4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Cool5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Cool4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Cool5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Cool4_EnergySumStandardMBtu - C22Result7Cool5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Cool6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Cool6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Indoor Fans
RULE nrccSection_C22Result7:C22Result7Fan1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Fan1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Fan2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Fan1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Fan2_EnergySumProposed ) > 0)
    then  C22Result7Fan1_EnergySumStandard - C22Result7Fan2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Fan3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Fan4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Fan4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Fan5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Fan4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Fan5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Fan4_EnergySumStandardMBtu - C22Result7Fan5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Fan6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Fan6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Heat Rejection
RULE nrccSection_C22Result7:C22Result7HR1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7HR1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7HR2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7HR1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7HR2_EnergySumProposed ) > 0)
    then  C22Result7HR1_EnergySumStandard - C22Result7HR2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7HR3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7HR4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7HR4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7HR5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7HR4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7HR5_EnergySumProposedMBtu ) > 0)
    then  C22Result7HR4_EnergySumStandardMBtu - C22Result7HR5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7HR6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7HR6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Pumps & Misc
RULE nrccSection_C22Result7:C22Result7Pump1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Pump1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Pump2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Pump1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Pump2_EnergySumProposed ) > 0)
    then  C22Result7Pump1_EnergySumStandard - C22Result7Pump2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Pump3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Pump4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Pump4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Pump5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Pump4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Pump5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Pump4_EnergySumStandardMBtu - C22Result7Pump5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Pump6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Pump6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Domestic Hot Water
RULE nrccSection_C22Result7:C22Result7DHW1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7DHW1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7DHW2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7DHW1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7DHW2_EnergySumProposed ) > 0)
    then  C22Result7DHW1_EnergySumStandard - C22Result7DHW2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7DHW3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7DHW4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7DHW4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7DHW5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7DHW4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7DHW5_EnergySumProposedMBtu ) > 0)
    then  C22Result7DHW4_EnergySumStandardMBtu - C22Result7DHW5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7DHW6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7DHW6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Indoor Ltg
RULE nrccSection_C22Result7:C22Result7Ltg1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Ltg1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Ltg2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Ltg1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Ltg2_EnergySumProposed ) > 0)
    then  C22Result7Ltg1_EnergySumStandard - C22Result7Ltg2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Ltg3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Ltg4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Ltg4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Ltg5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Ltg4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Ltg5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Ltg4_EnergySumStandardMBtu - C22Result7Ltg5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Ltg6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Ltg6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Flexibility
RULE nrccSection_C22Result7:C22Result7Flex1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:EnduseFlex[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:EnduseFlex[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Flex1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:EnduseFlex[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:EnduseFlex[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Flex2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Flex1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Flex2_EnergySumProposed ) > 0)
    then  C22Result7Flex1_EnergySumStandard - C22Result7Flex2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Flex3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Flex4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:EnduseFlex[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:EnduseFlex[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Flex4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:EnduseFlex[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:EnduseFlex[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Flex5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Flex4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Flex5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Flex4_EnergySumStandardMBtu - C22Result7Flex5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Flex6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Flex6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; EFFICIENCY TOTAL Efficiency Compliance
RULE nrccSection_C22Result7:C22Result7EffTotal1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse16[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse16[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse16[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse16[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7EffTotal2_EnergySumProposed ) > 0)
    then  C22Result7EffTotal1_EnergySumStandard - C22Result7EffTotal2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7EffTotal4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse16[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse16[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse16[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse16[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse16[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7EffTotal5_EnergySumProposedMBtu ) > 0)
    then  C22Result7EffTotal4_EnergySumStandardMBtu - C22Result7EffTotal5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EffTotal6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EffTotal6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE


; Photovoltaics
RULE nrccSection_C22Result7:C22Result7PV1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7PV1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV2_EnergySumProposedPhotovoltaic
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7PV2_EnergySumProposedPhotovoltaic ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7PV1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7PV2_EnergySumProposedPhotovoltaic ) > 0)
    then  C22Result7PV1_EnergySumStandard - C22Result7PV2_EnergySumProposedPhotovoltaic  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7PV3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7PV4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7PV4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV5_EnergySumProposedPhotovoltaicMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7PV5_EnergySumProposedPhotovoltaicMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7PV4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7PV5_EnergySumProposedPhotovoltaicMBtu ) > 0)
    then  C22Result7PV4_EnergySumStandardMBtu - C22Result7PV5_EnergySumProposedPhotovoltaicMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7PV6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7PV6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Batteries
RULE nrccSection_C22Result7:C22Result7Bat1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Bat1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat2_EnergySumProposedBattery
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Bat2_EnergySumProposedBattery ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Bat1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Bat2_EnergySumProposedBattery ) > 0)
    then  C22Result7Bat1_EnergySumStandard - C22Result7Bat2_EnergySumProposedBattery  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Bat3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Bat4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Bat4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat5_EnergySumProposedBatteryMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Bat5_EnergySumProposedBatteryMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Bat4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Bat5_EnergySumProposedBatteryMBtu ) > 0)
    then  C22Result7Bat4_EnergySumStandardMBtu - C22Result7Bat5_EnergySumProposedBatteryMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Bat6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Bat6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE


; ENERGY USE SUBTOTAL Total Compliance
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7EnergyUseSubtotal2_EnergySumProposed ) > 0)
    then  C22Result7EnergyUseSubtotal1_EnergySumStandard - C22Result7EnergyUseSubtotal2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7EnergyUseSubtotal5_EnergySumProposedMBtu ) > 0)
    then  C22Result7EnergyUseSubtotal4_EnergySumStandardMBtu - C22Result7EnergyUseSubtotal5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseSubtotal6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseSubtotal6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE


; Receptacle
RULE nrccSection_C22Result7:C22Result7Recpt1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Recpt1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Recpt2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Recpt1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Recpt2_EnergySumProposed ) > 0)
    then  C22Result7Recpt1_EnergySumStandard - C22Result7Recpt2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Recpt3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Recpt4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Recpt4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Recpt5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Recpt4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Recpt5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Recpt4_EnergySumStandardMBtu - C22Result7Recpt5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Recpt6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Recpt6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process
RULE nrccSection_C22Result7:C22Result7Proc1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Proc1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Proc2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7Proc1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7Proc2_EnergySumProposed ) > 0)
    then  C22Result7Proc1_EnergySumStandard - C22Result7Proc2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Proc3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7Proc4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Proc4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Proc5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7Proc4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7Proc5_EnergySumProposedMBtu ) > 0)
    then  C22Result7Proc4_EnergySumStandardMBtu - C22Result7Proc5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7Proc6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7Proc6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Other Ltg
RULE nrccSection_C22Result7:C22Result7LtgOther1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7LtgOther2_EnergySumProposed ) > 0)
    then  C22Result7LtgOther1_EnergySumStandard - C22Result7LtgOther2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7LtgOther4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7LtgOther5_EnergySumProposedMBtu ) > 0)
    then  C22Result7LtgOther4_EnergySumStandardMBtu - C22Result7LtgOther5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7LtgOther6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7LtgOther6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process Motors
RULE nrccSection_C22Result7:C22Result7ProcMotor1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7ProcMotor2_EnergySumProposed ) > 0)
    then  C22Result7ProcMotor1_EnergySumStandard - C22Result7ProcMotor2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7ProcMotor4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7ProcMotor5_EnergySumProposedMBtu ) > 0)
    then  C22Result7ProcMotor4_EnergySumStandardMBtu - C22Result7ProcMotor5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7ProcMotor6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7ProcMotor6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE


; ENERGY USE TOTAL Total
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal1_EnergySumStandard ) > 0 .AND. LocalStatus( C22Result7EnergyUseTotal2_EnergySumProposed ) > 0)
    then  C22Result7EnergyUseTotal1_EnergySumStandard - C22Result7EnergyUseTotal2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_C22Result7:C22Result7EnergyUseTotal4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( C22Result7EnergyUseTotal5_EnergySumProposedMBtu ) > 0)
    then  C22Result7EnergyUseTotal4_EnergySumStandardMBtu - C22Result7EnergyUseTotal5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_C22Result7:C22Result7EnergyUseTotal6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( C22Result7EnergyUseTotal6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE


; nrccSection_C22Result8 

RULE NEW nrccSection_C22Result8:noXMLoutput_EnergySumStandard
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_EnergySumStandard
  DESCRIPTION
    "Standard Design Site ENERGY USE TOTAL (MWh)"
  INPUTCLASS
    NotInput
  UNITS
    MWh
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[5] )
    else  0  endif
ENDRULE

RULE NEW nrccSection_C22Result8:noXMLoutput_PV1_EnergySumStandard
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_PV1_EnergySumStandard
  DESCRIPTION
    "Standard Design Site PV"
  INPUTCLASS
    NotInput
  UNITS
    MWh
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[5] )
    else  0  endif
ENDRULE

RULE NEW nrccSection_C22Result8:noXMLoutput_Flex1_EnergySumStandard
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_Flex1_EnergySumStandard
  DESCRIPTION
    "Standard Design Site Flexibility"
  INPUTCLASS
    NotInput
  UNITS
    MWh
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:EnduseFlex[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:EnduseFlex[5] )
    else  0  endif
ENDRULE

RULE NEW nrccSection_C22Result8:noXMLoutput_EnergySumStandardMBtu
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_EnergySumStandardMBtu
  DESCRIPTION
    "Standard Design Site ENERGY USE TOTAL (MBtu)"
  INPUTCLASS
    NotInput
  UNITS
    MBtu
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[6] )
    else  0  endif
ENDRULE


RULE NEW nrccSection_C22Result8:noXMLoutput_EnergySumProposed
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_EnergySumProposed
  DESCRIPTION
    "Proposed Design Site ENERGY USE TOTAL (MWh)"
  INPUTCLASS
    NotInput
  UNITS
    MWh
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[2] )
    else  0  endif
ENDRULE

RULE NEW nrccSection_C22Result8:noXMLoutput_PV1_EnergySumProposed
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_PV1_EnergySumProposed
  DESCRIPTION
    "Proposed Design Site PV"
  INPUTCLASS
    NotInput
  UNITS
    MWh
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[2] )
    else  0  endif
ENDRULE

RULE NEW nrccSection_C22Result8:noXMLoutput_Flex1_EnergySumProposed
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_Flex1_EnergySumProposed
  DESCRIPTION
    "Proposed Design Site Flexibility"
  INPUTCLASS
    NotInput
  UNITS
    MWh
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:EnduseFlex[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:EnduseFlex[2] )
    else  0  endif
ENDRULE

RULE NEW nrccSection_C22Result8:noXMLoutput_EnergySumProposedMBtu
  DATATYPE
    Float
  LONGFORM
    noXMLoutput_EnergySumProposedMBtu
  DESCRIPTION
    "Proposed Design Site ENERGY USE TOTAL (MBtu)"
  INPUTCLASS
    NotInput
  UNITS
    MBtu
  DEFAULT
    0
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[3] )
    else  0  endif
ENDRULE

; RJH 9/7/22 Changed EUI calculation to ADD PV and Flex values (by substracting always negative values) rather than SUBTRACT them
RULE nrccSection_C22Result8:C22Result8GEui1_StandardDesignGrossEUI
  NRCCPRF
    if (Bldg:TotFlrArea != 0)
    then atof( Format( "%.2f", (((noXMLoutput_EnergySumStandard - noXMLoutput_PV1_EnergySumStandard - noXMLoutput_Flex1_EnergySumStandard) * 3412) + (noXMLoutput_EnergySumStandardMBtu * 1000)) / Bldg:TotFlrArea ) )
    else 0
    endif
ENDRULE

; RJH 9/7/22 Changed EUI calculation to ADD PV and Flex values (by substracting always negative values) rather than SUBTRACT them
RULE nrccSection_C22Result8:C22Result8GEui2_ProposedDesignGrossEUI
  NRCCPRF
    if (Bldg:TotFlrArea != 0)
    then atof( Format( "%.2f", (((noXMLoutput_EnergySumProposed - noXMLoutput_PV1_EnergySumProposed - noXMLoutput_Flex1_EnergySumProposed) * 3412) + (noXMLoutput_EnergySumProposedMBtu * 1000)) / Bldg:TotFlrArea ) )
    else 0
    endif
ENDRULE

RULE nrccSection_C22Result8:C22Result8GEui3_MarginGrossEUI
  NRCCPRF
    C22Result8GEui1_StandardDesignGrossEUI - C22Result8GEui2_ProposedDesignGrossEUI
ENDRULE

RULE nrccSection_C22Result8:C22Result8GEui4_MarginPctGrossEUI
  NRCCPRF
    if (C22Result8GEui1_StandardDesignGrossEUI != 0)
    then atof( Format( "%.2f", ((C22Result8GEui1_StandardDesignGrossEUI - C22Result8GEui2_ProposedDesignGrossEUI) / C22Result8GEui1_StandardDesignGrossEUI) * 100 ) )
    else 0
    endif
ENDRULE

RULE nrccSection_C22Result8:C22Result8NEui1_StandardDesignNetEUI
  NRCCPRF
    if (Bldg:TotFlrArea != 0)
    then atof( Format( "%.2f", ((noXMLoutput_EnergySumStandard * 3412) + (noXMLoutput_EnergySumStandardMBtu * 1000)) / Bldg:TotFlrArea ) )
    else 0
    endif
ENDRULE

RULE nrccSection_C22Result8:C22Result8NEui2_ProposedDesignNetEUI
  NRCCPRF
    if (Bldg:TotFlrArea != 0)
    then atof( Format( "%.2f", ((noXMLoutput_EnergySumProposed * 3412) + (noXMLoutput_EnergySumProposedMBtu * 1000)) / Bldg:TotFlrArea ) )
    else 0
    endif
ENDRULE

RULE nrccSection_C22Result8:C22Result8NEui3_MarginNetEUI
  NRCCPRF
    C22Result8NEui1_StandardDesignNetEUI - C22Result8NEui2_ProposedDesignNetEUI
ENDRULE

RULE nrccSection_C22Result8:C22Result8NEui4_MarginPctNetEUI
  NRCCPRF
    if (C22Result8NEui1_StandardDesignNetEUI != 0)
    then atof( Format( "%.2f", ((C22Result8NEui1_StandardDesignNetEUI - C22Result8NEui2_ProposedDesignNetEUI) / C22Result8NEui1_StandardDesignNetEUI) * 100 ) )
    else 0
    endif
ENDRULE






; nrccSection_C22Result9 nrccTableUMLHC22 
RULE NEW ThrmlZn:nrcctblRowUMLHC22Ref
  DATATYPE
    nrcctblRowUMLHC22
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowUMLHC22:noXMLoutput_ThrmlZnRef
  DATATYPE
    ThrmlZn
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowUMLHC22:Parent
  ANNUAL_PROPOSED
    nrccTableUMLHC22:Name
ENDRULE

RULE nrcctblRowUMLHC22:C22Result9_01_ThermalZoneName
  ANNUAL_PROPOSED
    noXMLoutput_ThrmlZnRef:Name
ENDRULE
RULE nrcctblRowUMLHC22:C22Result9_02_ZoneUnmetCoolingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:ClgUMLHLimit ) )
ENDRULE
RULE nrcctblRowUMLHC22:C22Result9_03_UnmetCoolingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:ClgUnmetLdHrs ) )
ENDRULE
RULE nrcctblRowUMLHC22:C22Result9_04_ZoneUnmetHeatingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:HtgUMLHLimit ) )
ENDRULE
RULE nrcctblRowUMLHC22:C22Result9_05_UnmetHeatingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:HtgUnmetLdHrs ) )
ENDRULE






; nrccSection_Result1 

RULE nrccSection_Result1:Result1_00_PerformanceComplianceResult
  NRCCPRF
    if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "PASS" ))
    then  "PerfComplies"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL" ))
    then  "PerfFails"
    else if (IfValidAnd( Proj:EUseSummaryRef[1]:PassFail = "FAIL-UMLH" ))
    then  "PerfFailsUMLD"
    else if (findnocase( ValidOr( Proj:EUseSummaryRef[1]:PassFail, "undef" ), "UMLH" ) > 0)
    then  "PerfFailsUMLD"
    else  UNDEFINED
    endif endif endif endif
ENDRULE

; HEATING - Heat
RULE nrccSection_Result1:Result1Heat1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Heat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Heat1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Heat2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Heat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Heat2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Heat3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse1[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Heat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Heat3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; COOLING - Cool
RULE nrccSection_Result1:Result1Cool1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Cool1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Cool1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Cool2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Cool2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Cool2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Cool3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse2[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Cool3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Cool3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; INDOOR FANS - Fan
RULE nrccSection_Result1:Result1Fan1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Fan1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Fan1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Fan2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Fan2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Fan2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Fan3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse3[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Fan3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Fan3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Heat Rejection - HR
RULE nrccSection_Result1:Result1HR1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1HR1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1HR1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1HR2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1HR2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1HR2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1HR3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse4[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1HR3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1HR3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; PUMPS & MISC - Pump
RULE nrccSection_Result1:Result1Pump1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Pump1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Pump1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Pump2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Pump2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Pump2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Pump3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse5[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Pump3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Pump3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; DHW - DHW
RULE nrccSection_Result1:Result1DHW1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1DHW1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1DHW1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1DHW2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1DHW2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1DHW2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1DHW3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse6[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1DHW3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1DHW3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; INDOOR LIGHTING - Ltg
RULE nrccSection_Result1:Result1Ltg1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Ltg1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Ltg1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Ltg2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Ltg2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Ltg2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Ltg3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse7[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Ltg3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Ltg3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; FLEXIBILITY - Flex
;RULE nrccSection_Result1:Result1Flex1_EnergyUseStandardDesign
;  NRCCPRF
;    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[7] ) > 0)
;    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[7] )
;    else  UNDEFINED  endif
;ENDRULE
;    if (LocalStatus( Result1Flex1_EnergyUseStandardDesign ) > 0)
;    then  UNDEFINED  else  "N/A"  endif
RULE nrccSection_Result1:Result1Flex1_NotApplicableMessage
  NRCCPRF
    "NoData"
ENDRULE

RULE nrccSection_Result1:Result1Flex2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Flex2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Flex2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result1:Result1Flex3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:EnduseFlex[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:EnduseFlex[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result1:Result1Flex3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result1Flex3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; TOTAL - Total
RULE nrccSection_Result1:Result1Total1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[7] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[7] )
    else  0.0  endif
ENDRULE
RULE nrccSection_Result1:Result1Total2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[4] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[4] )
    else  0.0  endif
ENDRULE
RULE nrccSection_Result1:Result1Total3a_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[8] ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:Enduse8[8] )
    else  0.0  endif
ENDRULE
RULE nrccSection_Result1:Result1Total3b_EnergyUseImprovementTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavCmpTDVLbl ) > 0)
    then  atof( Proj:EUseSummaryRef[1]:PctSavCmpTDVLbl )
    else  0.0  endif
ENDRULE


; nrccSection_Result2 
RULE nrccSection_Result2:Result2Tier1_CALGreenTier1
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:CALGreenResult ) > 0)
    then if (Proj:EUseSummaryRef[1]:CALGreenResult == 1) then "true" else "false" endif
    else  "false"  endif
ENDRULE
RULE nrccSection_Result2:Result2Tier2_CALGreenTier2
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:CALGreenResult ) > 0)
    then if (Proj:EUseSummaryRef[1]:CALGreenResult == 2) then "true" else "false" endif
    else  "false"  endif
ENDRULE

; Receptacle
RULE nrccSection_Result2:Result2Recpt1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Recpt1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Recpt1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2Recpt2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Recpt2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Recpt2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2Recpt3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Recpt3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Recpt3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process
RULE nrccSection_Result2:Result2Proc1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Proc1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Proc1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2Proc2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Proc2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Proc2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2Proc3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Proc3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Proc3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Other Ltg
RULE nrccSection_Result2:Result2LtgOther1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2LtgOther1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2LtgOther1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2LtgOther2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2LtgOther2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2LtgOther2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2LtgOther3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2LtgOther3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2LtgOther3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process Motors
RULE nrccSection_Result2:Result2ProcMotor1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2ProcMotor1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2ProcMotor1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2ProcMotor2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2ProcMotor2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2ProcMotor2_EnergyUseProposedDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2ProcMotor3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2ProcMotor3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2ProcMotor3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Photovoltaics
RULE nrccSection_Result2:Result2PV1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2PV1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2PV1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2PV2_EnergyUseProposedPhotovoltaic
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2PV2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2PV2_EnergyUseProposedPhotovoltaic ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2PV3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2PV3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2PV3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Batteries
RULE nrccSection_Result2:Result2Bat1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Bat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Bat1_EnergyUseStandardDesign ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2Bat2_EnergyUseProposedBattery
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Bat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Bat2_EnergyUseProposedBattery ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result2:Result2Bat3_EnergyUseMargin
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[8] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[8] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[8] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2Bat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result2Bat3_EnergyUseMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; COMPLIANCE TOTAL PLUS MISCELLANEOUS COMPONENTS
RULE nrccSection_Result2:Result2TotalPlus1_EnergyUseStandardDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[7] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[7] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[7] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2TotalPlus2_EnergyUseProposedDesign
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[4] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[4] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[4] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2TotalPlus3a_EnergyUseMargin
  NRCCPRF
    if (LocalStatus( Result2TotalPlus1_EnergyUseStandardDesign ) > 0 .AND. LocalStatus( Result2TotalPlus2_EnergyUseProposedDesign ) > 0)
    then  Result2TotalPlus1_EnergyUseStandardDesign - Result2TotalPlus2_EnergyUseProposedDesign
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result2:Result2TotalPlus3b_EnergyUseImprovementTotal
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:PctSavingsTDV ) > 0)
    then  atof( Format( "%.1f", Proj:EUseSummaryRef[1]:PctSavingsTDV ) )
    else  UNDEFINED  endif
ENDRULE

; nrccSection_Result3 

; Space Heating
RULE nrccSection_Result3:Result3Heat1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Heat1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Heat2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Heat1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Heat2_EnergySumProposed ) > 0)
    then  Result3Heat1_EnergySumStandard - Result3Heat2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Heat3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Heat4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Heat4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse1[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse1[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse1[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Heat5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Heat4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Heat5_EnergySumProposedMBtu ) > 0)
    then  Result3Heat4_EnergySumStandardMBtu - Result3Heat5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Heat6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Heat6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Space Cooling
RULE nrccSection_Result3:Result3Cool1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Cool1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Cool2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Cool1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Cool2_EnergySumProposed ) > 0)
    then  Result3Cool1_EnergySumStandard - Result3Cool2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Cool3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Cool4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Cool4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse2[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse2[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse2[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Cool5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Cool4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Cool5_EnergySumProposedMBtu ) > 0)
    then  Result3Cool4_EnergySumStandardMBtu - Result3Cool5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Cool6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Cool6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Indoor Fans
RULE nrccSection_Result3:Result3Fan1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Fan1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Fan2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Fan1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Fan2_EnergySumProposed ) > 0)
    then  Result3Fan1_EnergySumStandard - Result3Fan2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Fan3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Fan4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Fan4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse3[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse3[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse3[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Fan5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Fan4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Fan5_EnergySumProposedMBtu ) > 0)
    then  Result3Fan4_EnergySumStandardMBtu - Result3Fan5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Fan6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Fan6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Heat Rejection
RULE nrccSection_Result3:Result3HR1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3HR1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3HR1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3HR2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3HR2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3HR2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3HR3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3HR1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3HR2_EnergySumProposed ) > 0)
    then  Result3HR1_EnergySumStandard - Result3HR2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3HR3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3HR3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3HR4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3HR4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3HR4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3HR5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse4[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse4[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse4[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3HR5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3HR5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3HR6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3HR4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3HR5_EnergySumProposedMBtu ) > 0)
    then  Result3HR4_EnergySumStandardMBtu - Result3HR5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3HR6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3HR6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Pumps & Misc
RULE nrccSection_Result3:Result3Pump1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Pump1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Pump2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Pump1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Pump2_EnergySumProposed ) > 0)
    then  Result3Pump1_EnergySumStandard - Result3Pump2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Pump3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Pump4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Pump4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse5[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse5[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse5[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Pump5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Pump4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Pump5_EnergySumProposedMBtu ) > 0)
    then  Result3Pump4_EnergySumStandardMBtu - Result3Pump5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Pump6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Pump6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Domestic Hot Water
RULE nrccSection_Result3:Result3DHW1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3DHW1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3DHW2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3DHW1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3DHW2_EnergySumProposed ) > 0)
    then  Result3DHW1_EnergySumStandard - Result3DHW2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3DHW3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3DHW4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3DHW4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse6[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse6[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse6[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3DHW5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3DHW4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3DHW5_EnergySumProposedMBtu ) > 0)
    then  Result3DHW4_EnergySumStandardMBtu - Result3DHW5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3DHW6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3DHW6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Indoor Ltg
RULE nrccSection_Result3:Result3Ltg1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Ltg1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Ltg2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Ltg1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Ltg2_EnergySumProposed ) > 0)
    then  Result3Ltg1_EnergySumStandard - Result3Ltg2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Ltg3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Ltg4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Ltg4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse7[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse7[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse7[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Ltg5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Ltg4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Ltg5_EnergySumProposedMBtu ) > 0)
    then  Result3Ltg4_EnergySumStandardMBtu - Result3Ltg5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Ltg6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Ltg6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Compliance Total
RULE nrccSection_Result3:Result3Total1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Total1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Total1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Total2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Total2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Total2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Total3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Total1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Total2_EnergySumProposed ) > 0)
    then  Result3Total1_EnergySumStandard - Result3Total2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Total3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Total3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Total4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Total4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Total4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Total5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse8[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse8[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse8[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Total5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Total5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Total6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Total4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Total5_EnergySumProposedMBtu ) > 0)
    then  Result3Total4_EnergySumStandardMBtu - Result3Total5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Total6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Total6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Receptacle
RULE nrccSection_Result3:Result3Recpt1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Recpt1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Recpt2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Recpt1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Recpt2_EnergySumProposed ) > 0)
    then  Result3Recpt1_EnergySumStandard - Result3Recpt2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Recpt3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Recpt4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Recpt4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse9[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse9[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse9[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Recpt5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Recpt4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Recpt5_EnergySumProposedMBtu ) > 0)
    then  Result3Recpt4_EnergySumStandardMBtu - Result3Recpt5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Recpt6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Recpt6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process
RULE nrccSection_Result3:Result3Proc1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Proc1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Proc2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Proc1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Proc2_EnergySumProposed ) > 0)
    then  Result3Proc1_EnergySumStandard - Result3Proc2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Proc3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Proc4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Proc4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse10[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse10[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse10[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Proc5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Proc4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Proc5_EnergySumProposedMBtu ) > 0)
    then  Result3Proc4_EnergySumStandardMBtu - Result3Proc5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Proc6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Proc6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Other Ltg
RULE nrccSection_Result3:Result3LtgOther1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3LtgOther1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3LtgOther2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3LtgOther1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3LtgOther2_EnergySumProposed ) > 0)
    then  Result3LtgOther1_EnergySumStandard - Result3LtgOther2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3LtgOther3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3LtgOther4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3LtgOther4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse11[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse11[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse11[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3LtgOther5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3LtgOther4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3LtgOther5_EnergySumProposedMBtu ) > 0)
    then  Result3LtgOther4_EnergySumStandardMBtu - Result3LtgOther5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3LtgOther6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3LtgOther6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Process Motors
RULE nrccSection_Result3:Result3ProcMotor1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3ProcMotor1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3ProcMotor2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3ProcMotor1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3ProcMotor2_EnergySumProposed ) > 0)
    then  Result3ProcMotor1_EnergySumStandard - Result3ProcMotor2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3ProcMotor3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3ProcMotor4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3ProcMotor4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse12[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse12[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse12[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3ProcMotor5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3ProcMotor4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3ProcMotor5_EnergySumProposedMBtu ) > 0)
    then  Result3ProcMotor4_EnergySumStandardMBtu - Result3ProcMotor5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3ProcMotor6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3ProcMotor6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Photovoltaics
RULE nrccSection_Result3:Result3PV1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3PV1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3PV1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3PV2_EnergySumProposedPhotovoltaic
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3PV2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3PV2_EnergySumProposedPhotovoltaic ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3PV3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3PV1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3PV2_EnergySumProposedPhotovoltaic ) > 0)
    then  Result3PV1_EnergySumStandard - Result3PV2_EnergySumProposedPhotovoltaic  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3PV3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3PV3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3PV4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3PV4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3PV4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3PV5_EnergySumProposedPhotovoltaicMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse13[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse13[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse13[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3PV5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3PV5_EnergySumProposedPhotovoltaicMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3PV6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3PV4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3PV5_EnergySumProposedPhotovoltaicMBtu ) > 0)
    then  Result3PV4_EnergySumStandardMBtu - Result3PV5_EnergySumProposedPhotovoltaicMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3PV6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3PV6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Batteries
RULE nrccSection_Result3:Result3Bat1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Bat1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat2_EnergySumProposedBattery
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Bat2_EnergySumProposedBattery ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3Bat1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3Bat2_EnergySumProposedBattery ) > 0)
    then  Result3Bat1_EnergySumStandard - Result3Bat2_EnergySumProposedBattery  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Bat3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3Bat4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Bat4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat5_EnergySumProposedBatteryMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse14[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse14[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse14[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Bat5_EnergySumProposedBatteryMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3Bat4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3Bat5_EnergySumProposedBatteryMBtu ) > 0)
    then  Result3Bat4_EnergySumStandardMBtu - Result3Bat5_EnergySumProposedBatteryMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3Bat6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3Bat6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

; Total
RULE nrccSection_Result3:Result3TotalPlus1_EnergySumStandard
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[5] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[5] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[5] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus1_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3TotalPlus1_EnergySumStandard ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus2_EnergySumProposed
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[2] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[2] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[2] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus2_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3TotalPlus2_EnergySumProposed ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus3_EnergySumMargin
  NRCCPRF
    if (LocalStatus( Result3TotalPlus1_EnergySumStandard ) > 0 .AND. LocalStatus( Result3TotalPlus2_EnergySumProposed ) > 0)
    then  Result3TotalPlus1_EnergySumStandard - Result3TotalPlus2_EnergySumProposed  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus3_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3TotalPlus3_EnergySumMargin ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE

RULE nrccSection_Result3:Result3TotalPlus4_EnergySumStandardMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[6] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[6] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[6] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus4_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3TotalPlus4_EnergySumStandardMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus5_EnergySumProposedMBtu
  NRCCPRF
    if (GlobalStatus( Proj:EUseSummaryRef[1]:Enduse15[3] ) > 0 .AND. Proj:EUseSummaryRef[1]:Enduse15[3] != "--")
    then  StrToFlt( Proj:EUseSummaryRef[1]:Enduse15[3] )
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus5_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3TotalPlus5_EnergySumProposedMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus6_EnergySumMarginMBtu
  NRCCPRF
    if (LocalStatus( Result3TotalPlus4_EnergySumStandardMBtu ) > 0 .AND. LocalStatus( Result3TotalPlus5_EnergySumProposedMBtu ) > 0)
    then  Result3TotalPlus4_EnergySumStandardMBtu - Result3TotalPlus5_EnergySumProposedMBtu  else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Result3:Result3TotalPlus6_NotApplicableMessage
  NRCCPRF
    if (LocalStatus( Result3TotalPlus6_EnergySumMarginMBtu ) > 0)
    then  UNDEFINED  else  "NoData"  endif
ENDRULE




; nrccSection_Result4 nrccTableUMLH 
RULE NEW ThrmlZn:nrcctblRowUMLHRef
  DATATYPE
    nrcctblRowUMLH
  INPUTCLASS 
    Prescribed
ENDRULE
RULE NEW nrcctblRowUMLH:noXMLoutput_ThrmlZnRef
  DATATYPE
    ThrmlZn
  INPUTCLASS 
    Prescribed
ENDRULE

RULE nrcctblRowUMLH:Parent
  ANNUAL_PROPOSED
    nrccTableUMLH:Name
ENDRULE

RULE nrcctblRowUMLH:Result4_01_ThermalZoneName
  ANNUAL_PROPOSED
    noXMLoutput_ThrmlZnRef:Name
ENDRULE
RULE nrcctblRowUMLH:Result4_02_ZoneUnmetCoolingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:ClgUMLHLimit ) )
ENDRULE
RULE nrcctblRowUMLH:Result4_03_UnmetCoolingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:ClgUnmetLdHrs ) )
ENDRULE
RULE nrcctblRowUMLH:Result4_04_ZoneUnmetHeatingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:HtgUMLHLimit ) )
ENDRULE
RULE nrcctblRowUMLH:Result4_05_UnmetHeatingLoadHours
  ANNUAL_PROPOSED
    atof( Format( "%.2f", noXMLoutput_ThrmlZnRef:HtgUnmetLdHrs ) )
ENDRULE




; nrccSection_Except 
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[1]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondCRRC ) > 0)
    then if (Proj:ExcptCondCRRC == "Yes") then "SolarReflectanceCRRC" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[2]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondPartComp1 ) > 0)
        then if (Proj:ExcptCondPartComp1 == "Yes") then "PartialComplianceScope" else UNDEFINED endif
    else if (GlobalStatus( Proj:ExcptCondPartComp2 ) > 0)
        then if (Proj:ExcptCondPartComp2 == "Yes") then "PartialComplianceScope" else UNCHANGED endif
    else if (GlobalStatus( Proj:ExcptCondPartComp3 ) > 0)
        then if (Proj:ExcptCondPartComp3 == "Yes") then "PartialComplianceScope" else UNCHANGED endif
    else  UNDEFINED  endif endif endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[3]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondDisplayPerim ) > 0)
    then if (Proj:ExcptCondDisplayPerim == "Yes") then "FacadeDisplayPerimeter" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[4]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondLtgCred ) > 0)
    then if (Proj:ExcptCondLtgCred == "Yes") then "LightingExceptionalMethod" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[5]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondPAFCredit ) > 0)
    then if (Proj:ExcptCondPAFCredit == "Yes") then "LightingCreditPAF" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[6]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondNoLtg ) > 0)
    then if (Proj:ExcptCondNoLtg == "Yes") then "SpacesWithNoLighting" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[7]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondDsgnIllum ) > 0)
    then if (Proj:ExcptCondDsgnIllum == "Yes") then "IlluminanceSetpointBelowRange" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[8]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondPrescriptiveDayltg ) > 0)
    then if (Proj:ExcptCondPrescriptiveDayltg == "Yes") then "PrescriptiveDayLightCtrl" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[9]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondClerestory ) > 0)
    then if (Proj:ExcptCondClerestory == "Yes") then "ClerestoryControlCheck" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[10]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondNoClgSys ) > 0)
    then if (Proj:ExcptCondNoClgSys == "Yes") then "AddedCoolEquipmentCheck" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[11]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondRtdCap ) > 0)
    then if (Proj:ExcptCondRtdCap == "Yes") then "RatedCapDifferFromPlans" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[12]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondMinEffCheck ) > 0)
    then if (Proj:ExcptCondMinEffCheck == "Yes") then "HvacMinEfficiencyCheck" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[13]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondFanPress ) > 0)
    then if (Proj:ExcptCondFanPress == "Yes") then "FanPressureDropCredit" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[14]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondWtrHtr ) > 0)
    then if (Proj:ExcptCondWtrHtr == "Yes") then "NoServiceWaterHeating" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[15]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondNarrative ) > 0)
    then if (Proj:ExcptCondNarrative == "Yes") then "ModelingApproximations" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[16]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondPropane ) > 0)
    then if (Proj:ExcptCondPropane == "Yes") then "UsingPropaneNatGasAvailable" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[17]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondPrkgGarExhFan ) > 0)
    then if (Proj:ExcptCondPrkgGarExhFan == "Yes") then "ParkingGarageExhaustCheck" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[18]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondInterlockWarn1 ) > 0)
        then if (Proj:ExcptCondInterlockWarn1 == "Yes") then "ZoneOpeningsInterlock" else UNDEFINED endif
    else if (GlobalStatus( Proj:ExcptCondInterlockWarn2 ) > 0)
        then if (Proj:ExcptCondInterlockWarn2 == "Yes") then "ZoneOpeningsInterlock" else UNCHANGED endif
    else  UNDEFINED  endif endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[19]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondVentStdOther ) > 0)
    then if (Proj:ExcptCondVentStdOther == "Yes") then "VentStdOther" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[20]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondFlexEnduse ) > 0)
    then if (Proj:ExcptCondFlexEnduse == "Yes") then "SolarThermalFlexCredit" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[21]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:PropHasUnknownHVACZns ) > 0)
    then if (Proj:PropHasUnknownHVACZns > 0) then "UnknownHvacSystem" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[22]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:PropHasNoClgZns ) > 0)
    then if (Proj:PropHasNoClgZns > 0) then "NoCoolSystemSimulated" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Except:Except01_ExceptionalConditionMessageNRCCPRFE[23]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:AddClgSysZns ) > 0)
    then if (Proj:AddClgSysZns > 0) then "CoolEquipmentAddedForLoads" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE




; nrccSection_HERS 
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[1]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSDuctReqTested ) > 0)
    then if (Proj:ExcptCondHERSDuctReqTested == "Yes") then "DuctLeakageTesting" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[2]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSResDHWSysPipeIns ) > 0)
    then if (Proj:ExcptCondHERSResDHWSysPipeIns == "Yes") then "PipeInsulationHRR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[3]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSResDHWSysParallelPiping ) > 0)
    then if (Proj:ExcptCondHERSResDHWSysParallelPiping == "Yes") then "ParallelPipingHRR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[4]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSResDHWSysRecircDemCtrlPushButton ) > 0)
    then if (Proj:ExcptCondHERSResDHWSysRecircDemCtrlPushButton == "Yes") then "DemandControlPushButtonHRR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[5]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSResDHWSysRecircDemCtrlOccSensor ) > 0)
    then if (Proj:ExcptCondHERSResDHWSysRecircDemCtrlOccSensor == "Yes") then "DemandControlSensorsHRR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[6]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSResDHWSysCompactDistSys ) > 0)
    then if (Proj:ExcptCondHERSResDHWSysCompactDistSys == "Yes") then "CompactHotWaterDistributionHRR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[7]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSDrainWtrHtRcvrySys ) > 0)
    then if (Proj:ExcptCondHERSDrainWtrHtRcvrySys == "Yes") then "DrainWaterHR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[8]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSVent ) > 0)
    then if (Proj:ExcptCondHERSVent == "Yes") then "VentilationAirflowHRR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[9]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSKitHood ) > 0)
    then if (Proj:ExcptCondHERSKitHood == "Yes") then "KitchenHoodRatedHRR" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_HERS:HERS_01_HERS_VerificationMeasure[10]
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:ExcptCondHERSEnvAirLkge ) > 0)
    then if (Proj:ExcptCondHERSEnvAirLkge == "Yes") then "DwellingUnitAirLeakage" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE




; nrccSection_Remarks 
RULE nrccSection_Remarks:Remarks01_CommentsToPermitAuthority
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NarrativeDetails ) > 0)
    then if (Proj:NarrativeDetails != " - specify - ") then Proj:NarrativeDetails else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE


; nrccSection_Nrci 
RULE nrccSection_Nrci:Nrci01_RequireNRCIEnv01E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIEnv01E ) > 0)
    then if (Proj:NRCIEnv01E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci01a_RequireNRCIEnvE
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIEnvE ) > 0)
    then if (Proj:NRCIEnvE > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci02_RequireNRCIMch01E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIMch01E ) > 0)
    then if (Proj:NRCIMch01E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci02a_RequireNRCIMchE
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIMchE ) > 0)
    then if (Proj:NRCIMchE > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci03_RequireNRCIPlb01E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPlb01E ) > 0)
    then if (Proj:NRCIPlb01E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci03a_RequireNRCIPlbE
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPlbE ) > 0)
    then if (Proj:NRCIPlbE > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci04_RequireNRCIPlb02E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPlb02E ) > 0)
    then if (Proj:NRCIPlb02E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci05_RequireNRCIPlb03E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPlb03E ) > 0)
    then if (Proj:NRCIPlb03E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci06_RequireNRCIPlb21E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPlb21E ) > 0)
    then if (Proj:NRCIPlb21E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci07_RequireNRCIPlb22E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPlb22E ) > 0)
    then if (Proj:NRCIPlb22E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci08_RequireNRCISth01E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCISth01E ) > 0)
    then if (Proj:NRCISth01E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci08a_RequireNRCISabE
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCISabE ) > 0)
    then if (Proj:NRCISabE > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci09_RequireNRCILti01E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCILti01E ) > 0)
    then if (Proj:NRCILti01E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci09a_RequireNRCILtiE
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCILtiE ) > 0)
    then if (Proj:NRCILtiE > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci10_RequireNRCILti02E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCILti02E ) > 0)
    then if (Proj:NRCILti02E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci11_RequireNRCILti04E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCILti04E ) > 0)
    then if (Proj:NRCILti04E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci12_RequireNRCILti05E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCILti05E ) > 0)
    then if (Proj:NRCILti05E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci13_RequireNRCILti06E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCILti06E ) > 0)
    then if (Proj:NRCILti06E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci14_RequireNRCIPrc01E
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPrc01E ) > 0)
    then if (Proj:NRCIPrc01E > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci14a_RequireNRCIPrcE
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCIPrcE ) > 0)
    then if (Proj:NRCIPrcE > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrci:Nrci00_NoRequiredCI
  ANNUAL_PROPOSED
    if (LocalStatus( Nrci01_RequireNRCIEnv01E ) > 0 .OR. LocalStatus( Nrci02_RequireNRCIMch01E ) > 0 .OR. LocalStatus( Nrci03_RequireNRCIPlb01E ) > 0 .OR. LocalStatus( Nrci04_RequireNRCIPlb02E ) > 0 .OR.
        LocalStatus( Nrci05_RequireNRCIPlb03E ) > 0 .OR. LocalStatus( Nrci06_RequireNRCIPlb21E ) > 0 .OR. LocalStatus( Nrci07_RequireNRCIPlb22E ) > 0 .OR. LocalStatus( Nrci08_RequireNRCISth01E ) > 0 .OR.
        LocalStatus( Nrci09_RequireNRCILti01E ) > 0 .OR. LocalStatus( Nrci10_RequireNRCILti02E ) > 0 .OR. LocalStatus( Nrci11_RequireNRCILti04E ) > 0 .OR. LocalStatus( Nrci12_RequireNRCILti05E ) > 0 .OR.
        LocalStatus( Nrci13_RequireNRCILti06E ) > 0 .OR. LocalStatus( Nrci14_RequireNRCIPrc01E ) > 0 .OR.
        LocalStatus( Nrci01a_RequireNRCIEnvE ) > 0 .OR. LocalStatus( Nrci02a_RequireNRCIMchE ) > 0 .OR. LocalStatus( Nrci03a_RequireNRCIPlbE ) > 0 .OR. LocalStatus( Nrci08a_RequireNRCISabE ) > 0 .OR.
        LocalStatus( Nrci09a_RequireNRCILtiE ) > 0 .OR. LocalStatus( Nrci14a_RequireNRCIPrcE ) > 0)
    then  UNDEFINED  else  "true"  endif
ENDRULE




; nrccSection_Nrca 
RULE nrccSection_Nrca:Nrca01_RequireNRCAEnv02F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAEnv02F ) > 0)
    then if (Proj:NRCAEnv02F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca02_RequireNRCAEnv03F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAEnv03F ) > 0)
    then if (Proj:NRCAEnv03F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca03_RequireNRCALti02A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCALti02A ) > 0)
    then if (Proj:NRCALti02A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca04_RequireNRCALti03A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCALti03A ) > 0)
    then if (Proj:NRCALti03A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca05_RequireNRCALti04A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCALti04A ) > 0)
    then if (Proj:NRCALti04A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca06_RequireNRCALti05A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCALti05A ) > 0)
    then if (Proj:NRCALti05A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca07_RequireNRCAPrc02F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAPrc02F ) > 0)
    then if (Proj:NRCAPrc02F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca08_RequireNRCAPrc03F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAPrc03F ) > 0)
    then if (Proj:NRCAPrc03F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca09_RequireNRCAPrc12F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAPrc12F ) > 0)
    then if (Proj:NRCAPrc12F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca10_RequireNRCAPrc13F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAPrc13F ) > 0)
    then if (Proj:NRCAPrc13F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca11_RequireNRCAPrc14F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAPrc14F ) > 0)
    then if (Proj:NRCAPrc14F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca12_RequireNRCAPrc15F
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAPrc15F ) > 0)
    then if (Proj:NRCAPrc15F > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca13_RequireNRCAMch02A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch02A ) > 0)
    then if (Proj:NRCAMch02A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca14_RequireNRCAMch03A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch03A ) > 0)
    then if (Proj:NRCAMch03A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca15_RequireNRCAMch04H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch04H ) > 0)
    then if (Proj:NRCAMch04H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
;RULE nrccSection_Nrca:Nrca16_RequireNRCAMch04A
;  ANNUAL_PROPOSED
;    if (GlobalStatus( Proj:NRCAMch04A ) > 0)
;    then if (Proj:NRCAMch04A > 0) then "true" else UNDEFINED endif
;    else  UNDEFINED  endif
;ENDRULE
RULE nrccSection_Nrca:Nrca17_RequireNRCAMch05A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch05A ) > 0)
    then if (Proj:NRCAMch05A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca18_RequireNRCAMch06A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch06A ) > 0)
    then if (Proj:NRCAMch06A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca19_RequireNRCAMch07A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch07A ) > 0)
    then if (Proj:NRCAMch07A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca20_RequireNRCAMch08A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch08A ) > 0)
    then if (Proj:NRCAMch08A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca21_RequireNRCAMch09A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch09A ) > 0)
    then if (Proj:NRCAMch09A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca22_RequireNRCAMch10A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch10A ) > 0)
    then if (Proj:NRCAMch10A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca23_RequireNRCAMch11A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch11A ) > 0)
    then if (Proj:NRCAMch11A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca24_RequireNRCAMch12A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch12A ) > 0)
    then if (Proj:NRCAMch12A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca25_RequireNRCAMch13A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch13A ) > 0)
    then if (Proj:NRCAMch13A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca26_RequireNRCAMch14A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch14A ) > 0)
    then if (Proj:NRCAMch14A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca27_RequireNRCAMch15A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch15A ) > 0)
    then if (Proj:NRCAMch15A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca28_RequireNRCAMch16A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch16A ) > 0)
    then if (Proj:NRCAMch16A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca29_RequireNRCAMch17A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch17A ) > 0)
    then if (Proj:NRCAMch17A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca30_RequireNRCAMch18A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch18A ) > 0)
    then if (Proj:NRCAMch18A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca31_RequireNRCAMch19A
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch19A ) > 0)
    then if (Proj:NRCAMch19A > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca32_RequireNRCAMch20H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch20H ) > 0)
    then if (Proj:NRCAMch20H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca33_RequireNRCAMch21H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCAMch21H ) > 0)
    then if (Proj:NRCAMch21H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrca:Nrca00_NoRequiredCA
  ANNUAL_PROPOSED
    if (LocalStatus( Nrca01_RequireNRCAEnv02F ) > 0 .OR. LocalStatus( Nrca02_RequireNRCAEnv03F ) > 0 .OR. LocalStatus( Nrca03_RequireNRCALti02A ) > 0 .OR. LocalStatus( Nrca04_RequireNRCALti03A ) > 0 .OR.
        LocalStatus( Nrca05_RequireNRCALti04A ) > 0 .OR. LocalStatus( Nrca06_RequireNRCALti05A ) > 0 .OR. LocalStatus( Nrca07_RequireNRCAPrc02F ) > 0 .OR. LocalStatus( Nrca08_RequireNRCAPrc03F ) > 0 .OR.
        LocalStatus( Nrca09_RequireNRCAPrc12F ) > 0 .OR. LocalStatus( Nrca10_RequireNRCAPrc13F ) > 0 .OR. LocalStatus( Nrca11_RequireNRCAPrc14F ) > 0 .OR. LocalStatus( Nrca12_RequireNRCAPrc15F ) > 0 .OR.
        LocalStatus( Nrca13_RequireNRCAMch02A ) > 0 .OR. LocalStatus( Nrca14_RequireNRCAMch03A ) > 0 .OR. LocalStatus( Nrca15_RequireNRCAMch04H ) > 0 .OR. LocalStatus( Nrca17_RequireNRCAMch05A ) > 0 .OR.
        LocalStatus( Nrca18_RequireNRCAMch06A ) > 0 .OR. LocalStatus( Nrca19_RequireNRCAMch07A ) > 0 .OR. LocalStatus( Nrca20_RequireNRCAMch08A ) > 0 .OR. LocalStatus( Nrca21_RequireNRCAMch09A ) > 0 .OR.
        LocalStatus( Nrca22_RequireNRCAMch10A ) > 0 .OR. LocalStatus( Nrca23_RequireNRCAMch11A ) > 0 .OR. LocalStatus( Nrca24_RequireNRCAMch12A ) > 0 .OR. LocalStatus( Nrca25_RequireNRCAMch13A ) > 0 .OR.
        LocalStatus( Nrca26_RequireNRCAMch14A ) > 0 .OR. LocalStatus( Nrca27_RequireNRCAMch15A ) > 0 .OR. LocalStatus( Nrca28_RequireNRCAMch16A ) > 0 .OR. LocalStatus( Nrca29_RequireNRCAMch17A ) > 0 .OR.
        LocalStatus( Nrca30_RequireNRCAMch18A ) > 0 .OR. LocalStatus( Nrca31_RequireNRCAMch19A ) > 0 .OR. LocalStatus( Nrca32_RequireNRCAMch20H ) > 0 .OR. LocalStatus( Nrca33_RequireNRCAMch21H ))
    then  UNDEFINED  else  "true"  endif
ENDRULE


; nrccSection_Nrcv 
RULE nrccSection_Nrcv:Nrcv01_RequireNRCVMch04H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCVMch04H ) > 0)
    then if (Proj:NRCVMch04H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrcv:Nrcv02_RequireNRCVMch24H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCVMch24H ) > 0)
    then if (Proj:NRCVMch24H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrcv:Nrcv03_RequireNRCVMch27H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCVMch27H ) > 0)
    then if (Proj:NRCVMch27H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrcv:Nrcv04_RequireNRCVMch32H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCVMch32H ) > 0)
    then if (Proj:NRCVMch32H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrcv:Nrcv05_RequireNRCVPlb21H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCVPlb21H ) > 0)
    then if (Proj:NRCVPlb21H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrcv:Nrcv06_RequireNRCVPlb22H
  ANNUAL_PROPOSED
    if (GlobalStatus( Proj:NRCVPlb22H ) > 0)
    then if (Proj:NRCVPlb22H > 0) then "true" else UNDEFINED endif
    else  UNDEFINED  endif
ENDRULE
RULE nrccSection_Nrcv:Nrcv00_NoRequiredNRCV
  ANNUAL_PROPOSED
    if (LocalStatus( Nrcv01_RequireNRCVMch04H ) > 0 .OR. LocalStatus( Nrcv02_RequireNRCVMch24H ) > 0 .OR. LocalStatus( Nrcv03_RequireNRCVMch27H ) > 0 .OR. LocalStatus( Nrcv04_RequireNRCVMch32H ) > 0 .OR.
        LocalStatus( Nrcv05_RequireNRCVPlb21H ) > 0 .OR. LocalStatus( Nrcv06_RequireNRCVPlb22H ) > 0)
    then  UNDEFINED  else  "true"  endif
ENDRULE
