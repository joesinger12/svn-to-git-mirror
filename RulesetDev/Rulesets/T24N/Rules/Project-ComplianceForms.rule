// Project - PRF-01 Form Inputs
//
// -------------------------------------------------------------------------
//  Copyright (c) 2019, California Energy Commission
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------


// -----------------------------------------------------------------------------

// ********** Form 1 Defaults  ******

// -----------------------------------------------------------------------------
RULE Proj:CompPathEnv
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Optional
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( ( Proj:IsNewEnv = 1 .OR. 
        Proj:IsAddEnv = 1 .OR. 
        SumChildrenIf( Spc:Mult, Spc:EnvStatus = "Altered" ) > 0 .OR.
        SumChildren( Spc:IsNewEnv ) > 0 ) .AND. Bldg:NonResFlrArea > 0 )
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:DuctStatus
  DATATYPE
    Integer
  LONGFORM
    DuctStatus
  INPUTCLASS : T24N_2016
    NotInput
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT
    if( ( Proj:IsAdd = 1 .OR. Proj:IsAddorAlt = 1 .OR. 
          Proj:IsAlt = 1 .OR. Proj:IsAltOnly = 1 ) .AND.
        ( SumChildrenIf( AirSys:Cnt, AirSys:DuctStatus = 0 ) > 0 .OR. 
          SumChildrenIf( ZnSys:Cnt, ZnSys:DuctStatus = 0 ) > 0 ) ) 
    then 1
    else 0
    endif
ENDRULE



// -----------------------------------------------------------------------------
RULE Proj:CompPathMech
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Optional
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( ( Proj:IsNewMech = 1 .OR. 
        Proj:IsAddMech = 1 .OR. 
        Proj:IsPartMech = 1 .OR.
        SumChildrenIf( Spc:Mult, Spc:IsNewHVAC > 0 ) > 0 .OR.
        SumChildrenIf( Spc:Mult, Spc:IsNewVent > 0 ) > 0 .OR.
        SumChildrenIf( Spc:Mult, Spc:IsNewExh > 0 ) > 0  .OR. 
        IfValidAnd( DuctStatus > 0 ) > 0 ) .AND. Bldg:NonResFlrArea > 0 )
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathLtg
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Optional
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( ( Proj:IsNewLtg = 1 .OR. 
        Proj:IsPartLtg = 1 .OR.
        SumChildrenIf( Spc:Mult, Spc:LtgStatusForComp = "New" ) > 0 .OR.
        SumChildrenIf( Spc:Mult, Spc:LtgStatusForComp = "Altered" ) > 0 ) .AND. Bldg:NonResFlrArea > 0 )
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathDHW
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Optional
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT
    if( ( Proj:CompOptDHW = 1 ) .AND. Bldg:NonResFlrArea > 0 )
    then "Performance"
    else "NA"
    endif
ENDRULE

RULE NEW ResDHWSys:IsDHWSolarSysIncl
  LONGFORM
    IsDomesticHotWaterSolarSystemIncluded
  DATATYPE
    Integer
  DESCRIPTION
    ""
  INPUTCLASS
    NotInput
  DEFAULT
    if( LocalStatus ( DHWSolarSysRef ) > 0 .AND. IfValidAnd( FloorAreaServed[1] > 0 ) )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:SolThrmlComp
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Default
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT
    if( ( CompOptDHW = 1 .AND. SumAll(ResDHWSys:IsDHWSolarSysIncl) > 0 ) .OR.
        ( ResCompOptDHW = 1 .AND. SumAll(ResDHWSys:IsDHWSolarSysIncl) > 0 ) )
    then "Performance"
    else "NA"
    endif
ENDRULE
; SAC 2/2/20 - replace AnnualSolFrac w/ CSESolarSysSimValid to set SolThrmlComp (tic #3157)
;    if( CompOptDHW = 1 .AND. SumChildren( ResDHWSys:AnnualSolFrac ) > 0 ) 


// -----------------------------------------------------------------------------
RULE NEW Spc:IsProcKit
  DATATYPE
    Integer
  LONGFORM
    IsProcessKitchen
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( SpcFunc = "Kitchen/Food Preparation Area" .AND.
        HasProcExh > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:HasNewComputerRmHVAC
  DATATYPE
    Integer
  LONGFORM
    HasNewComputerRoomHVAC
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( SpcFunc = "Computer Room" .AND.
        ( HVACStatus = "New" .OR. 
          HVACStatus = "Altered" ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:IsProcLab
  DATATYPE
    Integer
  LONGFORM
    IsProcessLaboratory
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( SpcFunc = "Scientific Laboratory Area" .AND.
          HasProcExh > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    if( SpcFunc = "Laboratory, Scientific" .AND. ; JP 211130 space type name change (tic #3301)
          HasProcExh > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathKit
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Optional
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. SumChildren( Spc:IsProcKit ) > 0 ) 
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathComputerRm
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Optional
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. SumChildren( Spc:HasNewComputerRmHVAC ) > 0 ) 
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompPathLab
  RULESETS
    T24N
  INPUTCLASS : T24N_2016
    Optional
  INPUTCLASS
    NotInput  IgnoreUserInput  "Removed in transition from version 2019.1.0 to 2019.1.1"
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. SumChildren( Spc:IsProcLab ) > 0 ) 
    then "Performance"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LtgUncondComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LtgOutdrComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LtgSignComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:ResCompPathEnv
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( Proj:ResCompOptEnve > 0 ) ) 
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ResCompPathLtg
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( Proj:ResCompOptLtg > 0 ) )
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ResCompPathMech
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
    if( IfValidAnd( Proj:ResCompOptMech > 0 ) ) 
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ResCompPathDHW
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT 
    if( IfValidAnd( Proj:ResCompOptDHW > 0 ) ) 
    then
      "Performance"
    else
      "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
; added defaulting to Performance when appropriate - SAC 10/13/22
RULE Proj:PVComp
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
   if ( IfValidAnd( AnalysisVersion > 220000 ) .AND.
        ( IfValidAnd( CommunitySolarProjID > 0 ) .OR.
          IfValidAnd( DCSizeMultiplier > 0 ) ) )
   then  "Performance"
   else  "NA"  endif
ENDRULE

// -----------------------------------------------------------------------------
; added defaulting to Performance when appropriate - SAC 10/13/22
RULE Proj:BattComp
  RULESETS
    T24N_2022 T24N_2025
  INPUTCLASS
    NotInput
  DEFAULT
   if ( IfValidAnd( AnalysisVersion > 220000 ) .AND.
        IfValidAnd( BattCapMult > 0 ) .AND. IfValidAnd( BattSizeSum > 0 ) )
   then  "Performance"
   else  "NA"  endif
ENDRULE

// **************** Form 2 Defaults ***************

// -----------------------------------------------------------------------------
RULE Proj:SimpleHVACMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"    
//    if( SumChildren( AirSys:IsComplexSys ) = 0 .AND.
//        SumChildren( ZnSys:IsComplexSys ) = 0 )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ComplexHVACMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"  
//    if( SumChildren( AirSys:IsComplexSys ) > 0 .OR.
//       SumChildren( ZnSys:IsComplexSys ) > 0 )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ElecMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"  
//    if( Proj:CompOptNew = 1 )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:SolReadyMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"  
//    if( Proj:CompOptNew = 1 .AND.
//        ( ( Bldg:ResFlrArea > 0 .AND. Bldg:AboveGrdStoryCnt < 10 ) .OR.
//          ( Bldg:ResFlrArea = 0 .AND. Bldg:AboveGrdStoryCnt < 3 ) ) )
//    then "Yes"
//    else "NA"
//    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:IsProcParking
  DATATYPE
    Integer
  LONGFORM
    IsProcessParking
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( ( SpcFunc = "Parking Garage Area (Parking Zone)" .OR.
          SpcFunc = "Parking Garage Area (Dedicated Ramps)" .OR.
          SpcFunc = "Parking Garage Area (Daylight Adaptation Zones)" ) .AND.
          HasProcExh > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    if( ( SpcFunc = "Parking Garage Area (Parking Zone and Ramps)" .OR. ; JP 211130 space type name change (tic #3301)
          SpcFunc = "Parking Garage Area (Daylight Adaptation Zones)" ) .AND.
          HasProcExh > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ParkingGarageMandComp
  RULESETS
    T24N
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND.
        SumChildren( Spc:IsProcParking ) > 0 ) 
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ComRfrgMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:RfrgWarehouseMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CompressedAirMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ProcBlrMandComp
  RULESETS
    T24N
  DEFAULT
    "NA"
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:CommKitchenMandComp
  RULESETS
    T24N
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathKit = "Performance" )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ComputerRoomMandComp
  RULESETS
    T24N
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathComputerRm = "Performance" )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:LabExhaustMandComp
  RULESETS
    T24N
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( CompPathLab = "Performance" )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:ElevLtgVentMandComp
  RULESETS
    T24N
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( ( CompPathMech = "Performance" .OR. 
          CompPathLtg = "Performance" ) .AND.
        SumChildren( Spc:ElevCnt ) > 0 )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:EscalSpdCtrlMandComp
  RULESETS
    T24N
  DEFAULT : T24N_2016
    "NA"  
  DEFAULT : T24N
    if( SumChildren( Spc:EscalCnt ) > 0 )
    then "Yes"
    else "NA"
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch02A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:FlrArea ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch02A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch03A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Type = "SZAC" .OR. Type = "SZHP" .OR. Type = "SZDFHP" .OR.
          Type = "SPVAC" .OR. Type = "SPVHP" .OR. 
          Type = "HV" .OR. Type = "DOASCV" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch03A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch04H
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( HERSDuctReq > 0 .OR. HERSDuctTested > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch04H
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW OACtrl:HasEconoCtrls
  DATATYPE
    Integer
  LONGFORM
    HasEconomizerControls
  INPUTCLASS
    NotInput
  DEFAULT
    if( OACtrl:EconoCtrlMthd = "FixedDryBulb" .OR.
        OACtrl:EconoCtrlMthd = "DifferentialDryBulb" .OR.
        OACtrl:EconoCtrlMthd = "DifferentialEnthalpy" .OR.
        OACtrl:EconoCtrlMthd = "DifferentialDryBulbAndEnthalpy" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch05A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumChildren( OACtrl:HasEconoCtrls ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch05A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch06A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasDCV ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch06A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch07A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Type = "PVAV" .OR. 
          Type = "SZVAVAC" .OR. Type = "SZVAVHP" .OR. Type = "SZVAVDFHP" .OR. 
          Type = "DOASVAV" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch07A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch08A does not apply to air systems
RULE AirSys:NRCAMch08A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch09A does not apply to air systems
RULE AirSys:NRCAMch09A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch10A does not apply to air systems
RULE AirSys:NRCAMch10A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch11A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Status = "New" .OR. Status = "Altered" ) .AND.
        IfValidAnd( CtrlSysType = "DDCToZone" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch11A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch12A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Status = "New" .OR. Status = "Altered" ) .AND.
        IfValidAnd( ClgCap > 33000 ) .AND.
        SumChildren( OACtrl:HasEconoCtrls ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch12A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch13A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Status = "New" .OR. Status = "Altered" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch13A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch14A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch14A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch15A does not apply to air systems
RULE AirSys:NRCAMch15A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch16A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Status = "New" .OR. Status = "Altered" ) .AND.
        ( ClgCtrl = "Fixed" .OR.
          ClgCtrl = "OutsideAirReset" .OR.
          ClgCtrl = "Scheduled" .OR.
          ClgCtrl = "WarmestResetFlowFirst" .OR.
          ClgCtrl = "WarmestResetTemperatureFirst" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch16A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch17A does not apply to air systems
RULE AirSys:NRCAMch17A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch18A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        IsComplexSys )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE AirSys:NRCAMch19A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasOccSensorCtrl ) > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch19A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE



// ===========Zone Systems
// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch02A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:FlrArea ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch02A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch03A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( Type = "SZAC" .OR. Type = "SZHP" .OR. Type = "SZDFHP" .OR.
          Type = "PTAC" .OR. Type = "PTHP" .OR.
          Type = "FPFC" .OR. Type = "Furnace" .OR.
          Type = "SPVAC" .OR. Type = "SPVHP" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch03A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch04H
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( HERSDuctReq > 0 .OR. HERSDuctTested > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch04H
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch05A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch05A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch06A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasDCV ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch06A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch07A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch07A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch08A does not apply to zone systems
RULE ZnSys:NRCAMch08A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch09A does not apply to zone systems
RULE ZnSys:NRCAMch09A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch10A does not apply to zone systems
RULE ZnSys:NRCAMch10A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch11A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch11A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch12A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch12A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch13A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch13A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch14A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch14A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch15A does not apply to zone systems
RULE ZnSys:NRCAMch15A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch16A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch16A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch17A does not apply to zone systems
RULE ZnSys:NRCAMch17A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch18A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        IsComplexSys )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE ZnSys:NRCAMch19A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasOccSensorCtrl ) > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 .OR. IfValidAnd( IsActiveBeam > 0 ) )
    then 0
    else NRCAMch19A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch02A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:FlrArea ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch02A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch03A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch03A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch04H
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch04H
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch05A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch05A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch06A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasDCV ) >0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch06A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch07A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch07A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch08A does not apply to VRF systems
RULE VRFSys:NRCAMch08A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch09A does not apply to VRF systems
RULE VRFSys:NRCAMch09A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch10A does not apply to VRF systems
RULE VRFSys:NRCAMch10A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch11A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch11A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch12A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch12A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch13A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch13A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch14A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch14A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch15A does not apply to VRF systems
RULE VRFSys:NRCAMch15A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch16A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch16A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch17A does not apply to VRF systems
RULE VRFSys:NRCAMch17A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch18A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    1
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE VRFSys:NRCAMch19A
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( SumRevRef( ThrmlZn:VentSysRef, ThrmlZn:HasOccSensorCtrl ) > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( BaseSysNum > 0 ) then 0 
    else NRCAMch19A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch02A does not apply to fluid systems
RULE FluidSys:NRCAMch02A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS 
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch03A does not apply to fluid systems
RULE FluidSys:NRCAMch03A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch04H does not apply to fluid systems
RULE FluidSys:NRCAMch04H
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch05A does not apply to fluid systems
RULE FluidSys:NRCAMch05A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch06A does not apply to fluid systems
RULE FluidSys:NRCAMch06A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch07A does not apply to fluid systems
RULE FluidSys:NRCAMch07A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch08A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS 
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( IfValidAnd( ChlrCnt > 1 ) .OR.
          IfValidAnd( BlrCnt > 1 ) .OR.
          SumChildren( Pump:PumpVarSpdFlag ) > 0 ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch08A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch09A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        ( IfValidAnd( ClgCap >= 500000 ) .OR.
          IfValidAnd( HtgCap >= 500000 ) ) .AND.
        ( FluidSys:TempCtrl = "Scheduled" .OR.
          FluidSys:TempCtrl = "OutsideAirReset" .OR.
          FluidSys:TempCtrl = "WetBulbReset" .OR.
          FluidSys:TempCtrl = "FixedDualSetpoint" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch09A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch10A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Type = "ChilledWater" .AND.
        ( Status = "New" .OR. Status = "Altered" ) .AND.
        SumChildren( Pump:PumpVarSpdFlag ) > 0 .AND.
        SumChildren( Pump:MtrHP ) > 5 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch10A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch11A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch12A does not apply to fluid systems
RULE FluidSys:NRCAMch12A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch13A does not apply to fluid systems
RULE FluidSys:NRCAMch13A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch14A does not apply to fluid systems
RULE FluidSys:NRCAMch14A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch15A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Type = "ChilledWater" .AND.
        SumChildren( ThrmlEngyStor:IsExisting ) + 
        SumChildren( ThrmlEngyStor:IsNew ) > 0 )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch15A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch16A does not apply to fluid systems
RULE FluidSys:NRCAMch16A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch17A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    if( Proj:CompPathMech = "Performance" .AND.
        Type = "CondenserWater" .AND.
        ( Status = "New" .OR. Status = "Altered" ) .AND.
        ( TempCtrl = "Fixed" .OR.
          TempCtrl = "Scheduled" .OR.
          TempCtrl = "OutsideAirReset" .OR.
          TempCtrl = "WetBulbReset" .OR.
          TempCtrl = "FixedDualSetpoint" ) )
    then 1
    else 0
    endif
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch17A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE FluidSys:NRCAMch18A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    if( IsBaseSys .OR. (Type = "ServiceHotWater" .AND. Proj:ExcptCondWtrHtr = "Yes") ) then 0 
    else NRCAMch18A
    endif
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
// This rule CAN BE DELETED because NRCAMch19A does not apply to fluid systems
RULE FluidSys:NRCAMch19A
  RULESETS
    T24N
  DESCRIPTION
    "A boolean (0/1) flag to indicate whether an acceptance certificate of the 
     number matching the term name is required, used for reporting."
  INPUTCLASS
    Default
  DEFAULT
    0
  ANNUAL_PROPOSED
    0
  ANNUAL_BASELINE
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIEnvE
  DESCRIPTION
    "Certificate of installation - Envelope"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
    if( CompPathEnv = "Performance" )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIEnv01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( CompPathEnv = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW FenCons:IsNFRCRtd
  DATATYPE
    Integer
  LONGFORM
    IsNFRCRated
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( FenCons:CertificationMthd = "NFRCRated" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAEnv02F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathEnv = "Performance" .AND. 
        SumChildren( FenCons:IsNFRCRtd ) > 0 )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCILtiE
  DESCRIPTION
    "Certificate of installation - Lighting"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
    if( CompPathLtg = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:HasDayltgCtrls
  DATATYPE
    Integer
  LONGFORM
    HasDaylightingControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( DayltgCtrlType = "Continuous" .OR.
        DayltgCtrlType = "ContinuousPlusOff" .OR.
        DayltgCtrlType = "SteppedSwitching" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasLtgCtrls
  DATATYPE
    Integer
  LONGFORM
    HasLightingControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-1to125SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-126to250SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-251to500SF" .OR.
        IntLtgSys:PAFCredType[1] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[1] = "DemandResponsiveControl" .OR. 
        IntLtgSys:PAFCredType[1] = "Clerestories" .OR. 
        IntLtgSys:PAFCredType[1] = "HorizontalSlats" .OR. 
        IntLtgSys:PAFCredType[1] = "LightShelves" )
    then 1
    else if( IntLtgSys:PAFCredType[2] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[2] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[2] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[2] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[2] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[2] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[2] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[2] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[2] = "LightShelves" )
    then 1
    else if( IntLtgSys:PAFCredType[3] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[3] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[3] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[3] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[3] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[3] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[3] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[3] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[3] = "LightShelves" )
    then 1  
    else if( IntLtgSys:PAFCredType[4] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[4] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[4] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[4] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[4] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[4] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[4] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[4] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[4] = "LightShelves" )             
    then 1
    else if( IntLtgSys:PAFCredType[5] = "DaylightDimmingPlusOff" .OR.
             IntLtgSys:PAFCredType[5] = "OccupantSensingControls-1to125SF" .OR.
             IntLtgSys:PAFCredType[5] = "OccupantSensingControls-126to250SF" .OR.
             IntLtgSys:PAFCredType[5] = "OccupantSensingControls-251to500SF" .OR.
             IntLtgSys:PAFCredType[5] = "InstitutionalTuning" .OR.
             IntLtgSys:PAFCredType[5] = "DemandResponsiveControl" .OR. 
             IntLtgSys:PAFCredType[5] = "Clerestories" .OR. 
             IntLtgSys:PAFCredType[5] = "HorizontalSlats" .OR. 
             IntLtgSys:PAFCredType[5] = "LightShelves" )   
    then 1
    else 0
    endif endif endif endif endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasDayltgCtrls
  DATATYPE
    Integer
  LONGFORM
    HasDaylightingControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "DaylightDimmingPlusOff" .OR. 
        IntLtgSys:PAFCredType[2] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[3] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[4] = "DaylightDimmingPlusOff" .OR.
        IntLtgSys:PAFCredType[5] = "DaylightDimmingPlusOff" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasOccSensorCtrls
  DATATYPE
    Integer
  LONGFORM
    HasOccupantSensorControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "OccupantSensingControls-1to125SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-126to250SF" .OR.
        IntLtgSys:PAFCredType[1] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[2] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[2] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[2] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[3] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[3] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[3] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[4] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[4] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[4] = "OccupantSensingControls-251to500SF" )
    then 1
    else if( IntLtgSys:PAFCredType[5] = "OccupantSensingControls-1to125SF" .OR.
		         IntLtgSys:PAFCredType[5] = "OccupantSensingControls-126to250SF" .OR.
		         IntLtgSys:PAFCredType[5] = "OccupantSensingControls-251to500SF" )
    then 1                
    else 0
    endif endif endif endif endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasDemandResponseCtrls
  DATATYPE
    Integer
  LONGFORM
    HasDemandResponsiveControls
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[2] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[3] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[4] = "DemandResponsiveControl" .OR.
				IntLtgSys:PAFCredType[5] = "DemandResponsiveControl" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW IntLtgSys:HasInstitutionalTuning
  DATATYPE
    Integer
  LONGFORM
    HasInstitutionalTuning
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( IntLtgSys:PAFCredType[1] = "InstitutionalTuning" .OR. 
        IntLtgSys:PAFCredType[2] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[3] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[4] = "InstitutionalTuning" .OR.
        IntLtgSys:PAFCredType[5] = "InstitutionalTuning" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti02E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti04E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILti05E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" .AND. 
        SumChildren( IntLtgSys:HasLtgCtrls ) > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Spc:IsVideoconferencingStudio
  DATATYPE
    Integer
  LONGFORM
    IsVideoconferencingStudio
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( SpcFunc = "Videoconferencing Studio" )
    then 1
    else 0
    endif
ENDRULE

// ------------------------------------------------------------------------------
RULE NEW IntLtgSys:HasVideoConfAllow
  DATATYPE
    Integer
  LONGFORM
    HasVideoConferencingAllowance
  INPUTCLASS
    NotInput
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( IntLtgSys:AllowType = "VideoconferencingStudioLighting" )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCILti06E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( CompPathLtg = "Performance" .AND. 
        SumChildren( Spc:IsVideoconferencingStudio ) > 0 .AND. 
        SumChildren( IntLtgSys:HasVideoConfAllow ) > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathLtg = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti03A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathLtg = "Performance" .AND. 
        ( SumChildren( Win:Area ) > 0 .OR.
          SumChildren( Skylt:Area ) > 0 .OR.
          SumChildren( Spc:HasDayltgCtrls ) > 0  ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti04A  // 
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathLtg = "Performance" .AND.
        ( SumChildren( Bldg:NonResFlrArea ) > 10000 .OR. 
          SumChildren( IntLtgSys:HasDemandResponseCtrls ) > 0 ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALti05A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathLtg = "Performance" .AND. 
        SumChildren( IntLtgSys:HasInstitutionalTuning ) > 0 )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIMchE
  DESCRIPTION
    "Certificate of installation - Mechanical"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
    if( CompPathMech = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIMch01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( CompPathMech = "Performance" )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch02A ) + 
    SumChildren(  ZnSys:NRCAMch02A ) + 
    SumChildren( VRFSys:NRCAMch02A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch03A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch03A ) + 
    SumChildren(  ZnSys:NRCAMch03A ) + 
    SumChildren( VRFSys:NRCAMch03A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch04H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch04H ) + 
    SumChildren(  ZnSys:NRCAMch04H ) + 
    SumChildren( VRFSys:NRCAMch04H )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch05A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch05A ) + 
    SumChildren(  ZnSys:NRCAMch05A ) + 
    SumChildren( VRFSys:NRCAMch05A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch06A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch06A ) + 
    SumChildren(  ZnSys:NRCAMch06A ) + 
    SumChildren( VRFSys:NRCAMch06A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch07A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch07A ) + 
    SumChildren(  ZnSys:NRCAMch07A ) + 
    SumChildren( VRFSys:NRCAMch07A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch08A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch08A ) + 
    SumChildren(  ZnSys:NRCAMch08A ) + 
    SumChildren( VRFSys:NRCAMch08A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch09A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch09A ) + 
    SumChildren(  ZnSys:NRCAMch09A ) + 
    SumChildren( VRFSys:NRCAMch09A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch10A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch10A ) + 
    SumChildren(  ZnSys:NRCAMch10A ) + 
    SumChildren( VRFSys:NRCAMch10A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch11A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch11A ) + 
    SumChildren(  ZnSys:NRCAMch11A ) + 
    SumChildren( VRFSys:NRCAMch11A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch12A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch12A ) + 
    SumChildren(  ZnSys:NRCAMch12A ) + 
    SumChildren( VRFSys:NRCAMch12A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch13A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch13A ) + 
    SumChildren(  ZnSys:NRCAMch13A ) + 
    SumChildren( VRFSys:NRCAMch13A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch14A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch14A ) + 
    SumChildren(  ZnSys:NRCAMch14A ) + 
    SumChildren( VRFSys:NRCAMch14A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch15A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch15A ) + 
    SumChildren(  ZnSys:NRCAMch15A ) + 
    SumChildren( VRFSys:NRCAMch15A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch16A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch16A ) + 
    SumChildren(  ZnSys:NRCAMch16A ) + 
    SumChildren( VRFSys:NRCAMch16A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch17A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch17A ) + 
    SumChildren(  ZnSys:NRCAMch17A ) + 
    SumChildren( VRFSys:NRCAMch17A )
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch18A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch18A ) + 
    SumChildren(  ZnSys:NRCAMch18A ) + 
    SumChildren( VRFSys:NRCAMch18A )
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW Bldg:NRCAMch19A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( AirSys:NRCAMch19A ) + 
    SumChildren(  ZnSys:NRCAMch19A ) + 
    SumChildren( VRFSys:NRCAMch19A )
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch02A ) + 
        SumChildren( Bldg:NRCAMch02A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch03A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch03A ) + 
        SumChildren( Bldg:NRCAMch03A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch04H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch04H ) + 
        SumChildren( Bldg:NRCAMch04H ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch05A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch05A ) + 
        SumChildren( Bldg:NRCAMch05A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch06A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch06A ) + 
        SumChildren( Bldg:NRCAMch06A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch07A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch07A ) + 
        SumChildren( Bldg:NRCAMch07A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch08A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch08A ) + 
        SumChildren( Bldg:NRCAMch08A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch09A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch09A ) + 
        SumChildren( Bldg:NRCAMch09A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch10A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch10A ) + 
        SumChildren( Bldg:NRCAMch10A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch11A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch11A ) + 
        SumChildren( Bldg:NRCAMch11A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch12A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch12A ) + 
        SumChildren( Bldg:NRCAMch12A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch13A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch13A ) + 
        SumChildren( Bldg:NRCAMch13A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch14A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch14A ) + 
        SumChildren( Bldg:NRCAMch14A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch15A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch15A ) + 
        SumChildren( Bldg:NRCAMch15A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch16A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch16A ) + 
        SumChildren( Bldg:NRCAMch16A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch17A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch17A ) + 
        SumChildren( Bldg:NRCAMch17A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch18A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch18A ) + 
        SumChildren( Bldg:NRCAMch18A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch19A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    NotInput  IgnoreUserInput  "Previous input now set by ruleset (transition from 2013 ver 3b to 3c)"
  DEFAULT
    if( SumChildren( FluidSys:NRCAMch19A ) + 
        SumChildren( Bldg:NRCAMch19A ) > 0 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch20H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. ( Proj:ExcptCondHERSVent = "Yes" .OR. Proj:ExcptCondHERSKitHood = "Yes" ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAMch21H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. Proj:ExcptCondHERSEnvAirLkge = "Yes" )
    then 1
    else 0
    endif
ENDRULE



// -----------------------------------------------------------------------------
RULE Proj:NRCVMch04H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. Proj:NRCAMch04H = 1 )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCVMch24H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. Proj:ExcptCondHERSEnvAirLkge = "Yes" )
    then 1
    else 0
    endif
ENDRULE




// -----------------------------------------------------------------------------
RULE Proj:NRCVMch27H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND. ( Proj:NRCAMch02A = 1 .OR. Proj:NRCAMch20H = 1  ) )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCVMch32H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( CompPathMech = "Performance" .AND.
        ( SumChildren( AirSys:IsExhSys ) > 0 .OR.
          SumChildren( ZnSys:IsExhSys ) > 0  ) )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIPlbE
  DESCRIPTION
    "Certificate of installation - Plumbing"
  INPUTCLASS
    Default
  DEFAULT : T24_2019
    UNDEFINED
  DEFAULT : T24N
		if( Proj:CompOptDHW = 1 )
		then 1
		else 0
		endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:HighRiseResLivingUnitCnt
  LONGFORM
    HighRiseResidentialLivingUnitCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:HighRiseResLivingUnitCnt ) 
ENDRULE

RULE NEW Proj:LowRiseResLivingUnitCnt
  LONGFORM
    LowRiseResidentialLivingUnitCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:LowRiseResLivingUnitCnt ) 
ENDRULE

RULE NEW Proj:ResLivingUnitCnt
  LONGFORM
    ResidentialLivingUnitCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:ResLivingUnitCnt ) 
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:HotelMotelGuestRmCnt
  LONGFORM
    HotelMotelGuestRoomCount
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    SumChildren( Bldg:HotelMotelGuestRmCnt ) 
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:ResDHWSysIsCentral
  LONGFORM
    ResidentialDomesticHotWaterSystemIsCentral
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. SumChildrenIf( ResDHWSys:CentralDHW, ResDHWSys:Status = "New" ) > 0 )
    then 1 
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW ResDHWSys:ResDHWSysIsIndividual
  LONGFORM
    ResidentialDomesticHotWaterSystemIsIndividual
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. IfValidAnd( ResDHWSys:CentralDHW = 0 ) )
    then 1 
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE NEW Proj:ResDHWSysIsIndividual
  LONGFORM
    ResidentialDomesticHotWaterSystemIsIndividual
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. SumChildrenIf( ResDHWSys:ResDHWSysIsIndividual, ResDHWSys:Status = "New" ) > 0 )
    then 1 
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb02E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND. 
       Proj:ResDHWSysIsCentral > 0  )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb03E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsIndividual > 0  )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE NEW Proj:ResDHWHERSChk
  LONGFORM
    ResidentialDomesticHotWaterHeatingHERSCheck
  DESCRIPTION
    ""
  DATATYPE
    Integer
  INPUTCLASS
    NotInput
  DEFAULT
    if( Proj:CompOptDHW = 1 .AND. 
        ( Proj:ExcptCondHERSResDHWSysPipeIns = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysParallelPiping = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysRecircDemCtrlPushButton = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysRecircDemCtrlOccSensor = "Yes" .OR.
          Proj:ExcptCondHERSResDHWSysCompactDistSys = "Yes" .OR.
          Proj:ExcptCondHERSDrainWtrHtRcvrySys = "Yes" ) )
    then 1 
    else 0
    endif
ENDRULE



// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb21E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsCentral > 0 .AND. Proj:ResDHWHERSChk = 1 )
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIPlb22E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsIndividual > 0 .AND. Proj:ResDHWHERSChk = 1)
   then 1
   else 0
   endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCVPlb21H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsCentral > 0 .AND. Proj:ResDHWHERSChk = 1  )
   then 1
   else 0
   endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCVPlb22H
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
   if( Proj:CompOptDHW = 1 .AND. ( Proj:HighRiseResLivingUnitCnt > 0 .OR. Proj:HotelMotelGuestRmCnt > 0 ) .AND.
       Proj:ResDHWSysIsIndividual > 0 .AND. Proj:ResDHWHERSChk = 1  )
   then 1
   else 0
   endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCISabE
  DESCRIPTION
    "Certificate of installation - Solar Hot Water Heating, PV and Battery"
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    if( Proj:SolThrmlComp = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCISth01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( Proj:SolThrmlComp = "Performance" )
    then 1
    else 0
    endif
 DEFAULT : T24N
   UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCIElc01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCISpv01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILto01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILto02E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCALto02A
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCILts01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016 T24N_2019
    0
  DEFAULT : T24N
    UNDEFINED
ENDRULE



// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc01F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    0
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc02F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( Proj:CompPathKit = "Performance" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc03F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( Proj:ParkingGarageMandComp = "Yes" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc04F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc05F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc06F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc07F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc08F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    0
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc12F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  PREVIOUSNAMES
    NRCAPrc12
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( Proj:ElevLtgVentMandComp = "Yes" )
    then 1
    else 0
    endif
ENDRULE

// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc13F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  PREVIOUSNAMES
    NRCAPrc13
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( Proj:EscalSpdCtrlMandComp = "Yes" )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc14F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N
    if( Proj:CompPathLab = "Performance" )
    then 1
    else 0
    endif
ENDRULE




// -----------------------------------------------------------------------------
RULE Proj:NRCAPrc15F
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( Proj:CompPathMech = "Performance" .AND.
        SumChildrenIf( Spc:LabFumeHoodVertAutoSashCtrlFrac, Spc:SpcFunc = "Scientific Laboratory Area" ) > 0 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    if( Proj:CompPathMech = "Performance" .AND.
        SumChildrenIf( Spc:LabFumeHoodVertAutoSashCtrlFrac, Spc:SpcFunc = "Laboratory, Scientific" ) > 0 )
    then 1
    else 0
    endif
ENDRULE


// -----------------------------------------------------------------------------
RULE Proj:NRCIPrc01E
  DESCRIPTION
    "Certificate of installation, certificate of acceptance and
     certificate of verification summary form."
  INPUTCLASS
    Default
  DEFAULT : T24N_2016
    0
  DEFAULT : T24N_2019
    if( NRCAPrc02F = 1 .OR. NRCAPrc14F = 1 .OR. NRCAPrc15F = 1 )
    then 1
    else 0
    endif
  DEFAULT : T24N
    UNDEFINED
ENDRULE


// TotStaticPress, for reporting
RULE Fan:TotStaticPressRpt
  DESCRIPTION
    "The fan total static pressure used for reporting."
  INPUTCLASS
    NotInput
  REPORTPRECISION
    3  
  ANNUAL
    if( IfValidAnd( ParentComp = "AirSys" ) )
    then
      if( AirSys:IsPropSys > 0 .AND. AirSeg:Type = "Relief" )
      then // Report user value for relief fans since they are modeled w/ 0 power. See Ticket 2843
        ValidOr( u:TotStaticPress, 0 ) 
      else TotStaticPress
      endif 
    else TotStaticPress
    endif
ENDRULE