// Rules processed to generate DDY file from weather location data
//
// -------------------------------------------------------------------------
//  Copyright (c) 2012-2021, California Energy Commission
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are
//  met:
// 
//    * Redistributions of source code must retain the above copyright
//  notice, this list of conditions and the following disclaimer.
//    * Redistributions in binary form must reproduce the above copyright
//  notice, this list of conditions and the following disclaimer in
//  the documentation and/or other materials provided with the
//  distribution.
//    * Neither the name of the California Energy Commission nor the names of its
//  contributors may be used to endorse or promote products
//  derived from this software without specific prior written
//  permission.
//
//  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
//  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
//  TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
//  PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL CALIFORNIA ENERGY COMMISSION
//  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
//  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
//  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
//  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
//  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
//  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
//  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
// -------------------------------------------------------------------------
//


;*************************************************************************
RULELIST "GenerateDDYFromWeatherData" 1 0 0 0
;"dbg"  Proj:Action = {  PostMessageToLog( "  evaluating 'GenerateDDYFromWeatherData' rulelist" )  }
   "Call subordinate rulelist to setup either valid or dummy DDY file depending on WeatherStation specification"  Proj:Action =     ; SAC 10/13/22
      {  if (EnumValue( WeatherStation ) > 0)
         then  EvalRulelist( "GenerateDDYFromWeatherData_Valid" )
         else  EvalRulelist( "GenerateDDYFromWeatherData_Dummy" )
         endif  }
END
;*************************************************************************
RULELIST "GenerateDDYFromWeatherData_Dummy" 1 0 0 0
;"dbg"  Proj:Action = {  PostMessageToLog( "  evaluating 'GenerateDDYFromWeatherData' rulelist" )  }

;   "Set Proj:CliZnNum to default iff undefined"          Proj:CliZnNum =            ; needed to catch and report error where CliZn or WthrStation not specified - SAC 10/13/22
;      {  if (IfValidAnd( CliZnNum > 0 )==0) then  12
;         else  UNCHANGED  endif  }
;   "Set Proj:WeatherStation to default iff undefined"    Proj:WeatherStation =      ; needed to catch and report error where CliZn or WthrStation not specified - SAC 10/13/22
;      {  if (EnumValue( WeatherStation ) < 1) then  "SACRAMENTO EXECUTIVE"
;         else  UNCHANGED  endif  }

   "Set Proj:WeatherLocationDDYFile (file name)"      Proj:WeatherLocationDDYFile =
      {  ProcessingPath + "placeholder.ddy"  }

   "Open DDY file"      Proj:WeatherLocationDDYFileIdx =
      {  OpenExportFile( WeatherLocationDDYFile, "wt" )  }

   "Populate DDY file"     Proj:Action =
      {  WriteToExportFile( WeatherLocationDDYFileIdx,  "placeholder DDY file\n" )  }

  "Close DDY file"      Proj:Action =
     {  CloseExportFile( WeatherLocationDDYFileIdx )  }

END
;*************************************************************************
RULELIST "GenerateDDYFromWeatherData_Valid" 1 0 0 0
;"dbg"  Proj:Action = {  PostMessageToLog( "  evaluating 'GenerateDDYFromWeatherData' rulelist" )  }

   "Set Proj:WeatherLocationDDYFile (file name)"      Proj:WeatherLocationDDYFile =
      {  ProcessingPath + WeatherCliZnDsgnDay2022:Weather_FileName( "Station_Name", WeatherStation ) + ".ddy"  }

   "Open DDY file"      Proj:WeatherLocationDDYFileIdx =
      {  OpenExportFile( WeatherLocationDDYFile, "wt" )  }

   "Populate DDY file"     Proj:Action =
      {  if (IfValidAnd( WeatherLocationDDYFileIdx >= 0 ))
         then  EvalRulelist( "PopulateDDYFile" )
         else  UNCHANGED  endif  }

  "Close DDY file"      Proj:Action =
     {  CloseExportFile( WeatherLocationDDYFileIdx )  }

END
;*************************************************************************


// Lookup-based DDY file creation rules - RPG
// ----------------------
// ------- Notes --------
// station name / site / Location == WeatherStation
// "       %g,      !- name of variable" = the string
// WeatherCliZnDsgnDay2022:MCWB_DB004_Jun == column locate example
// "Station_Name", WeatherStation  == row lookup
//  / ConvFactor ) == if needed; for string not needed and change %g to %s
// refer to ACM documentation for details on format()
//
// pass ASCII/ANSI chars with %c 
//   ; 	=  59
//   {  =  123
//   }  =  125
//   (  =  40
//   )  =  41
//   "  =  34
//   ,  =  44
//   <space> = 32
//
// ConvFactor currently undef, conversion factors are hard-coded here 
//
// %s      -> String
// %g      -> Float written with least amount of decimal precision
// %.2f    -> Float written with two decimal places
// %d, %u  -> Don't use to report integers; use %f or %g instead
// %c      -> Character values (see above)


RULELIST "Location" 1 0 0 0

   "write_string"             Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "Site:Location,\n" )  }
   "write_string_lookup"      Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %s,	!- Location Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
   "write_num_lookup"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Latitude\n\n", WeatherCliZnDsgnDay2022:Lat( "Station_Name", WeatherStation ) ) ) }
   "write_num_lookup"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Longitude\n\n", WeatherCliZnDsgnDay2022:Lon( "Station_Name", WeatherStation ) ) ) }
   "write_num_lookup"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,		!- Time Zone Relative to GMT\n\n", WeatherCliZnDsgnDay2022:TZ_Offset( "Station_Name", WeatherStation ) ) ) }
   "write_num_lookup_cv_end"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g%c	!- Elevation %cm%c\n\n\n\n", WeatherCliZnDsgnDay2022:Elev( "Station_Name", WeatherStation )*0.3048 , 59, 123, 125 ) ) }
	
END


RULELIST "DesignDay_Htg_Ann" 1 0 0 0

  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "SizingPeriod:DesignDay,\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %s Ann Htg 99.6% Condns DB,	!- Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
  "write_num_lookup"     Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Month\n\n", WeatherCliZnDsgnDay2022:Coldest_Month( "Station_Name", WeatherStation ) ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  21,	!- Day of Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  WinterDesignDay,	!- Day Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Maximum Dry-Bulb Temperature %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB996( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB996( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  0.0,	!- Daily Dry-Bulb Temperature Range %cC%c\n" , 123, 125 ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  DefaultMultipliers,	!- Dry-Bulb Temperature Range Modifier Type\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  ,	!- Dry-Bulb Temperature Range Modifier Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  Wetbulb,	!- Humidity Condition Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wetbulb at Maximum Dry-Bulb %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB996( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB996( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  ,		!- Humidity Indicating Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  ,		!- Humidity Ratio at Maximum Dry-Bulb %ckgWater/kgDryAir%c\n" , 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  ,		!- Enthalpy at Maximum Dry-Bulb %cJ/kg%c\n" , 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  "  ,		!- Daily Wet-Bulb Temperature Range %cdeltaC%c\n" , 123, 125 )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,	!- Barometric Pressure %cPa%c %c%.1f PSI%c\n\n", (WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation )*6894.7448255 ) , 123, 125, 91, WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wind Speed %cm/s%c %c%.1f mph%c design conditions vs. traditional 3.35 m/s %c7.5 mph%c\n\n", ( ValidOr( WindSpeedColdestMonth, 5 )*0.44704 ), 123, 125, 91, ValidOr( WindSpeedColdestMonth, 5 ), 93, 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Wind Direction %cDegrees%c N=0, S=180%c\n\n", WeatherCliZnDsgnDay2022:PCWD_DB996( "Station_Name", WeatherStation ) , 123, 59, 125 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Rain %cYes/No%c\n" , 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Snow on ground %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Daylight Savings Time Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ASHRAEClearSky,	!- Solar Model Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Beam Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Diffuse Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- ASHRAE Clear Sky Optical Depth for Beam Irradiance (TauB)\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance (TauD)\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  0.0%c	!- Clearness %c0.0 to 1.1%c\n\n\n" , 59, 123, 125 )  }
   
END


RULELIST "DesignDay_Clg_06" 1 0 0 0

  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "SizingPeriod:DesignDay,\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %s  June .4% Condns DB=>MCWB,     !- Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "   6,	!- Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  21,	!- Day of Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  SummerDesignDay, !- Day Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Maximum Dry-Bulb Temperature %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB004_Jun( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB004_Jun( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Daily Dry-Bulb Temperature Range %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MDBR_Jun( "Station_Name", WeatherStation )-0)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MDBR_Jun( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  DefaultMultipliers, !- Dry-Bulb Temperature Range Modifier Type\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Dry-Bulb Temperature Range Modifier Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  Wetbulb,		!- Humidity Condition Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wetbulb at Maximum Dry-Bulb %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MCWB_DB004_Jun( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MCWB_DB004_Jun( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Indicating Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Ratio at Maximum Dry-Bulb %ckgWater/kgDryAir%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Enthalpy at Maximum Dry-Bulb %cJ/kg%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Daily Wet-Bulb Temperature Range %cdeltaC%c\n", 123, 125 )  }	
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,	!- Barometric Pressure %cPa%c %c%.1f PSI%c\n\n", (WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation )*6894.7448255 ) , 123, 125, 91, WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wind Speed %cm/s%c %c%.1f mph%c design conditions vs. traditional 3.35 m/s %c7.5 mph%c\n\n", ( ValidOr( WindSpeedColdestMonth, 5 )*0.44704 ), 123, 125, 91, ValidOr( WindSpeedColdestMonth, 5 ), 93, 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Wind Direction %cDegrees%c N=0, S=180%c\n\n", WeatherCliZnDsgnDay2022:PCWD_DB004( "Station_Name", WeatherStation ) , 123, 59, 125 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Rain %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Snow on ground %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Daylight Savings Time Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ASHRAETau,	!- Solar Model Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Beam Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Diffuse Solar Day Schedule Name\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,		!- ASHRAE Clear Sky Optical Depth for Beam Irradiance %cTauB%c\n\n", WeatherCliZnDsgnDay2022:Taub_Jun( "Station_Name", WeatherStation ) , 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g%c		!- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance %cTauD%c\n\n\n\n", WeatherCliZnDsgnDay2022:Taud_Jun( "Station_Name", WeatherStation ) , 59, 40, 41 ) ) }

END


RULELIST "DesignDay_Clg_07" 1 0 0 0

  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "SizingPeriod:DesignDay,\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %s  July .4% Condns DB=>MCWB,     !- Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "   7,	!- Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  21,	!- Day of Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  SummerDesignDay, !- Day Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Maximum Dry-Bulb Temperature %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB004_Jul( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB004_Jul( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Daily Dry-Bulb Temperature Range %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MDBR_Jul( "Station_Name", WeatherStation )-0)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MDBR_Jul( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  DefaultMultipliers, !- Dry-Bulb Temperature Range Modifier Type\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Dry-Bulb Temperature Range Modifier Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  Wetbulb,		!- Humidity Condition Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wetbulb at Maximum Dry-Bulb %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MCWB_DB004_Jul( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MCWB_DB004_Jul( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Indicating Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Ratio at Maximum Dry-Bulb %ckgWater/kgDryAir%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Enthalpy at Maximum Dry-Bulb %cJ/kg%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Daily Wet-Bulb Temperature Range %cdeltaC%c\n", 123, 125 )  }	
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,	!- Barometric Pressure %cPa%c %c%.1f PSI%c\n\n", (WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation )*6894.7448255 ) , 123, 125, 91, WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wind Speed %cm/s%c %c%.1f mph%c design conditions vs. traditional 3.35 m/s %c7.5 mph%c\n\n", ( ValidOr( WindSpeedColdestMonth, 5 )*0.44704 ), 123, 125, 91, ValidOr( WindSpeedColdestMonth, 5 ), 93, 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Wind Direction %cDegrees%c N=0, S=180%c\n\n", WeatherCliZnDsgnDay2022:PCWD_DB004( "Station_Name", WeatherStation ) , 123, 59, 125 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Rain %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Snow on ground %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Daylight Savings Time Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ASHRAETau,	!- Solar Model Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Beam Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Diffuse Solar Day Schedule Name\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,		!- ASHRAE Clear Sky Optical Depth for Beam Irradiance %cTauB%c\n\n", WeatherCliZnDsgnDay2022:Taub_Jul( "Station_Name", WeatherStation ) , 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g%c		!- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance %cTauD%c\n\n\n\n", WeatherCliZnDsgnDay2022:Taud_Jul( "Station_Name", WeatherStation ) , 59, 40, 41 ) ) }

END


RULELIST "DesignDay_Clg_08" 1 0 0 0

  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "SizingPeriod:DesignDay,\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %s  August .4% Condns DB=>MCWB,     !- Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "   8,	!- Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  21,	!- Day of Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  SummerDesignDay, !- Day Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Maximum Dry-Bulb Temperature %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB004_Aug( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB004_Aug( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Daily Dry-Bulb Temperature Range %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MDBR_Aug( "Station_Name", WeatherStation )-0)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MDBR_Aug( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  DefaultMultipliers, !- Dry-Bulb Temperature Range Modifier Type\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Dry-Bulb Temperature Range Modifier Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  Wetbulb,		!- Humidity Condition Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wetbulb at Maximum Dry-Bulb %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MCWB_DB004_Aug( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MCWB_DB004_Aug( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Indicating Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Ratio at Maximum Dry-Bulb %ckgWater/kgDryAir%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Enthalpy at Maximum Dry-Bulb %cJ/kg%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Daily Wet-Bulb Temperature Range %cdeltaC%c\n", 123, 125 )  }	
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,	!- Barometric Pressure %cPa%c %c%.1f PSI%c\n\n", (WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation )*6894.7448255 ) , 123, 125, 91, WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wind Speed %cm/s%c %c%.1f mph%c design conditions vs. traditional 3.35 m/s %c7.5 mph%c\n\n", ( ValidOr( WindSpeedColdestMonth, 5 )*0.44704 ), 123, 125, 91, ValidOr( WindSpeedColdestMonth, 5 ), 93, 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Wind Direction %cDegrees%c N=0, S=180%c\n\n", WeatherCliZnDsgnDay2022:PCWD_DB004( "Station_Name", WeatherStation ) , 123, 59, 125 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Rain %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Snow on ground %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Daylight Savings Time Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ASHRAETau,	!- Solar Model Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Beam Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Diffuse Solar Day Schedule Name\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,		!- ASHRAE Clear Sky Optical Depth for Beam Irradiance %cTauB%c\n\n", WeatherCliZnDsgnDay2022:Taub_Aug( "Station_Name", WeatherStation ) , 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g%c		!- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance %cTauD%c\n\n\n\n", WeatherCliZnDsgnDay2022:Taud_Aug( "Station_Name", WeatherStation ) , 59, 40, 41 ) ) }

END


RULELIST "DesignDay_Clg_09" 1 0 0 0

  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "SizingPeriod:DesignDay,\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %s  September .4% Condns DB=>MCWB,     !- Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "   9,	!- Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  21,	!- Day of Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  SummerDesignDay, !- Day Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Maximum Dry-Bulb Temperature %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB004_Sep( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB004_Sep( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Daily Dry-Bulb Temperature Range %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MDBR_Sep( "Station_Name", WeatherStation )-0)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MDBR_Sep( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  DefaultMultipliers, !- Dry-Bulb Temperature Range Modifier Type\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Dry-Bulb Temperature Range Modifier Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  Wetbulb,		!- Humidity Condition Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wetbulb at Maximum Dry-Bulb %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MCWB_DB004_Sep( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MCWB_DB004_Sep( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Indicating Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Ratio at Maximum Dry-Bulb %ckgWater/kgDryAir%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Enthalpy at Maximum Dry-Bulb %cJ/kg%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Daily Wet-Bulb Temperature Range %cdeltaC%c\n", 123, 125 )  }	
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,	!- Barometric Pressure %cPa%c %c%.1f PSI%c\n\n", (WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation )*6894.7448255 ) , 123, 125, 91, WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wind Speed %cm/s%c %c%.1f mph%c design conditions vs. traditional 3.35 m/s %c7.5 mph%c\n\n", ( ValidOr( WindSpeedColdestMonth, 5 )*0.44704 ), 123, 125, 91, ValidOr( WindSpeedColdestMonth, 5 ), 93, 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Wind Direction %cDegrees%c N=0, S=180%c\n\n", WeatherCliZnDsgnDay2022:PCWD_DB004( "Station_Name", WeatherStation ) , 123, 59, 125 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Rain %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Snow on ground %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Daylight Savings Time Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ASHRAETau,	!- Solar Model Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Beam Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Diffuse Solar Day Schedule Name\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,		!- ASHRAE Clear Sky Optical Depth for Beam Irradiance %cTauB%c\n\n", WeatherCliZnDsgnDay2022:Taub_Sep( "Station_Name", WeatherStation ) , 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g%c		!- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance %cTauD%c\n\n\n\n", WeatherCliZnDsgnDay2022:Taud_Sep( "Station_Name", WeatherStation ) , 59, 40, 41 ) ) }

END


RULELIST "DesignDay_Clg_10" 1 0 0 0

  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "SizingPeriod:DesignDay,\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %s  October .4% Condns DB=>MCWB,     !- Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  10,	!- Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  21,	!- Day of Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  SummerDesignDay, !- Day Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Maximum Dry-Bulb Temperature %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB004_Oct( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB004_Oct( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Daily Dry-Bulb Temperature Range %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MDBR_Oct( "Station_Name", WeatherStation )-0)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MDBR_Oct( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  DefaultMultipliers, !- Dry-Bulb Temperature Range Modifier Type\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Dry-Bulb Temperature Range Modifier Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  Wetbulb,		!- Humidity Condition Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wetbulb at Maximum Dry-Bulb %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MCWB_DB004_Oct( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MCWB_DB004_Oct( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Indicating Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Ratio at Maximum Dry-Bulb %ckgWater/kgDryAir%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Enthalpy at Maximum Dry-Bulb %cJ/kg%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Daily Wet-Bulb Temperature Range %cdeltaC%c\n", 123, 125 )  }	
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,	!- Barometric Pressure %cPa%c %c%.1f PSI%c\n\n", (WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation )*6894.7448255 ) , 123, 125, 91, WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wind Speed %cm/s%c %c%.1f mph%c design conditions vs. traditional 3.35 m/s %c7.5 mph%c\n\n", ( ValidOr( WindSpeedColdestMonth, 5 )*0.44704 ), 123, 125, 91, ValidOr( WindSpeedColdestMonth, 5 ), 93, 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Wind Direction %cDegrees%c N=0, S=180%c\n\n", WeatherCliZnDsgnDay2022:PCWD_DB004( "Station_Name", WeatherStation ) , 123, 59, 125 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Rain %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Snow on ground %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Daylight Savings Time Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ASHRAETau,	!- Solar Model Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Beam Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Diffuse Solar Day Schedule Name\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,		!- ASHRAE Clear Sky Optical Depth for Beam Irradiance %cTauB%c\n\n", WeatherCliZnDsgnDay2022:Taub_Oct( "Station_Name", WeatherStation ) , 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g%c		!- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance %cTauD%c\n\n\n\n", WeatherCliZnDsgnDay2022:Taud_Oct( "Station_Name", WeatherStation ) , 59, 40, 41 ) ) }

END


RULELIST "DesignDay_Clg_11" 1 0 0 0

  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "SizingPeriod:DesignDay,\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %s  November .4% Condns DB=>MCWB,     !- Name\n\n", WeatherCliZnDsgnDay2022:Station_name( "Station_Name", WeatherStation ) ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  11,	!- Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  21,	!- Day of Month\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  SummerDesignDay, !- Day Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Maximum Dry-Bulb Temperature %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:DB004_Nov( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:DB004_Nov( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Daily Dry-Bulb Temperature Range %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MDBR_Nov( "Station_Name", WeatherStation )-0)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MDBR_Nov( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  DefaultMultipliers, !- Dry-Bulb Temperature Range Modifier Type\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Dry-Bulb Temperature Range Modifier Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  Wetbulb,		!- Humidity Condition Type\n" )  }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wetbulb at Maximum Dry-Bulb %cC%c %c%.1f F%c\n\n", (WeatherCliZnDsgnDay2022:MCWB_DB004_Nov( "Station_Name", WeatherStation )-32)*5/9 , 123, 125, 91, WeatherCliZnDsgnDay2022:MCWB_DB004_Nov( "Station_Name", WeatherStation ), 93 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Indicating Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Humidity Ratio at Maximum Dry-Bulb %ckgWater/kgDryAir%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Enthalpy at Maximum Dry-Bulb %cJ/kg%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Daily Wet-Bulb Temperature Range %cdeltaC%c\n", 123, 125 )  }	
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,	!- Barometric Pressure %cPa%c %c%.1f PSI%c\n\n", (WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation )*6894.7448255 ) , 123, 125, 91, WeatherCliZnDsgnDay2022:StdP( "Station_Name", WeatherStation ), 93 ) ) }
  "write_num_lookup_cv"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %.1f,	!- Wind Speed %cm/s%c %c%.1f mph%c design conditions vs. traditional 3.35 m/s %c7.5 mph%c\n\n", ( ValidOr( WindSpeedColdestMonth, 5 )*0.44704 ), 123, 125, 91, ValidOr( WindSpeedColdestMonth, 5 ), 93, 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx,  Format( "  %g,	!- Wind Direction %cDegrees%c N=0, S=180%c\n\n", WeatherCliZnDsgnDay2022:PCWD_DB004( "Station_Name", WeatherStation ) , 123, 59, 125 ) ) }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Rain %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Snow on ground %cYes/No%c\n", 123, 125 )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  No,	!- Daylight Savings Time Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ASHRAETau,	!- Solar Model Indicator\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Beam Solar Day Schedule Name\n" )  }
  "write_string"         Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, "  ,		!- Diffuse Solar Day Schedule Name\n" )  }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g,		!- ASHRAE Clear Sky Optical Depth for Beam Irradiance %cTauB%c\n\n", WeatherCliZnDsgnDay2022:Taub_Nov( "Station_Name", WeatherStation ) , 40, 41 ) ) }
  "write_string_lookup"  Proj:Action = {  WriteToExportFile( WeatherLocationDDYFileIdx, Format( "  %g%c		!- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance %cTauD%c\n\n\n\n", WeatherCliZnDsgnDay2022:Taud_Nov( "Station_Name", WeatherStation ) , 59, 40, 41 ) ) }

END


RULELIST "PopulateDDYFile" 1 0 0 0

  "insert_location"  	Proj:Action = { EvalRulelist( "Location" ) }
  "insert_htg_annual"   Proj:Action = { EvalRulelist( "DesignDay_Htg_Ann" ) }
  "insert_clg_06"   	Proj:Action = { EvalRulelist( "DesignDay_Clg_06" ) }
  "insert_clg_07"   	Proj:Action = { EvalRulelist( "DesignDay_Clg_07" ) }
  "insert_clg_08"   	Proj:Action = { EvalRulelist( "DesignDay_Clg_08" ) }
  "insert_clg_09"   	Proj:Action = { EvalRulelist( "DesignDay_Clg_09" ) }
  "insert_clg_10"   	Proj:Action = { EvalRulelist( "DesignDay_Clg_10" ) }
  "insert_clg_11"   	Proj:Action = { EvalRulelist( "DesignDay_Clg_11" ) }

END


;*************************************************************************

ENDFILE

